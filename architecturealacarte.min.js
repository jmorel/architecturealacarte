!function(e,t,n){"use strict";function r(e,t){return t=t||Error,function(){var n,r,a=arguments,i=a[0],o="["+(e?e+":":"")+i+"] ";for(o+=a[1].replace(/\{\d+\}/g,function(e){var t=+e.slice(1,-1)+2;return t<a.length?ye(a[t]):e}),o+="\nhttp://errors.angularjs.org/1.4.4/"+(e?e+"/":"")+i,r=2,n="?";r<a.length;r++,n="&")o+=n+"p"+(r-2)+"="+encodeURIComponent(ye(a[r]));return new t(o)}}function a(e){if(null==e||S(e))return!1;var t="length"in Object(e)&&e.length;return!(e.nodeType!==zr||!t)||(C(e)||Or(e)||0===t||"number"==typeof t&&t>0&&t-1 in e)}function i(e,t,n){var r,o;if(e)if(A(e))for(r in e)"prototype"==r||"length"==r||"name"==r||e.hasOwnProperty&&!e.hasOwnProperty(r)||t.call(n,e[r],r,e);else if(Or(e)||a(e)){var s="object"!=typeof e;for(r=0,o=e.length;r<o;r++)(s||r in e)&&t.call(n,e[r],r,e)}else if(e.forEach&&e.forEach!==i)e.forEach(t,n,e);else if($(e))for(r in e)t.call(n,e[r],r,e);else if("function"==typeof e.hasOwnProperty)for(r in e)e.hasOwnProperty(r)&&t.call(n,e[r],r,e);else for(r in e)vr.call(e,r)&&t.call(n,e[r],r,e);return e}function o(e,t,n){for(var r=Object.keys(e).sort(),a=0;a<r.length;a++)t.call(n,e[r[a]],r[a]);return r}function s(e){return function(t,n){e(n,t)}}function l(){return++Mr}function u(e,t){t?e.$$hashKey=t:delete e.$$hashKey}function c(e,t,n){for(var r=e.$$hashKey,a=0,i=t.length;a<i;++a){var o=t[a];if(w(o)||A(o))for(var s=Object.keys(o),l=0,d=s.length;l<d;l++){var f=s[l],p=o[f];n&&w(p)?E(p)?e[f]=new Date(p.valueOf()):k(p)?e[f]=new RegExp(p):(w(e[f])||(e[f]=Or(p)?[]:{}),c(e[f],[p],!0)):e[f]=p}}return u(e,r),e}function d(e){return c(e,Er.call(arguments,1),!1)}function f(e){return c(e,Er.call(arguments,1),!0)}function p(e){return parseInt(e,10)}function h(e,t){return d(Object.create(e),t)}function g(){}function m(e){return e}function v(e){return function(){return e}}function y(e){return A(e.toString)&&e.toString!==Object.prototype.toString}function b(e){return void 0===e}function x(e){return void 0!==e}function w(e){return null!==e&&"object"==typeof e}function $(e){return null!==e&&"object"==typeof e&&!Dr(e)}function C(e){return"string"==typeof e}function _(e){return"number"==typeof e}function E(e){return"[object Date]"===Sr.call(e)}function A(e){return"function"==typeof e}function k(e){return"[object RegExp]"===Sr.call(e)}function S(e){return e&&e.window===e}function D(e){return e&&e.$evalAsync&&e.$watch}function T(e){return"[object File]"===Sr.call(e)}function F(e){return"[object FormData]"===Sr.call(e)}function M(e){return"[object Blob]"===Sr.call(e)}function L(e){return"boolean"==typeof e}function O(e){return e&&A(e.then)}function N(e){return Nr.test(Sr.call(e))}function j(e){return!(!e||!(e.nodeName||e.prop&&e.attr&&e.find))}function P(e){var t,n={},r=e.split(",");for(t=0;t<r.length;t++)n[r[t]]=!0;return n}function B(e){return mr(e.nodeName||e[0]&&e[0].nodeName)}function q(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n}function R(e,t,n,r){if(S(e)||D(e))throw Tr("cpws","Can't copy! Making copies of Window or Scope instances is not supported.");if(N(t))throw Tr("cpta","Can't copy! TypedArray destination cannot be mutated.");if(t){if(e===t)throw Tr("cpi","Can't copy! Source and destination are identical.");n=n||[],r=r||[],w(e)&&(n.push(e),r.push(t));var a;if(Or(e)){t.length=0;for(var o=0;o<e.length;o++)t.push(R(e[o],null,n,r))}else{var s=t.$$hashKey;if(Or(t)?t.length=0:i(t,function(e,n){delete t[n]}),$(e))for(a in e)t[a]=R(e[a],null,n,r);else if(e&&"function"==typeof e.hasOwnProperty)for(a in e)e.hasOwnProperty(a)&&(t[a]=R(e[a],null,n,r));else for(a in e)vr.call(e,a)&&(t[a]=R(e[a],null,n,r));u(t,s)}}else if(t=e,w(e)){var l;if(n&&-1!==(l=n.indexOf(e)))return r[l];if(Or(e))return R(e,[],n,r);if(N(e))t=new e.constructor(e);else if(E(e))t=new Date(e.getTime());else{if(!k(e))return R(e,Object.create(Dr(e)),n,r);(t=new RegExp(e.source,e.toString().match(/[^\/]*$/)[0])).lastIndex=e.lastIndex}r&&(n.push(e),r.push(t))}return t}function I(e,t){if(Or(e)){t=t||[];for(var n=0,r=e.length;n<r;n++)t[n]=e[n]}else if(w(e)){t=t||{};for(var a in e)"$"===a.charAt(0)&&"$"===a.charAt(1)||(t[a]=e[a])}return t||e}function U(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(e!==e&&t!==t)return!0;var r,a,i,o=typeof e;if(o==typeof t&&"object"==o){if(!Or(e)){if(E(e))return!!E(t)&&U(e.getTime(),t.getTime());if(k(e))return!!k(t)&&e.toString()==t.toString();if(D(e)||D(t)||S(e)||S(t)||Or(t)||E(t)||k(t))return!1;i=ge();for(a in e)if("$"!==a.charAt(0)&&!A(e[a])){if(!U(e[a],t[a]))return!1;i[a]=!0}for(a in t)if(!(a in i||"$"===a.charAt(0)||t[a]===n||A(t[a])))return!1;return!0}if(!Or(t))return!1;if((r=e.length)==t.length){for(a=0;a<r;a++)if(!U(e[a],t[a]))return!1;return!0}}return!1}function z(e,t,n){return e.concat(Er.call(t,n))}function V(e,t){return Er.call(e,t||0)}function H(e,t){var n=arguments.length>2?V(arguments,2):[];return!A(t)||t instanceof RegExp?t:n.length?function(){return arguments.length?t.apply(e,z(n,arguments,0)):t.apply(e,n)}:function(){return arguments.length?t.apply(e,arguments):t.call(e)}}function Y(e,r){var a=r;return"string"==typeof e&&"$"===e.charAt(0)&&"$"===e.charAt(1)?a=n:S(r)?a="$WINDOW":r&&t===r?a="$DOCUMENT":D(r)&&(a="$SCOPE"),a}function G(e,t){return void 0===e?n:(_(t)||(t=t?2:null),JSON.stringify(e,Y,t))}function W(e){return C(e)?JSON.parse(e):e}function Z(e,t){var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function J(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}function X(e,t,n){return J(e,(n=n?-1:1)*(Z(t,e.getTimezoneOffset())-e.getTimezoneOffset()))}function Q(e){e=$r(e).clone();try{e.empty()}catch(e){}var t=$r("<div>").append(e).html();try{return e[0].nodeType===Vr?mr(t):t.match(/^(<[^>]+>)/)[1].replace(/^<([\w\-]+)/,function(e,t){return"<"+mr(t)})}catch(e){return mr(t)}}function K(e){try{return decodeURIComponent(e)}catch(e){}}function ee(e){var t={};return i((e||"").split("&"),function(e){var n,r,a;e&&(r=e=e.replace(/\+/g,"%20"),-1!==(n=e.indexOf("="))&&(r=e.substring(0,n),a=e.substring(n+1)),x(r=K(r))&&(a=!x(a)||K(a),vr.call(t,r)?Or(t[r])?t[r].push(a):t[r]=[t[r],a]:t[r]=a))}),t}function te(e){var t=[];return i(e,function(e,n){Or(e)?i(e,function(e){t.push(re(n,!0)+(!0===e?"":"="+re(e,!0)))}):t.push(re(n,!0)+(!0===e?"":"="+re(e,!0)))}),t.length?t.join("&"):""}function ne(e){return re(e,!0).replace(/%26/gi,"&").replace(/%3D/gi,"=").replace(/%2B/gi,"+")}function re(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%3B/gi,";").replace(/%20/g,t?"%20":"+")}function ae(e,t){var n,r,a=Rr.length;for(r=0;r<a;++r)if(n=Rr[r]+t,C(n=e.getAttribute(n)))return n;return null}function ie(e,t){var n,r,a={};i(Rr,function(t){var a=t+"app";!n&&e.hasAttribute&&e.hasAttribute(a)&&(n=e,r=e.getAttribute(a))}),i(Rr,function(t){var a,i=t+"app";!n&&(a=e.querySelector("["+i.replace(":","\\:")+"]"))&&(n=a,r=a.getAttribute(i))}),n&&(a.strictDi=null!==ae(n,"strict-di"),t(n,r?[r]:[],a))}function oe(n,r,a){w(a)||(a={}),a=d({strictDi:!1},a);var o=function(){if((n=$r(n)).injector()){var e=n[0]===t?"document":Q(n);throw Tr("btstrpd","App Already Bootstrapped with this Element '{0}'",e.replace(/</,"&lt;").replace(/>/,"&gt;"))}(r=r||[]).unshift(["$provide",function(e){e.value("$rootElement",n)}]),a.debugInfoEnabled&&r.push(["$compileProvider",function(e){e.debugInfoEnabled(!0)}]),r.unshift("ng");var i=Je(r,a.strictDi);return i.invoke(["$rootScope","$rootElement","$compile","$injector",function(e,t,n,r){e.$apply(function(){t.data("$injector",r),n(t)(e)})}]),i},s=/^NG_ENABLE_DEBUG_INFO!/,l=/^NG_DEFER_BOOTSTRAP!/;if(e&&s.test(e.name)&&(a.debugInfoEnabled=!0,e.name=e.name.replace(s,"")),e&&!l.test(e.name))return o();e.name=e.name.replace(l,""),Fr.resumeBootstrap=function(e){return i(e,function(e){r.push(e)}),o()},A(Fr.resumeDeferredBootstrap)&&Fr.resumeDeferredBootstrap()}function se(){e.name="NG_ENABLE_DEBUG_INFO!"+e.name,e.location.reload()}function le(e){var t=Fr.element(e).injector();if(!t)throw Tr("test","no injector found for element argument to getTestability");return t.get("$$testability")}function ue(e,t){return t=t||"_",e.replace(Ir,function(e,n){return(n?t:"")+e.toLowerCase()})}function ce(e,t,n){if(!e)throw Tr("areq","Argument '{0}' is {1}",t||"?",n||"required");return e}function de(e,t,n){return n&&Or(e)&&(e=e[e.length-1]),ce(A(e),t,"not a function, got "+(e&&"object"==typeof e?e.constructor.name||"Object":typeof e)),e}function fe(e,t){if("hasOwnProperty"===e)throw Tr("badname","hasOwnProperty is not a valid {0} name",t)}function pe(e,t,n){if(!t)return e;for(var r,a=t.split("."),i=e,o=a.length,s=0;s<o;s++)r=a[s],e&&(e=(i=e)[r]);return!n&&A(e)?H(i,e):e}function he(e){var t=e[0],n=e[e.length-1],r=[t];do{if(!(t=t.nextSibling))break;r.push(t)}while(t!==n);return $r(r)}function ge(){return Object.create(null)}function me(e){function t(e,t,n){return e[t]||(e[t]=n())}var n=r("$injector"),a=r("ng"),i=t(e,"angular",Object);return i.$$minErr=i.$$minErr||r,t(i,"module",function(){var e={};return function(r,i,o){return function(e,t){if("hasOwnProperty"===e)throw a("badname","hasOwnProperty is not a valid {0} name",t)}(r,"module"),i&&e.hasOwnProperty(r)&&(e[r]=null),t(e,r,function(){function e(e,t,n,r){return r||(r=a),function(){return r[n||"push"]([e,t,arguments]),c}}function t(e,t){return function(n,i){return i&&A(i)&&(i.$$moduleName=r),a.push([e,t,arguments]),c}}if(!i)throw n("nomod","Module '{0}' is not available! You either misspelled the module name or forgot to load it. If registering a module ensure that you specify the dependencies as the second argument.",r);var a=[],s=[],l=[],u=e("$injector","invoke","push",s),c={_invokeQueue:a,_configBlocks:s,_runBlocks:l,requires:i,name:r,provider:t("$provide","provider"),factory:t("$provide","factory"),service:t("$provide","service"),value:e("$provide","value"),constant:e("$provide","constant","unshift"),decorator:t("$provide","decorator"),animation:t("$animateProvider","register"),filter:t("$filterProvider","register"),controller:t("$controllerProvider","register"),directive:t("$compileProvider","directive"),config:u,run:function(e){return l.push(e),this}};return o&&u(o),c})}})}function ve(e){var t=[];return JSON.stringify(e,function(e,n){if(n=Y(e,n),w(n)){if(t.indexOf(n)>=0)return"<<already seen>>";t.push(n)}return n})}function ye(e){return"function"==typeof e?e.toString().replace(/ \{[\s\S]*$/,""):void 0===e?"undefined":"string"!=typeof e?ve(e):e}function be(){return++Jr}function xe(e){return e.replace(Kr,function(e,t,n,r){return r?n.toUpperCase():n}).replace(ea,"Moz$1")}function we(e){return!aa.test(e)}function $e(e){var t=e.nodeType;return t===zr||!t||t===Yr}function Ce(e){for(var t in Zr[e.ng339])return!0;return!1}function _e(e,t){var n,r,a,o,s=t.createDocumentFragment(),l=[];if(we(e))l.push(t.createTextNode(e));else{for(n=n||s.appendChild(t.createElement("div")),r=(ia.exec(e)||["",""])[1].toLowerCase(),a=sa[r]||sa._default,n.innerHTML=a[1]+e.replace(oa,"<$1></$2>")+a[2],o=a[0];o--;)n=n.lastChild;l=z(l,n.childNodes),(n=s.firstChild).textContent=""}return s.textContent="",s.innerHTML="",i(l,function(e){s.appendChild(e)}),s}function Ee(e,n){n=n||t;var r;return(r=ra.exec(e))?[n.createElement(r[1])]:(r=_e(e,n))?r.childNodes:[]}function Ae(e){if(e instanceof Ae)return e;var t;if(C(e)&&(e=jr(e),t=!0),!(this instanceof Ae)){if(t&&"<"!=e.charAt(0))throw na("nosel","Looking up elements via selectors is not supported by jqLite! See: http://docs.angularjs.org/api/angular.element");return new Ae(e)}t?je(this,Ee(e)):je(this,e)}function ke(e){return e.cloneNode(!0)}function Se(e,t){if(t||Te(e),e.querySelectorAll)for(var n=e.querySelectorAll("*"),r=0,a=n.length;r<a;r++)Te(n[r])}function De(e,t,n,r){if(x(r))throw na("offargs","jqLite#off() does not support the `selector` argument");var a=Fe(e),o=a&&a.events,s=a&&a.handle;if(s)if(t)i(t.split(" "),function(t){if(x(n)){var r=o[t];if(q(r||[],n),r&&r.length>0)return}Qr(e,t,s),delete o[t]});else for(t in o)"$destroy"!==t&&Qr(e,t,s),delete o[t]}function Te(e,t){var r=e.ng339,a=r&&Zr[r];if(a){if(t)return void delete a.data[t];a.handle&&(a.events.$destroy&&a.handle({},"$destroy"),De(e)),delete Zr[r],e.ng339=n}}function Fe(e,t){var r=e.ng339,a=r&&Zr[r];return t&&!a&&(e.ng339=r=be(),a=Zr[r]={events:{},data:{},handle:n}),a}function Me(e,t,n){if($e(e)){var r=x(n),a=!r&&t&&!w(t),i=!t,o=Fe(e,!a),s=o&&o.data;if(r)s[t]=n;else{if(i)return s;if(a)return s&&s[t];d(s,t)}}}function Le(e,t){return!!e.getAttribute&&(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").indexOf(" "+t+" ")>-1}function Oe(e,t){t&&e.setAttribute&&i(t.split(" "),function(t){e.setAttribute("class",jr((" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ").replace(" "+jr(t)+" "," ")))})}function Ne(e,t){if(t&&e.setAttribute){var n=(" "+(e.getAttribute("class")||"")+" ").replace(/[\n\t]/g," ");i(t.split(" "),function(e){e=jr(e),-1===n.indexOf(" "+e+" ")&&(n+=e+" ")}),e.setAttribute("class",jr(n))}}function je(e,t){if(t)if(t.nodeType)e[e.length++]=t;else{var n=t.length;if("number"==typeof n&&t.window!==t){if(n)for(var r=0;r<n;r++)e[e.length++]=t[r]}else e[e.length++]=t}}function Pe(e,t){return Be(e,"$"+(t||"ngController")+"Controller")}function Be(e,t,r){e.nodeType==Yr&&(e=e.documentElement);for(var a=Or(t)?t:[t];e;){for(var i=0,o=a.length;i<o;i++)if((r=$r.data(e,a[i]))!==n)return r;e=e.parentNode||e.nodeType===Gr&&e.host}}function qe(e){for(Se(e,!0);e.firstChild;)e.removeChild(e.firstChild)}function Re(e,t){t||Se(e);var n=e.parentNode;n&&n.removeChild(e)}function Ie(t,n){"complete"===(n=n||e).document.readyState?n.setTimeout(t):$r(n).on("load",t)}function Ue(e,t){var n=ua[t.toLowerCase()];return n&&ca[B(e)]&&n}function ze(e,t){var n=e.nodeName;return("INPUT"===n||"TEXTAREA"===n)&&da[t]}function Ve(e,t){var n=function(n,r){n.isDefaultPrevented=function(){return n.defaultPrevented};var a=t[r||n.type],i=a?a.length:0;if(i){if(b(n.immediatePropagationStopped)){var o=n.stopImmediatePropagation;n.stopImmediatePropagation=function(){n.immediatePropagationStopped=!0,n.stopPropagation&&n.stopPropagation(),o&&o.call(n)}}n.isImmediatePropagationStopped=function(){return!0===n.immediatePropagationStopped},i>1&&(a=I(a));for(var s=0;s<i;s++)n.isImmediatePropagationStopped()||a[s].call(e,n)}};return n.elem=e,n}function He(){this.$get=function(){return d(Ae,{hasClass:function(e,t){return e.attr&&(e=e[0]),Le(e,t)},addClass:function(e,t){return e.attr&&(e=e[0]),Ne(e,t)},removeClass:function(e,t){return e.attr&&(e=e[0]),Oe(e,t)}})}}function Ye(e,t){var n=e&&e.$$hashKey;if(n)return"function"==typeof n&&(n=e.$$hashKey()),n;var r=typeof e;return n="function"==r||"object"==r&&null!==e?e.$$hashKey=r+":"+(t||l)():r+":"+e}function Ge(e,t){if(t){var n=0;this.nextUid=function(){return++n}}i(e,this.put,this)}function We(e){var t=e.toString().replace(ma,"").match(pa);return t?"function("+(t[1]||"").replace(/[\s\r\n]+/," ")+")":"fn"}function Ze(e,t,n){var r,a;if("function"==typeof e){if(!(r=e.$inject)){if(r=[],e.length){if(t)throw C(n)&&n||(n=e.name||We(e)),va("strictdi","{0} is not using explicit annotation and cannot be invoked in strict mode",n);i(e.toString().replace(ma,"").match(pa)[1].split(ha),function(e){e.replace(ga,function(e,t,n){r.push(n)})})}e.$inject=r}}else Or(e)?(de(e[a=e.length-1],"fn"),r=e.slice(0,a)):de(e,"fn",!0);return r}function Je(e,t){function r(e){return function(t,n){if(!w(t))return e(t,n);i(t,s(e))}}function a(e,t){if(fe(e,"service"),(A(t)||Or(t))&&(t=_.instantiate(t)),!t.$get)throw va("pget","Provider '{0}' must define $get factory method.",e);return $[e+m]=t}function o(e,t){return function(){var n=k.invoke(t,this);if(b(n))throw va("undef","Provider '{0}' must return a value from $get factory method.",e);return n}}function l(e,t,n){return a(e,{$get:!1!==n?o(e,t):t})}function u(e,t){return l(e,["$injector",function(e){return e.instantiate(t)}])}function c(e,t){return l(e,v(t),!1)}function d(e,t){fe(e,"constant"),$[e]=t,E[e]=t}function f(e,t){var n=_.get(e+m),r=n.$get;n.$get=function(){var e=k.invoke(r,n);return k.invoke(t,null,{$delegate:e})}}function p(e){ce(b(e)||Or(e),"modulesToLoad","not an array");var t,n=[];return i(e,function(e){function r(e){var t,n;for(t=0,n=e.length;t<n;t++){var r=e[t],a=_.get(r[0]);a[r[1]].apply(a,r[2])}}if(!x.get(e)){x.put(e,!0);try{C(e)?(t=_r(e),n=n.concat(p(t.requires)).concat(t._runBlocks),r(t._invokeQueue),r(t._configBlocks)):A(e)?n.push(_.invoke(e)):Or(e)?n.push(_.invoke(e)):de(e,"module")}catch(t){throw Or(e)&&(e=e[e.length-1]),t.message&&t.stack&&-1==t.stack.indexOf(t.message)&&(t=t.message+"\n"+t.stack),va("modulerr","Failed to instantiate module {0} due to:\n{1}",e,t.stack||t.message||t)}}}),n}function h(e,n){function r(t,r){if(e.hasOwnProperty(t)){if(e[t]===g)throw va("cdep","Circular dependency found: {0}",t+" <- "+y.join(" <- "));return e[t]}try{return y.unshift(t),e[t]=g,e[t]=n(t,r)}catch(n){throw e[t]===g&&delete e[t],n}finally{y.shift()}}function a(e,n,a,i){"string"==typeof a&&(i=a,a=null);var o,s,l,u=[],c=Je.$$annotate(e,t,i);for(s=0,o=c.length;s<o;s++){if("string"!=typeof(l=c[s]))throw va("itkn","Incorrect injection token! Expected service name as string, got {0}",l);u.push(a&&a.hasOwnProperty(l)?a[l]:r(l,i))}return Or(e)&&(e=e[o]),e.apply(n,u)}function i(e,t,n){var r=Object.create((Or(e)?e[e.length-1]:e).prototype||null),i=a(e,r,t,n);return w(i)||A(i)?i:r}return{invoke:a,instantiate:i,get:r,annotate:Je.$$annotate,has:function(t){return $.hasOwnProperty(t+m)||e.hasOwnProperty(t)}}}t=!0===t;var g={},m="Provider",y=[],x=new Ge([],!0),$={$provide:{provider:r(a),factory:r(l),service:r(u),value:r(c),constant:r(d),decorator:f}},_=$.$injector=h($,function(e,t){throw Fr.isString(t)&&y.push(t),va("unpr","Unknown provider: {0}",y.join(" <- "))}),E={},k=E.$injector=h(E,function(e,t){var r=_.get(e+m,t);return k.invoke(r.$get,r,n,e)});return i(p(e),function(e){e&&k.invoke(e)}),k}function Xe(){var e=!0;this.disableAutoScrolling=function(){e=!1},this.$get=["$window","$location","$rootScope",function(t,n,r){function a(e){var t=null;return Array.prototype.some.call(e,function(e){if("a"===B(e))return t=e,!0}),t}function i(){var e=s.yOffset;if(A(e))e=e();else if(j(e)){var n=e[0];e="fixed"!==t.getComputedStyle(n).position?0:n.getBoundingClientRect().bottom}else _(e)||(e=0);return e}function o(e){if(e){e.scrollIntoView();var n=i();if(n){var r=e.getBoundingClientRect().top;t.scrollBy(0,r-n)}}else t.scrollTo(0,0)}function s(e){var t;(e=C(e)?e:n.hash())?(t=l.getElementById(e))?o(t):(t=a(l.getElementsByName(e)))?o(t):"top"===e&&o(null):o(null)}var l=t.document;return e&&r.$watch(function(){return n.hash()},function(e,t){e===t&&""===e||Ie(function(){r.$evalAsync(s)})}),s}]}function Qe(e,t){return e||t?e?t?(Or(e)&&(e=e.join(" ")),Or(t)&&(t=t.join(" ")),e+" "+t):e:t:""}function Ke(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.nodeType===ba)return n}}function et(e){C(e)&&(e=e.split(" "));var t=ge();return i(e,function(e){e.length&&(t[e]=!0)}),t}function tt(e){return w(e)?e:{}}function nt(e,t,n,r){function a(e){try{e.apply(null,V(arguments,1))}finally{if(0===--y)for(;x.length;)try{x.pop()()}catch(e){n.error(e)}}}function o(e){var t=e.indexOf("#");return-1===t?"":e.substr(t)}function s(){u(),c()}function l(){try{return p.state}catch(e){}}function u(){w=l(),U(w=b(w)?null:w,S)&&(w=S),S=w}function c(){C===d.url()&&$===w||(C=d.url(),$=w,i(A,function(e){e(d.url(),w)}))}var d=this,f=(t[0],e.location),p=e.history,h=e.setTimeout,m=e.clearTimeout,v={};d.isMock=!1;var y=0,x=[];d.$$completeOutstandingRequest=a,d.$$incOutstandingRequestCount=function(){y++},d.notifyWhenNoOutstandingRequests=function(e){0===y?e():x.push(e)};var w,$,C=f.href,_=t.find("base"),E=null;u(),$=w,d.url=function(t,n,a){if(b(a)&&(a=null),f!==e.location&&(f=e.location),p!==e.history&&(p=e.history),t){var i=$===a;if(C===t&&(!r.history||i))return d;var s=C&&Lt(C)===Lt(t);return C=t,$=a,!r.history||s&&i?(s&&!E||(E=t),n?f.replace(t):s?f.hash=o(t):f.href=t):(p[n?"replaceState":"pushState"](a,"",t),u(),$=w),d}return E||f.href.replace(/%27/g,"'")},d.state=function(){return w};var A=[],k=!1,S=null;d.onUrlChange=function(t){return k||(r.history&&$r(e).on("popstate",s),$r(e).on("hashchange",s),k=!0),A.push(t),t},d.$$applicationDestroyed=function(){$r(e).off("hashchange popstate",s)},d.$$checkUrlChange=c,d.baseHref=function(){var e=_.attr("href");return e?e.replace(/^(https?\:)?\/\/[^\/]*/,""):""},d.defer=function(e,t){var n;return y++,n=h(function(){delete v[n],a(e)},t||0),v[n]=!0,n},d.defer.cancel=function(e){return!!v[e]&&(delete v[e],m(e),a(g),!0)}}function rt(){this.$get=["$window","$log","$sniffer","$document",function(e,t,n,r){return new nt(e,r,t,n)}]}function at(){this.$get=function(){function e(e,n){function a(e){e!=f&&(p?p==e&&(p=e.n):p=e,i(e.n,e.p),i(e,f),(f=e).n=null)}function i(e,t){e!=t&&(e&&(e.p=t),t&&(t.n=e))}if(e in t)throw r("$cacheFactory")("iid","CacheId '{0}' is already taken!",e);var o=0,s=d({},n,{id:e}),l={},u=n&&n.capacity||Number.MAX_VALUE,c={},f=null,p=null;return t[e]={put:function(e,t){if(!b(t))return u<Number.MAX_VALUE&&a(c[e]||(c[e]={key:e})),e in l||o++,l[e]=t,o>u&&this.remove(p.key),t},get:function(e){if(u<Number.MAX_VALUE){var t=c[e];if(!t)return;a(t)}return l[e]},remove:function(e){if(u<Number.MAX_VALUE){var t=c[e];if(!t)return;t==f&&(f=t.p),t==p&&(p=t.n),i(t.n,t.p),delete c[e]}delete l[e],o--},removeAll:function(){l={},o=0,c={},f=p=null},destroy:function(){l=null,s=null,c=null,delete t[e]},info:function(){return d({},s,{size:o})}}}var t={};return e.info=function(){var e={};return i(t,function(t,n){e[n]=t.info()}),e},e.get=function(e){return t[e]},e}}function it(){this.$get=["$cacheFactory",function(e){return e("templates")}]}function ot(e,r){function a(e,t,n){var r=/^\s*([@&]|=(\*?))(\??)\s*(\w*)\s*$/,a={};return i(e,function(e,i){var o=e.match(r);if(!o)throw _a("iscp","Invalid {3} for directive '{0}'. Definition: {... {1}: '{2}' ...}",t,i,e,n?"controller bindings definition":"isolate scope definition");a[i]={mode:o[1][0],collection:"*"===o[2],optional:"?"===o[3],attrName:o[4]||i}}),a}function o(e,t){var n={isolateScope:null,bindToController:null};if(w(e.scope)&&(!0===e.bindToController?(n.bindToController=a(e.scope,t,!0),n.isolateScope={}):n.isolateScope=a(e.scope,t,!1)),w(e.bindToController)&&(n.bindToController=a(e.bindToController,t,!0)),w(n.bindToController)){var r=e.controller,i=e.controllerAs;if(!r)throw _a("noctrl","Cannot bind to controller without directive '{0}'s controller.",t);if(!ct(r,i))throw _a("noident","Cannot bind to controller without identifier for directive '{0}'.",t)}return n}function l(e){var t=e.charAt(0);if(!t||t!==mr(t))throw _a("baddir","Directive name '{0}' is invalid. The first character must be a lowercase letter",e);if(e!==e.trim())throw _a("baddir","Directive name '{0}' is invalid. The name should not contain leading or trailing whitespaces",e)}var u={},c="Directive",f=/^\s*directive\:\s*([\w\-]+)\s+(.*)$/,p=/(([\w\-]+)(?:\:([^;]+))?;?)/,y=P("ngSrc,ngSrcset,src,srcset"),$=/^(?:(\^\^?)?(\?)?(\^\^?)?)?/,_=/^(on[a-z]+|formaction)$/;this.directive=function t(n,r){return fe(n,"directive"),C(n)?(l(n),ce(r,"directiveFactory"),u.hasOwnProperty(n)||(u[n]=[],e.factory(n+c,["$injector","$exceptionHandler",function(e,t){var r=[];return i(u[n],function(a,i){try{var s=e.invoke(a);A(s)?s={compile:v(s)}:!s.compile&&s.link&&(s.compile=v(s.link)),s.priority=s.priority||0,s.index=i,s.name=s.name||n,s.require=s.require||s.controller&&s.name,s.restrict=s.restrict||"EA";var l=s.$$bindings=o(s,s.name);w(l.isolateScope)&&(s.$$isolateBindings=l.isolateScope),s.$$moduleName=a.$$moduleName,r.push(s)}catch(e){t(e)}}),r}])),u[n].push(r)):i(n,s(t)),this},this.aHrefSanitizationWhitelist=function(e){return x(e)?(r.aHrefSanitizationWhitelist(e),this):r.aHrefSanitizationWhitelist()},this.imgSrcSanitizationWhitelist=function(e){return x(e)?(r.imgSrcSanitizationWhitelist(e),this):r.imgSrcSanitizationWhitelist()};var E=!0;this.debugInfoEnabled=function(e){return x(e)?(E=e,this):E},this.$get=["$injector","$interpolate","$exceptionHandler","$templateRequest","$parse","$controller","$rootScope","$document","$sce","$animate","$$sanitizeUri",function(e,r,a,o,s,l,v,x,k,S,T){function F(e,t){try{e.addClass(t)}catch(e){}}function M(e,t,n,r,a){e instanceof $r||(e=$r(e)),i(e,function(t,n){t.nodeType==Vr&&t.nodeValue.match(/\S+/)&&(e[n]=$r(t).wrap("<span></span>").parent()[0])});var o=O(e,t,e,n,r,a);M.$$addScopeClass(e);var s=null;return function(t,n,r){ce(t,"scope");var a=(r=r||{}).parentBoundTranscludeFn,i=r.transcludeControllers,l=r.futureParentElement;a&&a.$$boundTransclude&&(a=a.$$boundTransclude),s||(s=L(l));var u;if(u="html"!==s?$r(K(s,$r("<div>").append(e).html())):n?la.clone.call(e):e,i)for(var c in i)u.data("$"+c+"Controller",i[c].instance);return M.$$addScopeInfo(u,t),n&&n(u,t),o&&o(t,u,u,a),u}}function L(e){var t=e&&e[0];return t&&"foreignobject"!==B(t)&&t.toString().match(/SVG/)?"svg":"html"}function O(e,t,r,a,i,o){function s(e,r,a,i){var o,s,l,u,c,d,f,p;if(h){var m=r.length;for(p=new Array(m),c=0;c<g.length;c+=3)p[f=g[c]]=r[f]}else p=r;for(c=0,d=g.length;c<d;)if(l=p[g[c++]],o=g[c++],s=g[c++],o){if(o.scope){u=e.$new(),M.$$addScopeInfo($r(l),u);var v=o.$$destroyBindings;v&&(o.$$destroyBindings=null,u.$on("$destroyed",v))}else u=e;o(s,u,l,a,o.transcludeOnThisElement?N(e,o.transclude,i):!o.templateOnThisElement&&i?i:!i&&t?N(e,t):null,o)}else s&&s(e,l.childNodes,n,i)}for(var l,u,c,d,f,p,h,g=[],m=0;m<e.length;m++)l=new oe,(c=(u=j(e[m],[],l,0===m?a:n,i)).length?I(u,e[m],l,t,r,null,[],[],o):null)&&c.scope&&M.$$addScopeClass(l.$$element),f=c&&c.terminal||!(d=e[m].childNodes)||!d.length?null:O(d,c?(c.transcludeOnThisElement||!c.templateOnThisElement)&&c.transclude:t),(c||f)&&(g.push(m,c,f),p=!0,h=h||c),o=null;return p?s:null}function N(e,t,n){return function(r,a,i,o,s){return r||((r=e.$new(!1,s)).$$transcluded=!0),t(r,a,{parentBoundTranscludeFn:n,transcludeControllers:i,futureParentElement:o})}}function j(e,t,n,r,a){var i,o,s=e.nodeType,l=n.$attr;switch(s){case zr:H(t,st(B(e)),"E",r,a);for(var u,c,d,h,g,m,v=e.attributes,y=0,b=v&&v.length;y<b;y++){var x=!1,$=!1;c=(u=v[y]).name,g=jr(u.value),h=st(c),(m=fe.test(h))&&(c=c.replace(Ea,"").substr(8).replace(/_(.)/g,function(e,t){return t.toUpperCase()}));var _=h.replace(/(Start|End)$/,"");Y(_)&&h===_+"Start"&&(x=c,$=c.substr(0,c.length-5)+"end",c=c.substr(0,c.length-6)),l[d=st(c.toLowerCase())]=c,!m&&n.hasOwnProperty(d)||(n[d]=g,Ue(e,d)&&(n[d]=!0)),te(e,t,g,d,m),H(t,d,"A",r,a,x,$)}if(o=e.className,w(o)&&(o=o.animVal),C(o)&&""!==o)for(;i=p.exec(o);)H(t,d=st(i[2]),"C",r,a)&&(n[d]=jr(i[3])),o=o.substr(i.index+i[0].length);break;case Vr:if(11===wr)for(;e.parentNode&&e.nextSibling&&e.nextSibling.nodeType===Vr;)e.nodeValue=e.nodeValue+e.nextSibling.nodeValue,e.parentNode.removeChild(e.nextSibling);X(t,e.nodeValue);break;case Hr:try{(i=f.exec(e.nodeValue))&&H(t,d=st(i[1]),"M",r,a)&&(n[d]=jr(i[2]))}catch(e){}}return t.sort(Z),t}function P(e,t,n){var r=[],a=0;if(t&&e.hasAttribute&&e.hasAttribute(t))do{if(!e)throw _a("uterdir","Unterminated attribute, found '{0}' but no matching '{1}' found.",t,n);e.nodeType==zr&&(e.hasAttribute(t)&&a++,e.hasAttribute(n)&&a--),r.push(e),e=e.nextSibling}while(a>0);else r.push(e);return $r(r)}function R(e,t,n){return function(r,a,i,o,s){return a=P(a[0],t,n),e(r,a,i,o,s)}}function I(e,r,i,o,s,u,c,d,f){function p(e,t,n,r){e&&(n&&(e=R(e,n,r)),e.require=v.require,e.directiveName=y,(T===v||v.$$isolateScope)&&(e=re(e,{isolateScope:!0})),c.push(e)),t&&(n&&(t=R(t,n,r)),t.require=v.require,t.directiveName=y,(T===v||v.$$isolateScope)&&(t=re(t,{isolateScope:!0})),d.push(t))}function h(e,t,n,r){var a;if(C(t)){var i=t.match($),o=t.substring(i[0].length),s=i[1]||i[3],l="?"===i[2];if("^^"===s?n=n.parent():a=(a=r&&r[o])&&a.instance,!a){var u="$"+o+"Controller";a=s?n.inheritedData(u):n.data(u)}if(!a&&!l)throw _a("ctreq","Controller '{0}', required by directive '{1}', can't be found!",o,e)}else if(Or(t)){a=[];for(var c=0,d=t.length;c<d;c++)a[c]=h(e,t[c],n,r)}return a||null}function g(e,t,n,r,a,i){var o=ge();for(var s in r){var u=r[s],c={$scope:u===T||u.$$isolateScope?a:i,$element:e,$attrs:t,$transclude:n},d=u.controller;"@"==d&&(d=t[u.name]);var f=l(d,c,!0,u.controllerAs);o[u.name]=f,B||e.data("$"+u.name+"Controller",f.instance)}return o}function m(e,t,a,o,s,l){function u(e,t,r){var a;return D(e)||(r=t,t=e,e=n),B&&(a=b),r||(r=B?w.parent():w),s(e,t,a,r,L)}var f,p,m,v,y,b,x,w,$;if(r===a?($=i,w=i.$$element):(w=$r(a),$=new oe(w,i)),T&&(y=t.$new(!0)),s&&((x=u).$$boundTransclude=s),S&&(b=g(w,$,x,S,y,t)),T&&(M.$$addScopeInfo(w,y,!0,!(F&&(F===T||F===T.$$originalDirective))),M.$$addScopeClass(w,!0),y.$$isolateBindings=T.$$isolateBindings,ie(t,$,y,y.$$isolateBindings,T,y)),b){var C,_,E=T||k;E&&b[E.name]&&(C=E.$$bindings.bindToController,(v=b[E.name])&&v.identifier&&C&&(_=v,l.$$destroyBindings=ie(t,$,v.instance,C,E)));for(f in b){var A=(v=b[f])();A!==v.instance&&(v.instance=A,w.data("$"+f+"Controller",A),v===_&&(l.$$destroyBindings(),l.$$destroyBindings=ie(t,$,A,C,E)))}}for(f=0,p=c.length;f<p;f++)ae(m=c[f],m.isolateScope?y:t,w,$,m.require&&h(m.directiveName,m.require,w,b),x);var L=t;for(T&&(T.template||null===T.templateUrl)&&(L=y),e&&e(L,a.childNodes,n,s),f=d.length-1;f>=0;f--)ae(m=d[f],m.isolateScope?y:t,w,$,m.require&&h(m.directiveName,m.require,w,b),x)}f=f||{};for(var v,y,b,x,_,E=-Number.MAX_VALUE,k=f.newScopeDirective,S=f.controllerDirectives,T=f.newIsolateScopeDirective,F=f.templateDirective,L=f.nonTlbTranscludeDirective,O=!1,N=!1,B=f.hasElementTranscludeDirective,q=i.$$element=$r(r),I=u,U=o,H=0,Y=e.length;H<Y;H++){var Z=(v=e[H]).$$start,X=v.$$end;if(Z&&(q=P(r,Z,X)),b=n,E>v.priority)break;if((_=v.scope)&&(v.templateUrl||(w(_)?(J("new/isolated scope",T||k,v,q),T=v):J("new/isolated scope",T,v,q)),k=k||v),y=v.name,!v.templateUrl&&v.controller&&(_=v.controller,S=S||ge(),J("'"+y+"' controller",S[y],v,q),S[y]=v),(_=v.transclude)&&(O=!0,v.$$tlb||(J("transclusion",L,v,q),L=v),"element"==_?(B=!0,E=v.priority,b=q,q=i.$$element=$r(t.createComment(" "+y+": "+i[y]+" ")),r=q[0],ne(s,V(b),r),U=M(b,o,E,I&&I.name,{nonTlbTranscludeDirective:L})):(b=$r(ke(r)).contents(),q.empty(),U=M(b,o))),v.template)if(N=!0,J("template",F,v,q),F=v,_=A(v.template)?v.template(q,i):v.template,_=de(_),v.replace){if(I=v,b=we(_)?[]:ut(K(v.templateNamespace,jr(_))),r=b[0],1!=b.length||r.nodeType!==zr)throw _a("tplrt","Template for directive '{0}' must have exactly one root element. {1}",y,"");ne(s,q,r);var ee={$attr:{}},te=j(r,[],ee),se=e.splice(H+1,e.length-(H+1));T&&z(te),e=e.concat(te).concat(se),G(i,ee),Y=e.length}else q.html(_);if(v.templateUrl)N=!0,J("template",F,v,q),F=v,v.replace&&(I=v),m=W(e.splice(H,e.length-H),q,i,s,O&&U,c,d,{controllerDirectives:S,newScopeDirective:k!==v&&k,newIsolateScopeDirective:T,templateDirective:F,nonTlbTranscludeDirective:L}),Y=e.length;else if(v.compile)try{A(x=v.compile(q,i,U))?p(null,x,Z,X):x&&p(x.pre,x.post,Z,X)}catch(e){a(e,Q(q))}v.terminal&&(m.terminal=!0,E=Math.max(E,v.priority))}return m.scope=k&&!0===k.scope,m.transcludeOnThisElement=O,m.templateOnThisElement=N,m.transclude=U,f.hasElementTranscludeDirective=B,m}function z(e){for(var t=0,n=e.length;t<n;t++)e[t]=h(e[t],{$$isolateScope:!0})}function H(t,r,i,o,s,l,d){if(r===s)return null;var f=null;if(u.hasOwnProperty(r))for(var p,g=e.get(r+c),m=0,v=g.length;m<v;m++)try{p=g[m],(o===n||o>p.priority)&&-1!=p.restrict.indexOf(i)&&(l&&(p=h(p,{$$start:l,$$end:d})),t.push(p),f=p)}catch(e){a(e)}return f}function Y(t){if(u.hasOwnProperty(t))for(var n=e.get(t+c),r=0,a=n.length;r<a;r++)if(n[r].multiElement)return!0;return!1}function G(e,t){var n=t.$attr,r=e.$attr,a=e.$$element;i(e,function(r,a){"$"!=a.charAt(0)&&(t[a]&&t[a]!==r&&(r+=("style"===a?";":" ")+t[a]),e.$set(a,r,!0,n[a]))}),i(t,function(t,i){"class"==i?(F(a,t),e.class=(e.class?e.class+" ":"")+t):"style"==i?(a.attr("style",a.attr("style")+";"+t),e.style=(e.style?e.style+";":"")+t):"$"==i.charAt(0)||e.hasOwnProperty(i)||(e[i]=t,r[i]=n[i])})}function W(e,t,n,r,a,s,l,u){var c,d,f=[],p=t[0],g=e.shift(),m=h(g,{templateUrl:null,transclude:null,replace:null,$$originalDirective:g}),v=A(g.templateUrl)?g.templateUrl(t,n):g.templateUrl,y=g.templateNamespace;return t.empty(),o(v).then(function(o){var h,b,x,$;if(o=de(o),g.replace){if(x=we(o)?[]:ut(K(y,jr(o))),h=x[0],1!=x.length||h.nodeType!==zr)throw _a("tplrt","Template for directive '{0}' must have exactly one root element. {1}",g.name,v);b={$attr:{}},ne(r,t,h);var C=j(h,[],b);w(g.scope)&&z(C),e=C.concat(e),G(n,b)}else h=p,t.html(o);for(e.unshift(m),c=I(e,h,n,a,t,g,s,l,u),i(r,function(e,n){e==h&&(r[n]=t[0])}),d=O(t[0].childNodes,a);f.length;){var _=f.shift(),E=f.shift(),A=f.shift(),k=f.shift(),S=t[0];if(!_.$$destroyed){if(E!==p){var D=E.className;u.hasElementTranscludeDirective&&g.replace||(S=ke(h)),ne(A,$r(E),S),F($r(S),D)}$=c.transcludeOnThisElement?N(_,c.transclude,k):k,c(d,_,S,r,$,c)}}f=null}),function(e,t,n,r,a){var i=a;t.$$destroyed||(f?f.push(t,n,r,i):(c.transcludeOnThisElement&&(i=N(t,c.transclude,a)),c(d,t,n,r,i,c)))}}function Z(e,t){var n=t.priority-e.priority;return 0!==n?n:e.name!==t.name?e.name<t.name?-1:1:e.index-t.index}function J(e,t,n,r){function a(e){return e?" (module: "+e+")":""}if(t)throw _a("multidir","Multiple directives [{0}{1}, {2}{3}] asking for {4} on: {5}",t.name,a(t.$$moduleName),n.name,a(n.$$moduleName),e,Q(r))}function X(e,t){var n=r(t,!0);n&&e.push({priority:0,compile:function(e){var t=e.parent(),r=!!t.length;return r&&M.$$addBindingClass(t),function(e,t){var a=t.parent();r||M.$$addBindingClass(a),M.$$addBindingInfo(a,n.expressions),e.$watch(n,function(e){t[0].nodeValue=e})}}})}function K(e,n){switch(e=mr(e||"html")){case"svg":case"math":var r=t.createElement("div");return r.innerHTML="<"+e+">"+n+"</"+e+">",r.childNodes[0].childNodes;default:return n}}function ee(e,t){if("srcdoc"==t)return k.HTML;var n=B(e);return"xlinkHref"==t||"form"==n&&"action"==t||"img"!=n&&("src"==t||"ngSrc"==t)?k.RESOURCE_URL:void 0}function te(e,t,n,a,i){var o=ee(e,a);i=y[a]||i;var s=r(n,!0,o,i);if(s){if("multiple"===a&&"select"===B(e))throw _a("selmulti","Binding to the 'multiple' attribute is not supported. Element: {0}",Q(e));t.push({priority:100,compile:function(){return{pre:function(e,t,l){var u=l.$$observers||(l.$$observers={});if(_.test(a))throw _a("nodomevents","Interpolations for HTML DOM event attributes are disallowed.  Please use the ng- versions (such as ng-click instead of onclick) instead.");var c=l[a];c!==n&&(s=c&&r(c,!0,o,i),n=c),s&&(l[a]=s(e),(u[a]||(u[a]=[])).$$inter=!0,(l.$$observers&&l.$$observers[a].$$scope||e).$watch(s,function(e,t){"class"===a&&e!=t?l.$updateClass(e,t):l.$set(a,e)}))}}}})}}function ne(e,n,r){var a,i,o=n[0],s=n.length,l=o.parentNode;if(e)for(a=0,i=e.length;a<i;a++)if(e[a]==o){e[a++]=r;for(var u=a,c=u+s-1,d=e.length;u<d;u++,c++)c<d?e[u]=e[c]:delete e[u];e.length-=s-1,e.context===o&&(e.context=r);break}l&&l.replaceChild(r,o);var f=t.createDocumentFragment();f.appendChild(o),$r.hasData(o)&&($r(r).data($r(o).data()),Cr?(Lr=!0,Cr.cleanData([o])):delete $r.cache[o[$r.expando]]);for(var p=1,h=n.length;p<h;p++){var g=n[p];$r(g).remove(),f.appendChild(g),delete n[p]}n[0]=r,n.length=1}function re(e,t){return d(function(){return e.apply(null,arguments)},e,t)}function ae(e,t,n,r,i,o){try{e(t,n,r,i,o)}catch(e){a(e,Q(n))}}function ie(e,t,n,a,o,l){var u;i(a,function(a,i){var l,c,d,f,p=a.attrName,h=a.optional;switch(a.mode){case"@":h||vr.call(t,p)||(n[i]=t[p]=void 0),t.$observe(p,function(e){C(e)&&(n[i]=e)}),t.$$observers[p].$$scope=e,C(t[p])&&(n[i]=r(t[p])(e));break;case"=":if(!vr.call(t,p)){if(h)break;t[p]=void 0}if(h&&!t[p])break;c=s(t[p]),f=c.literal?U:function(e,t){return e===t||e!==e&&t!==t},d=c.assign||function(){throw l=n[i]=c(e),_a("nonassign","Expression '{0}' used with directive '{1}' is non-assignable!",t[p],o.name)},l=n[i]=c(e);var m=function(t){return f(t,n[i])||(f(t,l)?d(e,t=n[i]):n[i]=t),l=t};m.$stateful=!0;var v;v=a.collection?e.$watchCollection(t[p],m):e.$watch(s(t[p],m),null,c.literal),(u=u||[]).push(v);break;case"&":if((c=t.hasOwnProperty(p)?s(t[p]):g)===g&&h)break;n[i]=function(t){return c(e,t)}}});var c=u?function(){for(var e=0,t=u.length;e<t;++e)u[e]()}:g;return l&&c!==g?(l.$on("$destroy",c),g):c}var oe=function(e,t){if(t){var n,r,a,i=Object.keys(t);for(n=0,r=i.length;n<r;n++)this[a=i[n]]=t[a]}else this.$attr={};this.$$element=e};oe.prototype={$normalize:st,$addClass:function(e){e&&e.length>0&&S.addClass(this.$$element,e)},$removeClass:function(e){e&&e.length>0&&S.removeClass(this.$$element,e)},$updateClass:function(e,t){var n=lt(e,t);n&&n.length&&S.addClass(this.$$element,n);var r=lt(t,e);r&&r.length&&S.removeClass(this.$$element,r)},$set:function(e,t,r,o){var s,l=this.$$element[0],u=Ue(l,e),c=ze(l,e),d=e;if(u?(this.$$element.prop(e,t),o=u):c&&(this[c]=t,d=c),this[e]=t,o?this.$attr[e]=o:(o=this.$attr[e])||(this.$attr[e]=o=ue(e,"-")),"a"===(s=B(this.$$element))&&"href"===e||"img"===s&&"src"===e)this[e]=t=T(t,"src"===e);else if("img"===s&&"srcset"===e){for(var f="",p=jr(t),h=/(\s+\d+x\s*,|\s+\d+w\s*,|\s+,|,\s+)/,g=/\s/.test(p)?h:/(,)/,m=p.split(g),v=Math.floor(m.length/2),y=0;y<v;y++){var b=2*y;f+=T(jr(m[b]),!0),f+=" "+jr(m[b+1])}var x=jr(m[2*y]).split(/\s/);f+=T(jr(x[0]),!0),2===x.length&&(f+=" "+jr(x[1])),this[e]=t=f}!1!==r&&(null===t||t===n?this.$$element.removeAttr(o):this.$$element.attr(o,t));var w=this.$$observers;w&&i(w[d],function(e){try{e(t)}catch(e){a(e)}})},$observe:function(e,t){var n=this,r=n.$$observers||(n.$$observers=ge()),a=r[e]||(r[e]=[]);return a.push(t),v.$evalAsync(function(){a.$$inter||!n.hasOwnProperty(e)||b(n[e])||t(n[e])}),function(){q(a,t)}}};var se=r.startSymbol(),le=r.endSymbol(),de="{{"==se||"}}"==le?m:function(e){return e.replace(/\{\{/g,se).replace(/}}/g,le)},fe=/^ngAttr[A-Z]/;return M.$$addBindingInfo=E?function(e,t){var n=e.data("$binding")||[];Or(t)?n=n.concat(t):n.push(t),e.data("$binding",n)}:g,M.$$addBindingClass=E?function(e){F(e,"ng-binding")}:g,M.$$addScopeInfo=E?function(e,t,n,r){var a=n?r?"$isolateScopeNoTemplate":"$isolateScope":"$scope";e.data(a,t)}:g,M.$$addScopeClass=E?function(e,t){F(e,t?"ng-isolate-scope":"ng-scope")}:g,M}]}function st(e){return xe(e.replace(Ea,""))}function lt(e,t){var n="",r=e.split(/\s+/),a=t.split(/\s+/);e:for(var i=0;i<r.length;i++){for(var o=r[i],s=0;s<a.length;s++)if(o==a[s])continue e;n+=(n.length>0?" ":"")+o}return n}function ut(e){var t=(e=$r(e)).length;if(t<=1)return e;for(;t--;)e[t].nodeType===Hr&&Ar.call(e,t,1);return e}function ct(e,t){if(t&&C(t))return t;if(C(e)){var n=ka.exec(e);if(n)return n[3]}}function dt(){var e={},t=!1;this.register=function(t,n){fe(t,"controller"),w(t)?d(e,t):e[t]=n},this.allowGlobals=function(){t=!0},this.$get=["$injector","$window",function(a,i){function o(e,t,n,a){if(!e||!w(e.$scope))throw r("$controller")("noscp","Cannot export controller '{0}' as '{1}'! No $scope object provided via `locals`.",a,t);e.$scope[t]=n}return function(r,s,l,u){var c,f,p,h;if(l=!0===l,u&&C(u)&&(h=u),C(r)){if(!(f=r.match(ka)))throw Aa("ctrlfmt","Badly formed controller string '{0}'. Must match `__name__ as __id__` or `__name__`.",r);p=f[1],h=h||f[3],de(r=e.hasOwnProperty(p)?e[p]:pe(s.$scope,p,!0)||(t?pe(i,p,!0):n),p,!0)}if(l){var g=(Or(r)?r[r.length-1]:r).prototype;c=Object.create(g||null),h&&o(s,h,c,p||r.name);return d(function(){var e=a.invoke(r,c,s,p);return e!==c&&(w(e)||A(e))&&(c=e,h&&o(s,h,c,p||r.name)),c},{instance:c,identifier:h})}return c=a.instantiate(r,s,p),h&&o(s,h,c,p||r.name),c}}]}function ft(){this.$get=["$window",function(e){return $r(e.document)}]}function pt(){this.$get=["$log",function(e){return function(t,n){e.error.apply(e,arguments)}}]}function ht(e){return w(e)?E(e)?e.toISOString():G(e):e}function gt(){this.$get=function(){return function(e){if(!e)return"";var t=[];return o(e,function(e,n){null===e||b(e)||(Or(e)?i(e,function(e,r){t.push(re(n)+"="+re(ht(e)))}):t.push(re(n)+"="+re(ht(e))))}),t.join("&")}}}function mt(){this.$get=function(){return function(e){function t(e,r,a){null===e||b(e)||(Or(e)?i(e,function(e,n){t(e,r+"["+(w(e)?n:"")+"]")}):w(e)&&!E(e)?o(e,function(e,n){t(e,r+(a?"":"[")+n+(a?"":"]"))}):n.push(re(r)+"="+re(ht(e))))}if(!e)return"";var n=[];return t(e,"",!0),n.join("&")}}}function vt(e,t){if(C(e)){var n=e.replace(La,"").trim();if(n){var r=t("Content-Type");(r&&0===r.indexOf(Da)||yt(n))&&(e=W(n))}}return e}function yt(e){var t=e.match(Fa);return t&&Ma[t[0]].test(e)}function bt(e){function t(e,t){e&&(r[e]=r[e]?r[e]+", "+t:t)}var n,r=ge();return C(e)?i(e.split("\n"),function(e){n=e.indexOf(":"),t(mr(jr(e.substr(0,n))),jr(e.substr(n+1)))}):w(e)&&i(e,function(e,n){t(mr(n),jr(e))}),r}function xt(e){var t;return function(n){if(t||(t=bt(e)),n){var r=t[mr(n)];return void 0===r&&(r=null),r}return t}}function wt(e,t,n,r){return A(r)?r(e,t,n):(i(r,function(r){e=r(e,t,n)}),e)}function $t(e){return 200<=e&&e<300}function Ct(){var e=this.defaults={transformResponse:[vt],transformRequest:[function(e){return!w(e)||T(e)||M(e)||F(e)?e:G(e)}],headers:{common:{Accept:"application/json, text/plain, */*"},post:I(Ta),put:I(Ta),patch:I(Ta)},xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",paramSerializer:"$httpParamSerializer"},t=!1;this.useApplyAsync=function(e){return x(e)?(t=!!e,this):t};var a=!0;this.useLegacyPromiseExtensions=function(e){return x(e)?(a=!!e,this):a};var o=this.interceptors=[];this.$get=["$httpBackend","$$cookieReader","$cacheFactory","$rootScope","$q","$injector",function(s,l,u,c,f,p){function h(t){function o(e){var t=d({},e);return e.data?t.data=wt(e.data,e.headers,e.status,l.transformResponse):t.data=e.data,$t(e.status)?t:f.reject(t)}function s(e,t){var n,r={};return i(e,function(e,a){A(e)?null!=(n=e(t))&&(r[a]=n):r[a]=e}),r}if(!Fr.isObject(t))throw r("$http")("badreq","Http request configuration must be an object.  Received: {0}",t);var l=d({method:"get",transformRequest:e.transformRequest,transformResponse:e.transformResponse,paramSerializer:e.paramSerializer},t);l.headers=function(t){var n,r,a,i=e.headers,o=d({},t.headers);i=d({},i.common,i[mr(t.method)]);e:for(n in i){r=mr(n);for(a in o)if(mr(a)===r)continue e;o[n]=i[n]}return s(o,I(t))}(t),l.method=yr(l.method),l.paramSerializer=C(l.paramSerializer)?p.get(l.paramSerializer):l.paramSerializer;var u=[function(t){var r=t.headers,a=wt(t.data,xt(r),n,t.transformRequest);return b(a)&&i(r,function(e,t){"content-type"===mr(t)&&delete r[t]}),b(t.withCredentials)&&!b(e.withCredentials)&&(t.withCredentials=e.withCredentials),g(t,a).then(o,o)},n],c=f.when(l);for(i(y,function(e){(e.request||e.requestError)&&u.unshift(e.request,e.requestError),(e.response||e.responseError)&&u.push(e.response,e.responseError)});u.length;){var h=u.shift(),m=u.shift();c=c.then(h,m)}return a?(c.success=function(e){return de(e,"fn"),c.then(function(t){e(t.data,t.status,t.headers,l)}),c},c.error=function(e){return de(e,"fn"),c.then(null,function(t){e(t.data,t.status,t.headers,l)}),c}):(c.success=Na("success"),c.error=Na("error")),c}function g(r,a){function i(e,n,r,a){function i(){o(n,e,r,a)}p&&($t(e)?p.put(_,[e,n,bt(r),a]):p.remove(_)),t?c.$applyAsync(i):(i(),c.$$phase||c.$apply())}function o(e,t,n,a){($t(t=Math.max(t,0))?y.resolve:y.reject)({data:e,status:t,headers:xt(n),config:r,statusText:a})}function u(e){o(e.data,e.status,I(e.headers()),e.statusText)}function d(){var e=h.pendingRequests.indexOf(r);-1!==e&&h.pendingRequests.splice(e,1)}var p,g,y=f.defer(),$=y.promise,C=r.headers,_=m(r.url,r.paramSerializer(r.params));if(h.pendingRequests.push(r),$.then(d,d),!r.cache&&!e.cache||!1===r.cache||"GET"!==r.method&&"JSONP"!==r.method||(p=w(r.cache)?r.cache:w(e.cache)?e.cache:v),p&&(x(g=p.get(_))?O(g)?g.then(u,u):Or(g)?o(g[1],g[0],I(g[2]),g[3]):o(g,200,{},"OK"):p.put(_,$)),b(g)){var E=Cn(r.url)?l()[r.xsrfCookieName||e.xsrfCookieName]:n;E&&(C[r.xsrfHeaderName||e.xsrfHeaderName]=E),s(r.method,_,a,i,C,r.timeout,r.withCredentials,r.responseType)}return $}function m(e,t){return t.length>0&&(e+=(-1==e.indexOf("?")?"?":"&")+t),e}var v=u("$http");e.paramSerializer=C(e.paramSerializer)?p.get(e.paramSerializer):e.paramSerializer;var y=[];return i(o,function(e){y.unshift(C(e)?p.get(e):p.invoke(e))}),h.pendingRequests=[],function(e){i(arguments,function(e){h[e]=function(t,n){return h(d({},n||{},{method:e,url:t}))}})}("get","delete","head","jsonp"),function(e){i(arguments,function(e){h[e]=function(t,n,r){return h(d({},r||{},{method:e,url:t,data:n}))}})}("post","put","patch"),h.defaults=e,h}]}function _t(){return new e.XMLHttpRequest}function Et(){this.$get=["$browser","$window","$document",function(e,t,n){return At(e,_t,e.defer,t.angular.callbacks,n[0])}]}function At(e,t,r,a,o){function s(e,t,n){var r=o.createElement("script"),i=null;return r.type="text/javascript",r.src=e,r.async=!0,i=function(e){Qr(r,"load",i),Qr(r,"error",i),o.body.removeChild(r),r=null;var s=-1,l="unknown";e&&("load"!==e.type||a[t].called||(e={type:"error"}),l=e.type,s="error"===e.type?404:200),n&&n(s,l)},Xr(r,"load",i),Xr(r,"error",i),o.body.appendChild(r),i}return function(o,l,u,c,d,f,p,h){function m(){b&&b(),w&&w.abort()}function v(t,a,i,o,s){C!==n&&r.cancel(C),b=w=null,t(a,i,o,s),e.$$completeOutstandingRequest(g)}if(e.$$incOutstandingRequestCount(),l=l||e.url(),"jsonp"==mr(o)){var y="_"+(a.counter++).toString(36);a[y]=function(e){a[y].data=e,a[y].called=!0};var b=s(l.replace("JSON_CALLBACK","angular.callbacks."+y),y,function(e,t){v(c,e,a[y].data,"",t),a[y]=g})}else{var w=t();w.open(o,l,!0),i(d,function(e,t){x(e)&&w.setRequestHeader(t,e)}),w.onload=function(){var e=w.statusText||"",t="response"in w?w.response:w.responseText,n=1223===w.status?204:w.status;0===n&&(n=t?200:"file"==$n(l).protocol?404:0),v(c,n,t,w.getAllResponseHeaders(),e)};var $=function(){v(c,-1,null,null,"")};if(w.onerror=$,w.onabort=$,p&&(w.withCredentials=!0),h)try{w.responseType=h}catch(e){if("json"!==h)throw e}w.send(u)}if(f>0)var C=r(m,f);else O(f)&&f.then(m)}}function kt(){var e="{{",t="}}";this.startSymbol=function(t){return t?(e=t,this):e},this.endSymbol=function(e){return e?(t=e,this):t},this.$get=["$parse","$exceptionHandler","$sce",function(n,r,a){function i(e){return"\\\\\\"+e}function o(n){return n.replace(f,e).replace(p,t)}function s(e){if(null==e)return"";switch(typeof e){case"string":break;case"number":e=""+e;break;default:e=G(e)}return e}function l(i,l,f,p){function h(e){try{return e=S(e),p&&!x(e)?e:s(e)}catch(e){r(ja.interr(i,e))}}p=!!p;for(var g,m,v,y=0,w=[],$=[],C=i.length,_=[],E=[];y<C;){if(-1==(g=i.indexOf(e,y))||-1==(m=i.indexOf(t,g+u))){y!==C&&_.push(o(i.substring(y)));break}y!==g&&_.push(o(i.substring(y,g))),v=i.substring(g+u,m),w.push(v),$.push(n(v,h)),y=m+c,E.push(_.length),_.push("")}if(f&&_.length>1&&ja.throwNoconcat(i),!l||w.length){var k=function(e){for(var t=0,n=w.length;t<n;t++){if(p&&b(e[t]))return;_[E[t]]=e[t]}return _.join("")},S=function(e){return f?a.getTrusted(f,e):a.valueOf(e)};return d(function(e){var t=0,n=w.length,a=new Array(n);try{for(;t<n;t++)a[t]=$[t](e);return k(a)}catch(e){r(ja.interr(i,e))}},{exp:i,expressions:w,$$watchDelegate:function(e,t){var n;return e.$watchGroup($,function(r,a){var i=k(r);A(t)&&t.call(this,i,r!==a?n:i,e),n=i})}})}}var u=e.length,c=t.length,f=new RegExp(e.replace(/./g,i),"g"),p=new RegExp(t.replace(/./g,i),"g");return l.startSymbol=function(){return e},l.endSymbol=function(){return t},l}]}function St(){this.$get=["$rootScope","$window","$q","$$q",function(e,t,n,r){function a(a,o,s,l){var u=arguments.length>4,c=u?V(arguments,4):[],d=t.setInterval,f=t.clearInterval,p=0,h=x(l)&&!l,g=(h?r:n).defer(),m=g.promise;return s=x(s)?s:0,m.then(null,null,u?function(){a.apply(null,c)}:a),m.$$intervalId=d(function(){g.notify(p++),s>0&&p>=s&&(g.resolve(p),f(m.$$intervalId),delete i[m.$$intervalId]),h||e.$apply()},o),i[m.$$intervalId]=g,m}var i={};return a.cancel=function(e){return!!(e&&e.$$intervalId in i)&&(i[e.$$intervalId].reject("canceled"),t.clearInterval(e.$$intervalId),delete i[e.$$intervalId],!0)},a}]}function Dt(e){for(var t=e.split("/"),n=t.length;n--;)t[n]=ne(t[n]);return t.join("/")}function Tt(e,t){var n=$n(e);t.$$protocol=n.protocol,t.$$host=n.hostname,t.$$port=p(n.port)||Ba[n.protocol]||null}function Ft(e,t){var n="/"!==e.charAt(0);n&&(e="/"+e);var r=$n(e);t.$$path=decodeURIComponent(n&&"/"===r.pathname.charAt(0)?r.pathname.substring(1):r.pathname),t.$$search=ee(r.search),t.$$hash=decodeURIComponent(r.hash),t.$$path&&"/"!=t.$$path.charAt(0)&&(t.$$path="/"+t.$$path)}function Mt(e,t){if(0===t.indexOf(e))return t.substr(e.length)}function Lt(e){var t=e.indexOf("#");return-1==t?e:e.substr(0,t)}function Ot(e){return e.replace(/(#.+)|#$/,"$1")}function Nt(e){return e.substr(0,Lt(e).lastIndexOf("/")+1)}function jt(e){return e.substring(0,e.indexOf("/",e.indexOf("//")+2))}function Pt(e,t,r){this.$$html5=!0,r=r||"",Tt(e,this),this.$$parse=function(e){var n=Mt(t,e);if(!C(n))throw qa("ipthprfx",'Invalid url "{0}", missing path prefix "{1}".',e,t);Ft(n,this),this.$$path||(this.$$path="/"),this.$$compose()},this.$$compose=function(){var e=te(this.$$search),n=this.$$hash?"#"+ne(this.$$hash):"";this.$$url=Dt(this.$$path)+(e?"?"+e:"")+n,this.$$absUrl=t+this.$$url.substr(1)},this.$$parseLinkUrl=function(a,i){if(i&&"#"===i[0])return this.hash(i.slice(1)),!0;var o,s,l;return(o=Mt(e,a))!==n?(s=o,l=(o=Mt(r,o))!==n?t+(Mt("/",o)||o):e+s):(o=Mt(t,a))!==n?l=t+o:t==a+"/"&&(l=t),l&&this.$$parse(l),!!l}}function Bt(e,t,n){Tt(e,this),this.$$parse=function(r){var a,i=Mt(e,r)||Mt(t,r);b(i)||"#"!==i.charAt(0)?this.$$html5?a=i:(a="",b(i)&&(e=r,this.replace())):b(a=Mt(n,i))&&(a=i),Ft(a,this),this.$$path=function(e,t,n){var r,a=/^\/[A-Z]:(\/.*)/;return 0===t.indexOf(n)&&(t=t.replace(n,"")),a.exec(t)?e:(r=a.exec(e),r?r[1]:e)}(this.$$path,a,e),this.$$compose()},this.$$compose=function(){var t=te(this.$$search),r=this.$$hash?"#"+ne(this.$$hash):"";this.$$url=Dt(this.$$path)+(t?"?"+t:"")+r,this.$$absUrl=e+(this.$$url?n+this.$$url:"")},this.$$parseLinkUrl=function(t,n){return Lt(e)==Lt(t)&&(this.$$parse(t),!0)}}function qt(e,t,n){this.$$html5=!0,Bt.apply(this,arguments),this.$$parseLinkUrl=function(r,a){if(a&&"#"===a[0])return this.hash(a.slice(1)),!0;var i,o;return e==Lt(r)?i=r:(o=Mt(t,r))?i=e+n+o:t===r+"/"&&(i=t),i&&this.$$parse(i),!!i},this.$$compose=function(){var t=te(this.$$search),r=this.$$hash?"#"+ne(this.$$hash):"";this.$$url=Dt(this.$$path)+(t?"?"+t:"")+r,this.$$absUrl=e+n+this.$$url}}function Rt(e){return function(){return this[e]}}function It(e,t){return function(n){return b(n)?this[e]:(this[e]=t(n),this.$$compose(),this)}}function Ut(){var e="",t={enabled:!1,requireBase:!0,rewriteLinks:!0};this.hashPrefix=function(t){return x(t)?(e=t,this):e},this.html5Mode=function(e){return L(e)?(t.enabled=e,this):w(e)?(L(e.enabled)&&(t.enabled=e.enabled),L(e.requireBase)&&(t.requireBase=e.requireBase),L(e.rewriteLinks)&&(t.rewriteLinks=e.rewriteLinks),this):t},this.$get=["$rootScope","$browser","$sniffer","$rootElement","$window",function(n,r,a,i,o){function s(e,t,n){var a=u.url(),i=u.$$state;try{r.url(e,t,n),u.$$state=r.state()}catch(e){throw u.url(a),u.$$state=i,e}}function l(e,t){n.$broadcast("$locationChangeSuccess",u.absUrl(),e,u.$$state,t)}var u,c,d,f=r.baseHref(),p=r.url();if(t.enabled){if(!f&&t.requireBase)throw qa("nobase","$location in HTML5 mode requires a <base> tag to be present!");d=jt(p)+(f||"/"),c=a.history?Pt:qt}else d=Lt(p),c=Bt;var h=Nt(d);(u=new c(d,h,"#"+e)).$$parseLinkUrl(p,p),u.$$state=r.state();var g=/^\s*(javascript|mailto):/i;i.on("click",function(e){if(t.rewriteLinks&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&2!=e.which&&2!=e.button){for(var a=$r(e.target);"a"!==B(a[0]);)if(a[0]===i[0]||!(a=a.parent())[0])return;var s=a.prop("href"),l=a.attr("href")||a.attr("xlink:href");w(s)&&"[object SVGAnimatedString]"===s.toString()&&(s=$n(s.animVal).href),g.test(s)||!s||a.attr("target")||e.isDefaultPrevented()||u.$$parseLinkUrl(s,l)&&(e.preventDefault(),u.absUrl()!=r.url()&&(n.$apply(),o.angular["ff-684208-preventDefault"]=!0))}}),Ot(u.absUrl())!=Ot(p)&&r.url(u.absUrl(),!0);var m=!0;return r.onUrlChange(function(e,t){b(Mt(h,e))?o.location.href=e:(n.$evalAsync(function(){var r,a=u.absUrl(),i=u.$$state;u.$$parse(e),u.$$state=t,r=n.$broadcast("$locationChangeStart",e,a,t,i).defaultPrevented,u.absUrl()===e&&(r?(u.$$parse(a),u.$$state=i,s(a,!1,i)):(m=!1,l(a,i)))}),n.$$phase||n.$digest())}),n.$watch(function(){var e=Ot(r.url()),t=Ot(u.absUrl()),i=r.state(),o=u.$$replace,c=e!==t||u.$$html5&&a.history&&i!==u.$$state;(m||c)&&(m=!1,n.$evalAsync(function(){var t=u.absUrl(),r=n.$broadcast("$locationChangeStart",t,e,u.$$state,i).defaultPrevented;u.absUrl()===t&&(r?(u.$$parse(e),u.$$state=i):(c&&s(t,o,i===u.$$state?null:u.$$state),l(e,i)))})),u.$$replace=!1}),u}]}function zt(){var e=!0,t=this;this.debugEnabled=function(t){return x(t)?(e=t,this):e},this.$get=["$window",function(n){function r(e){return e instanceof Error&&(e.stack?e=e.message&&-1===e.stack.indexOf(e.message)?"Error: "+e.message+"\n"+e.stack:e.stack:e.sourceURL&&(e=e.message+"\n"+e.sourceURL+":"+e.line)),e}function a(e){var t=n.console||{},a=t[e]||t.log||g,o=!1;try{o=!!a.apply}catch(e){}return o?function(){var e=[];return i(arguments,function(t){e.push(r(t))}),a.apply(t,e)}:function(e,t){a(e,null==t?"":t)}}return{log:a("log"),info:a("info"),warn:a("warn"),error:a("error"),debug:function(){var n=a("debug");return function(){e&&n.apply(t,arguments)}}()}}]}function Vt(e,t){if("__defineGetter__"===e||"__defineSetter__"===e||"__lookupGetter__"===e||"__lookupSetter__"===e||"__proto__"===e)throw Ia("isecfld","Attempting to access a disallowed field in Angular expressions! Expression: {0}",t);return e}function Ht(e,t){if(e){if(e.constructor===e)throw Ia("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e.window===e)throw Ia("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",t);if(e.children&&(e.nodeName||e.prop&&e.attr&&e.find))throw Ia("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",t);if(e===Object)throw Ia("isecobj","Referencing Object in Angular expressions is disallowed! Expression: {0}",t)}return e}function Yt(e,t){if(e){if(e.constructor===e)throw Ia("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",t);if(e===Ua||e===za||e===Va)throw Ia("isecff","Referencing call, apply or bind in Angular expressions is disallowed! Expression: {0}",t)}}function Gt(e,t){return void 0!==e?e:t}function Wt(e,t){return void 0===e?t:void 0===t?e:e+t}function Zt(e,t){return!e(t).$stateful}function Jt(e,t){var n,r;switch(e.type){case Wa.Program:n=!0,i(e.body,function(e){Jt(e.expression,t),n=n&&e.expression.constant}),e.constant=n;break;case Wa.Literal:e.constant=!0,e.toWatch=[];break;case Wa.UnaryExpression:Jt(e.argument,t),e.constant=e.argument.constant,e.toWatch=e.argument.toWatch;break;case Wa.BinaryExpression:Jt(e.left,t),Jt(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.left.toWatch.concat(e.right.toWatch);break;case Wa.LogicalExpression:Jt(e.left,t),Jt(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=e.constant?[]:[e];break;case Wa.ConditionalExpression:Jt(e.test,t),Jt(e.alternate,t),Jt(e.consequent,t),e.constant=e.test.constant&&e.alternate.constant&&e.consequent.constant,e.toWatch=e.constant?[]:[e];break;case Wa.Identifier:e.constant=!1,e.toWatch=[e];break;case Wa.MemberExpression:Jt(e.object,t),e.computed&&Jt(e.property,t),e.constant=e.object.constant&&(!e.computed||e.property.constant),e.toWatch=[e];break;case Wa.CallExpression:n=!!e.filter&&Zt(t,e.callee.name),r=[],i(e.arguments,function(e){Jt(e,t),n=n&&e.constant,e.constant||r.push.apply(r,e.toWatch)}),e.constant=n,e.toWatch=e.filter&&Zt(t,e.callee.name)?r:[e];break;case Wa.AssignmentExpression:Jt(e.left,t),Jt(e.right,t),e.constant=e.left.constant&&e.right.constant,e.toWatch=[e];break;case Wa.ArrayExpression:n=!0,r=[],i(e.elements,function(e){Jt(e,t),n=n&&e.constant,e.constant||r.push.apply(r,e.toWatch)}),e.constant=n,e.toWatch=r;break;case Wa.ObjectExpression:n=!0,r=[],i(e.properties,function(e){Jt(e.value,t),n=n&&e.value.constant,e.value.constant||r.push.apply(r,e.value.toWatch)}),e.constant=n,e.toWatch=r;break;case Wa.ThisExpression:e.constant=!1,e.toWatch=[]}}function Xt(e){if(1==e.length){var t=e[0].expression,r=t.toWatch;return 1!==r.length?r:r[0]!==t?r:n}}function Qt(e){return e.type===Wa.Identifier||e.type===Wa.MemberExpression}function Kt(e){if(1===e.body.length&&Qt(e.body[0].expression))return{type:Wa.AssignmentExpression,left:e.body[0].expression,right:{type:Wa.NGValueParameter},operator:"="}}function en(e){return 0===e.body.length||1===e.body.length&&(e.body[0].expression.type===Wa.Literal||e.body[0].expression.type===Wa.ArrayExpression||e.body[0].expression.type===Wa.ObjectExpression)}function tn(e){return e.constant}function nn(e,t){this.astBuilder=e,this.$filter=t}function rn(e,t){this.astBuilder=e,this.$filter=t}function an(e){return"constructor"==e}function on(e){return A(e.valueOf)?e.valueOf():Ja.call(e)}function sn(){var e=ge(),t=ge();this.$get=["$filter",function(r){function a(e,t){return null==e||null==t?e===t:("object"!=typeof e||"object"!=typeof(e=on(e)))&&(e===t||e!==e&&t!==t)}function o(e,t,r,i,o){var s,l=i.inputs;if(1===l.length){var u=a;return l=l[0],e.$watch(function(e){var t=l(e);return a(t,u)||(s=i(e,n,n,[t]),u=t&&on(t)),s},t,r,o)}for(var c=[],d=[],f=0,p=l.length;f<p;f++)c[f]=a,d[f]=null;return e.$watch(function(e){for(var t=!1,r=0,o=l.length;r<o;r++){var u=l[r](e);(t||(t=!a(u,c[r])))&&(d[r]=u,c[r]=u&&on(u))}return t&&(s=i(e,n,n,d)),s},t,r,o)}function s(e,t,n,r){var a,i;return a=e.$watch(function(e){return r(e)},function(e,n,r){i=e,A(t)&&t.apply(this,arguments),x(e)&&r.$$postDigest(function(){x(i)&&a()})},n)}function l(e,t,n,r){function a(e){var t=!0;return i(e,function(e){x(e)||(t=!1)}),t}var o,s;return o=e.$watch(function(e){return r(e)},function(e,n,r){s=e,A(t)&&t.call(this,e,n,r),a(e)&&r.$$postDigest(function(){a(s)&&o()})},n)}function u(e,t,n,r){var a;return a=e.$watch(function(e){return r(e)},function(e,n,r){A(t)&&t.apply(this,arguments),a()},n)}function c(e,t){if(!t)return e;var n=e.$$watchDelegate,r=n!==l&&n!==s?function(n,r,a,i){var o=e(n,r,a,i);return t(o,n,r)}:function(n,r,a,i){var o=e(n,r,a,i),s=t(o,n,r);return x(o)?s:o};return e.$$watchDelegate&&e.$$watchDelegate!==o?r.$$watchDelegate=e.$$watchDelegate:t.$stateful||(r.$$watchDelegate=o,r.inputs=e.inputs?e.inputs:[e]),r}var d=Br().noUnsafeEval,f={csp:d,expensiveChecks:!1},p={csp:d,expensiveChecks:!0};return function(n,a,i){var d,h,m;switch(typeof n){case"string":m=n=n.trim();var v=i?t:e;if(!(d=v[m])){":"===n.charAt(0)&&":"===n.charAt(1)&&(h=!0,n=n.substring(2));var y=i?p:f,b=new Ga(y);(d=new Za(b,r,y).parse(n)).constant?d.$$watchDelegate=u:h?d.$$watchDelegate=d.literal?l:s:d.inputs&&(d.$$watchDelegate=o),v[m]=d}return c(d,a);case"function":return c(n,a);default:return g}}}]}function ln(){this.$get=["$rootScope","$exceptionHandler",function(e,t){return cn(function(t){e.$evalAsync(t)},t)}]}function un(){this.$get=["$browser","$exceptionHandler",function(e,t){return cn(function(t){e.defer(t)},t)}]}function cn(e,t){function a(e,t,n){function r(t){return function(n){a||(a=!0,t.call(e,n))}}var a=!1;return[r(t),r(n)]}function o(){this.$$state={status:0}}function s(e,t){return function(n){t.call(e,n)}}function l(e){var r,a,i;i=e.pending,e.processScheduled=!1,e.pending=n;for(var o=0,s=i.length;o<s;++o){a=i[o][0],r=i[o][e.status];try{A(r)?a.resolve(r(e.value)):1===e.status?a.resolve(e.value):a.reject(e.value)}catch(e){a.reject(e),t(e)}}}function u(t){!t.processScheduled&&t.pending&&(t.processScheduled=!0,e(function(){l(t)}))}function c(){this.promise=new o,this.resolve=s(this,this.resolve),this.reject=s(this,this.reject),this.notify=s(this,this.notify)}function f(e){var t=new c,n=0,r=Or(e)?[]:{};return i(e,function(e,a){n++,y(e).then(function(e){r.hasOwnProperty(a)||(r[a]=e,--n||t.resolve(r))},function(e){r.hasOwnProperty(a)||t.reject(e)})}),0===n&&t.resolve(r),t.promise}var p=r("$q",TypeError),h=function(){return new c};d(o.prototype,{then:function(e,t,n){if(b(e)&&b(t)&&b(n))return this;var r=new c;return this.$$state.pending=this.$$state.pending||[],this.$$state.pending.push([r,e,t,n]),this.$$state.status>0&&u(this.$$state),r.promise},catch:function(e){return this.then(null,e)},finally:function(e,t){return this.then(function(t){return v(t,!0,e)},function(t){return v(t,!1,e)},t)}}),d(c.prototype,{resolve:function(e){this.promise.$$state.status||(e===this.promise?this.$$reject(p("qcycle","Expected promise to be resolved with value other than itself '{0}'",e)):this.$$resolve(e))},$$resolve:function(e){var n,r;r=a(this,this.$$resolve,this.$$reject);try{(w(e)||A(e))&&(n=e&&e.then),A(n)?(this.promise.$$state.status=-1,n.call(e,r[0],r[1],this.notify)):(this.promise.$$state.value=e,this.promise.$$state.status=1,u(this.promise.$$state))}catch(e){r[1](e),t(e)}},reject:function(e){this.promise.$$state.status||this.$$reject(e)},$$reject:function(e){this.promise.$$state.value=e,this.promise.$$state.status=2,u(this.promise.$$state)},notify:function(n){var r=this.promise.$$state.pending;this.promise.$$state.status<=0&&r&&r.length&&e(function(){for(var e,a,i=0,o=r.length;i<o;i++){a=r[i][0],e=r[i][3];try{a.notify(A(e)?e(n):n)}catch(e){t(e)}}})}});var g=function(e){var t=new c;return t.reject(e),t.promise},m=function(e,t){var n=new c;return t?n.resolve(e):n.reject(e),n.promise},v=function(e,t,n){var r=null;try{A(n)&&(r=n())}catch(e){return m(e,!1)}return O(r)?r.then(function(){return m(e,t)},function(e){return m(e,!1)}):m(e,t)},y=function(e,t,n,r){var a=new c;return a.resolve(e),a.promise.then(t,n,r)},x=y,$=function e(t){function n(e){a.resolve(e)}function r(e){a.reject(e)}if(!A(t))throw p("norslvr","Expected resolverFn, got '{0}'",t);if(!(this instanceof e))return new e(t);var a=new c;return t(n,r),a.promise};return $.defer=h,$.reject=g,$.when=y,$.resolve=x,$.all=f,$}function dn(){this.$get=["$window","$timeout",function(e,t){function n(){for(var e=0;e<c.length;e++){var t=c[e];t&&(c[e]=null,t())}u=c.length=0}function r(e){var t=c.length;return u++,c.push(e),0===t&&(l=s(n)),function(){t>=0&&(c[t]=null,t=null,0==--u&&l&&(l(),l=null,c.length=0))}}var a=e.requestAnimationFrame||e.webkitRequestAnimationFrame,i=e.cancelAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame,o=!!a,s=o?function(e){var t=a(e);return function(){i(t)}}:function(e){var n=t(e,16.66,!1);return function(){t.cancel(n)}};r.supported=o;var l,u=0,c=[];return r}]}function fn(){function e(e){function t(){this.$$watchers=this.$$nextSibling=this.$$childHead=this.$$childTail=null,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$id=l(),this.$$ChildScope=null}return t.prototype=e,t}var t=10,n=r("$rootScope"),o=null,s=null;this.digestTtl=function(e){return arguments.length&&(t=e),t},this.$get=["$injector","$exceptionHandler","$parse","$browser",function(r,u,c,d){function f(e){e.currentScope.$$destroyed=!0}function p(){this.$id=l(),this.$$phase=this.$parent=this.$$watchers=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=null,this.$root=this,this.$$destroyed=!1,this.$$listeners={},this.$$listenerCount={},this.$$watchersCount=0,this.$$isolateBindings=null}function h(e){if(_.$$phase)throw n("inprog","{0} already in progress",_.$$phase);_.$$phase=e}function m(){_.$$phase=null}function v(e,t){do{e.$$watchersCount+=t}while(e=e.$parent)}function y(e,t,n){do{e.$$listenerCount[n]-=t,0===e.$$listenerCount[n]&&delete e.$$listenerCount[n]}while(e=e.$parent)}function x(){}function $(){for(;S.length;)try{S.shift()()}catch(e){u(e)}s=null}function C(){null===s&&(s=d.defer(function(){_.$apply($)}))}p.prototype={constructor:p,$new:function(t,n){var r;return n=n||this,t?(r=new p).$root=this.$root:(this.$$ChildScope||(this.$$ChildScope=e(this)),r=new this.$$ChildScope),r.$parent=n,r.$$prevSibling=n.$$childTail,n.$$childHead?(n.$$childTail.$$nextSibling=r,n.$$childTail=r):n.$$childHead=n.$$childTail=r,(t||n!=this)&&r.$on("$destroy",f),r},$watch:function(e,t,n,r){var a=c(e);if(a.$$watchDelegate)return a.$$watchDelegate(this,t,n,a,e);var i=this,s=i.$$watchers,l={fn:t,last:x,get:a,exp:r||e,eq:!!n};return o=null,A(t)||(l.fn=g),s||(s=i.$$watchers=[]),s.unshift(l),v(this,1),function(){q(s,l)>=0&&v(i,-1),o=null}},$watchGroup:function(e,t){function n(){l=!1,u?(u=!1,t(a,a,s)):t(a,r,s)}var r=new Array(e.length),a=new Array(e.length),o=[],s=this,l=!1,u=!0;if(!e.length){var c=!0;return s.$evalAsync(function(){c&&t(a,a,s)}),function(){c=!1}}return 1===e.length?this.$watch(e[0],function(e,n,i){a[0]=e,r[0]=n,t(a,e===n?a:r,i)}):(i(e,function(e,t){var i=s.$watch(e,function(e,i){a[t]=e,r[t]=i,l||(l=!0,s.$evalAsync(n))});o.push(i)}),function(){for(;o.length;)o.shift()()})},$watchCollection:function(e,t){function n(e){var t,n,r,s;if(!b(i=e)){if(w(i))if(a(i)){o!==p&&(m=(o=p).length=0,d++),t=i.length,m!==t&&(d++,o.length=m=t);for(var l=0;l<t;l++)s=o[l],r=i[l],s!==s&&r!==r||s===r||(d++,o[l]=r)}else{o!==h&&(o=h={},m=0,d++),t=0;for(n in i)i.hasOwnProperty(n)&&(t++,r=i[n],s=o[n],n in o?s!==s&&r!==r||s===r||(d++,o[n]=r):(m++,o[n]=r,d++));if(m>t){d++;for(n in o)i.hasOwnProperty(n)||(m--,delete o[n])}}else o!==i&&(o=i,d++);return d}}function r(){if(g?(g=!1,t(i,i,l)):t(i,s,l),u)if(w(i))if(a(i)){s=new Array(i.length);for(var e=0;e<i.length;e++)s[e]=i[e]}else{s={};for(var n in i)vr.call(i,n)&&(s[n]=i[n])}else s=i}n.$stateful=!0;var i,o,s,l=this,u=t.length>1,d=0,f=c(e,n),p=[],h={},g=!0,m=0;return this.$watch(f,r)},$digest:function(){var e,r,a,i,l,c,f,p,g,v,y=t,b=this,w=[];h("$digest"),d.$$checkUrlChange(),this===_&&null!==s&&(d.defer.cancel(s),$()),o=null;do{for(c=!1,p=b;E.length;){try{(v=E.shift()).scope.$eval(v.expression,v.locals)}catch(e){u(e)}o=null}e:do{if(i=p.$$watchers)for(l=i.length;l--;)try{if(e=i[l])if((r=e.get(p))===(a=e.last)||(e.eq?U(r,a):"number"==typeof r&&"number"==typeof a&&isNaN(r)&&isNaN(a))){if(e===o){c=!1;break e}}else c=!0,o=e,e.last=e.eq?R(r,null):r,e.fn(r,a===x?r:a,p),y<5&&(w[g=4-y]||(w[g]=[]),w[g].push({msg:A(e.exp)?"fn: "+(e.exp.name||e.exp.toString()):e.exp,newVal:r,oldVal:a}))}catch(e){u(e)}if(!(f=p.$$watchersCount&&p.$$childHead||p!==b&&p.$$nextSibling))for(;p!==b&&!(f=p.$$nextSibling);)p=p.$parent}while(p=f);if((c||E.length)&&!y--)throw m(),n("infdig","{0} $digest() iterations reached. Aborting!\nWatchers fired in the last 5 iterations: {1}",t,w)}while(c||E.length);for(m();k.length;)try{k.shift()()}catch(e){u(e)}},$destroy:function(){if(!this.$$destroyed){var e=this.$parent;this.$broadcast("$destroy"),this.$$destroyed=!0,this===_&&d.$$applicationDestroyed(),v(this,-this.$$watchersCount);for(var t in this.$$listenerCount)y(this,this.$$listenerCount[t],t);e&&e.$$childHead==this&&(e.$$childHead=this.$$nextSibling),e&&e.$$childTail==this&&(e.$$childTail=this.$$prevSibling),this.$$prevSibling&&(this.$$prevSibling.$$nextSibling=this.$$nextSibling),this.$$nextSibling&&(this.$$nextSibling.$$prevSibling=this.$$prevSibling),this.$destroy=this.$digest=this.$apply=this.$evalAsync=this.$applyAsync=g,this.$on=this.$watch=this.$watchGroup=function(){return g},this.$$listeners={},this.$parent=this.$$nextSibling=this.$$prevSibling=this.$$childHead=this.$$childTail=this.$root=this.$$watchers=null}},$eval:function(e,t){return c(e)(this,t)},$evalAsync:function(e,t){_.$$phase||E.length||d.defer(function(){E.length&&_.$digest()}),E.push({scope:this,expression:e,locals:t})},$$postDigest:function(e){k.push(e)},$apply:function(e){try{h("$apply");try{return this.$eval(e)}finally{m()}}catch(e){u(e)}finally{try{_.$digest()}catch(e){throw u(e),e}}},$applyAsync:function(e){function t(){n.$eval(e)}var n=this;e&&S.push(t),C()},$on:function(e,t){var n=this.$$listeners[e];n||(this.$$listeners[e]=n=[]),n.push(t);var r=this;do{r.$$listenerCount[e]||(r.$$listenerCount[e]=0),r.$$listenerCount[e]++}while(r=r.$parent);var a=this;return function(){var r=n.indexOf(t);-1!==r&&(n[r]=null,y(a,1,e))}},$emit:function(e,t){var n,r,a,i=[],o=this,s=!1,l={name:e,targetScope:o,stopPropagation:function(){s=!0},preventDefault:function(){l.defaultPrevented=!0},defaultPrevented:!1},c=z([l],arguments,1);do{for(n=o.$$listeners[e]||i,l.currentScope=o,r=0,a=n.length;r<a;r++)if(n[r])try{n[r].apply(null,c)}catch(e){u(e)}else n.splice(r,1),r--,a--;if(s)return l.currentScope=null,l;o=o.$parent}while(o);return l.currentScope=null,l},$broadcast:function(e,t){var n=this,r=n,a=n,i={name:e,targetScope:n,preventDefault:function(){i.defaultPrevented=!0},defaultPrevented:!1};if(!n.$$listenerCount[e])return i;for(var o,s,l,c=z([i],arguments,1);r=a;){for(i.currentScope=r,s=0,l=(o=r.$$listeners[e]||[]).length;s<l;s++)if(o[s])try{o[s].apply(null,c)}catch(e){u(e)}else o.splice(s,1),s--,l--;if(!(a=r.$$listenerCount[e]&&r.$$childHead||r!==n&&r.$$nextSibling))for(;r!==n&&!(a=r.$$nextSibling);)r=r.$parent}return i.currentScope=null,i}};var _=new p,E=_.$$asyncQueue=[],k=_.$$postDigestQueue=[],S=_.$$applyAsyncQueue=[];return _}]}function pn(){var e=/^\s*(https?|ftp|mailto|tel|file):/,t=/^\s*((https?|ftp|file|blob):|data:image\/)/;this.aHrefSanitizationWhitelist=function(t){return x(t)?(e=t,this):e},this.imgSrcSanitizationWhitelist=function(e){return x(e)?(t=e,this):t},this.$get=function(){return function(n,r){var a,i=r?t:e;return a=$n(n).href,""===a||a.match(i)?n:"unsafe:"+a}}}function hn(e){if("self"===e)return e;if(C(e)){if(e.indexOf("***")>-1)throw Xa("iwcard","Illegal sequence *** in string matcher.  String: {0}",e);return e=Pr(e).replace("\\*\\*",".*").replace("\\*","[^:/.?&;]*"),new RegExp("^"+e+"$")}if(k(e))return new RegExp("^"+e.source+"$");throw Xa("imatcher",'Matchers may only be "self", string patterns or RegExp objects')}function gn(e){var t=[];return x(e)&&i(e,function(e){t.push(hn(e))}),t}function mn(){this.SCE_CONTEXTS=Qa;var e=["self"],t=[];this.resourceUrlWhitelist=function(t){return arguments.length&&(e=gn(t)),e},this.resourceUrlBlacklist=function(e){return arguments.length&&(t=gn(e)),t},this.$get=["$injector",function(r){function a(e,t){return"self"===e?Cn(t):!!e.exec(t.href)}function i(n){var r,i,o=$n(n.toString()),s=!1;for(r=0,i=e.length;r<i;r++)if(a(e[r],o)){s=!0;break}if(s)for(r=0,i=t.length;r<i;r++)if(a(t[r],o)){s=!1;break}return s}function o(e){var t=function(e){this.$$unwrapTrustedValue=function(){return e}};return e&&(t.prototype=new e),t.prototype.valueOf=function(){return this.$$unwrapTrustedValue()},t.prototype.toString=function(){return this.$$unwrapTrustedValue().toString()},t}function s(e,t){var r=f.hasOwnProperty(e)?f[e]:null;if(!r)throw Xa("icontext","Attempted to trust a value in invalid context. Context: {0}; Value: {1}",e,t);if(null===t||t===n||""===t)return t;if("string"!=typeof t)throw Xa("itype","Attempted to trust a non-string value in a content requiring a string: Context: {0}",e);return new r(t)}function l(e){return e instanceof d?e.$$unwrapTrustedValue():e}function u(e,t){if(null===t||t===n||""===t)return t;var r=f.hasOwnProperty(e)?f[e]:null;if(r&&t instanceof r)return t.$$unwrapTrustedValue();if(e===Qa.RESOURCE_URL){if(i(t))return t;throw Xa("insecurl","Blocked loading resource from url not allowed by $sceDelegate policy.  URL: {0}",t.toString())}if(e===Qa.HTML)return c(t);throw Xa("unsafe","Attempting to use an unsafe value in a safe context.")}var c=function(e){throw Xa("unsafe","Attempting to use an unsafe value in a safe context.")};r.has("$sanitize")&&(c=r.get("$sanitize"));var d=o(),f={};return f[Qa.HTML]=o(d),f[Qa.CSS]=o(d),f[Qa.URL]=o(d),f[Qa.JS]=o(d),f[Qa.RESOURCE_URL]=o(f[Qa.URL]),{trustAs:s,getTrusted:u,valueOf:l}}]}function vn(){var e=!0;this.enabled=function(t){return arguments.length&&(e=!!t),e},this.$get=["$parse","$sceDelegate",function(t,n){if(e&&wr<8)throw Xa("iequirks","Strict Contextual Escaping does not support Internet Explorer version < 11 in quirks mode.  You can fix this by adding the text <!doctype html> to the top of your HTML document.  See http://docs.angularjs.org/api/ng.$sce for more information.");var r=I(Qa);r.isEnabled=function(){return e},r.trustAs=n.trustAs,r.getTrusted=n.getTrusted,r.valueOf=n.valueOf,e||(r.trustAs=r.getTrusted=function(e,t){return t},r.valueOf=m),r.parseAs=function(e,n){var a=t(n);return a.literal&&a.constant?a:t(n,function(t){return r.getTrusted(e,t)})};var a=r.parseAs,o=r.getTrusted,s=r.trustAs;return i(Qa,function(e,t){var n=mr(t);r[xe("parse_as_"+n)]=function(t){return a(e,t)},r[xe("get_trusted_"+n)]=function(t){return o(e,t)},r[xe("trust_as_"+n)]=function(t){return s(e,t)}}),r}]}function yn(){this.$get=["$window","$document",function(e,t){var n,r,a={},i=p((/android (\d+)/.exec(mr((e.navigator||{}).userAgent))||[])[1]),o=/Boxee/i.test((e.navigator||{}).userAgent),s=t[0]||{},l=/^(Moz|webkit|ms)(?=[A-Z])/,u=s.body&&s.body.style,c=!1,d=!1;if(u){for(var f in u)if(r=l.exec(f)){n=(n=r[0]).substr(0,1).toUpperCase()+n.substr(1);break}n||(n="WebkitOpacity"in u&&"webkit"),c=!!("transition"in u||n+"Transition"in u),d=!!("animation"in u||n+"Animation"in u),!i||c&&d||(c=C(u.webkitTransition),d=C(u.webkitAnimation))}return{history:!(!e.history||!e.history.pushState||i<4||o),hasEvent:function(e){if("input"===e&&wr<=11)return!1;if(b(a[e])){var t=s.createElement("div");a[e]="on"+e in t}return a[e]},csp:Br(),vendorPrefix:n,transitions:c,animations:d,android:i}}]}function bn(){this.$get=["$templateCache","$http","$q","$sce",function(e,t,n,r){function a(i,o){function s(e){if(!o)throw _a("tpload","Failed to load template: {0} (HTTP status: {1} {2})",i,e.status,e.statusText);return n.reject(e)}a.totalPendingRequests++,C(i)&&e.get(i)||(i=r.getTrustedResourceUrl(i));var l=t.defaults&&t.defaults.transformResponse;Or(l)?l=l.filter(function(e){return e!==vt}):l===vt&&(l=null);var u={cache:e,transformResponse:l};return t.get(i,u).finally(function(){a.totalPendingRequests--}).then(function(t){return e.put(i,t.data),t.data},s)}return a.totalPendingRequests=0,a}]}function xn(){this.$get=["$rootScope","$browser","$location",function(e,t,n){var r={};return r.findBindings=function(e,t,n){var r=[];return i(e.getElementsByClassName("ng-binding"),function(e){var a=Fr.element(e).data("$binding");a&&i(a,function(a){n?new RegExp("(^|\\s)"+Pr(t)+"(\\s|\\||$)").test(a)&&r.push(e):-1!=a.indexOf(t)&&r.push(e)})}),r},r.findModels=function(e,t,n){for(var r=["ng-","data-ng-","ng\\:"],a=0;a<r.length;++a){var i=n?"=":"*=",o="["+r[a]+"model"+i+'"'+t+'"]',s=e.querySelectorAll(o);if(s.length)return s}},r.getLocation=function(){return n.url()},r.setLocation=function(t){t!==n.url()&&(n.url(t),e.$digest())},r.whenStable=function(e){t.notifyWhenNoOutstandingRequests(e)},r}]}function wn(){this.$get=["$rootScope","$browser","$q","$$q","$exceptionHandler",function(e,t,n,r,a){function i(i,s,l){A(i)||(l=s,s=i,i=g);var u,c=V(arguments,3),d=x(l)&&!l,f=(d?r:n).defer(),p=f.promise;return u=t.defer(function(){try{f.resolve(i.apply(null,c))}catch(e){f.reject(e),a(e)}finally{delete o[p.$$timeoutId]}d||e.$apply()},s),p.$$timeoutId=u,o[u]=f,p}var o={};return i.cancel=function(e){return!!(e&&e.$$timeoutId in o)&&(o[e.$$timeoutId].reject("canceled"),delete o[e.$$timeoutId],t.defer.cancel(e.$$timeoutId))},i}]}function $n(e){var t=e;return wr&&(Ka.setAttribute("href",t),t=Ka.href),Ka.setAttribute("href",t),{href:Ka.href,protocol:Ka.protocol?Ka.protocol.replace(/:$/,""):"",host:Ka.host,search:Ka.search?Ka.search.replace(/^\?/,""):"",hash:Ka.hash?Ka.hash.replace(/^#/,""):"",hostname:Ka.hostname,port:Ka.port,pathname:"/"===Ka.pathname.charAt(0)?Ka.pathname:"/"+Ka.pathname}}function Cn(e){var t=C(e)?$n(e):e;return t.protocol===ei.protocol&&t.host===ei.host}function _n(){this.$get=v(e)}function En(e){function t(e){try{return decodeURIComponent(e)}catch(t){return e}}var r=e[0]||{},a={},i="";return function(){var e,o,s,l,u,c=r.cookie||"";if(c!==i)for(e=(i=c).split("; "),a={},s=0;s<e.length;s++)(l=(o=e[s]).indexOf("="))>0&&(u=t(o.substring(0,l)),a[u]===n&&(a[u]=t(o.substring(l+1))));return a}}function An(){this.$get=En}function kn(e){function t(r,a){if(w(r)){var o={};return i(r,function(e,n){o[n]=t(n,e)}),o}return e.factory(r+n,a)}var n="Filter";this.register=t,this.$get=["$injector",function(e){return function(t){return e.get(t+n)}}],t("currency",Mn),t("date",Hn),t("filter",Sn),t("json",Yn),t("limitTo",Gn),t("lowercase",ii),t("number",Ln),t("orderBy",Wn),t("uppercase",oi)}function Sn(){return function(e,t,n){if(!a(e)){if(null==e)return e;throw r("filter")("notarray","Expected array but received: {0}",e)}var i,o;switch(Fn(t)){case"function":i=t;break;case"boolean":case"null":case"number":case"string":o=!0;case"object":i=Dn(t,n,o);break;default:return e}return Array.prototype.filter.call(e,i)}}function Dn(e,t,n){var r=w(e)&&"$"in e;return!0===t?t=U:A(t)||(t=function(e,t){return!b(e)&&(null===e||null===t?e===t:!(w(t)||w(e)&&!y(e))&&(e=mr(""+e),t=mr(""+t),-1!==e.indexOf(t)))}),function(a){return r&&!w(a)?Tn(a,e.$,t,!1):Tn(a,e,t,n)}}function Tn(e,t,n,r,a){var i=Fn(e),o=Fn(t);if("string"===o&&"!"===t.charAt(0))return!Tn(e,t.substring(1),n,r);if(Or(e))return e.some(function(e){return Tn(e,t,n,r)});switch(i){case"object":var s;if(r){for(s in e)if("$"!==s.charAt(0)&&Tn(e[s],t,n,!0))return!0;return!a&&Tn(e,t,n,!1)}if("object"===o){for(s in t){var l=t[s];if(!A(l)&&!b(l)){var u="$"===s;if(!Tn(u?e:e[s],l,n,u,u))return!1}}return!0}return n(e,t);case"function":return!1;default:return n(e,t)}}function Fn(e){return null===e?"null":typeof e}function Mn(e){var t=e.NUMBER_FORMATS;return function(e,n,r){return b(n)&&(n=t.CURRENCY_SYM),b(r)&&(r=t.PATTERNS[1].maxFrac),null==e?e:On(e,t.PATTERNS[1],t.GROUP_SEP,t.DECIMAL_SEP,r).replace(/\u00A4/g,n)}}function Ln(e){var t=e.NUMBER_FORMATS;return function(e,n){return null==e?e:On(e,t.PATTERNS[0],t.GROUP_SEP,t.DECIMAL_SEP,n)}}function On(e,t,n,r,a){if(w(e))return"";var i=e<0,o=(e=Math.abs(e))===1/0;if(!o&&!isFinite(e))return"";var s=e+"",l="",u=!1,c=[];if(o&&(l=""),!o&&-1!==s.indexOf("e")){var d=s.match(/([\d\.]+)e(-?)(\d+)/);d&&"-"==d[2]&&d[3]>a+1?e=0:(l=s,u=!0)}if(o||u)a>0&&e<1&&(l=e.toFixed(a),e=parseFloat(l));else{var f=(s.split(ti)[1]||"").length;b(a)&&(a=Math.min(Math.max(t.minFrac,f),t.maxFrac));var p=(""+(e=+(Math.round(+(e.toString()+"e"+a)).toString()+"e"+-a))).split(ti),h=p[0];p=p[1]||"";var g,m=0,v=t.lgSize,y=t.gSize;if(h.length>=v+y)for(m=h.length-v,g=0;g<m;g++)(m-g)%y==0&&0!==g&&(l+=n),l+=h.charAt(g);for(g=m;g<h.length;g++)(h.length-g)%v==0&&0!==g&&(l+=n),l+=h.charAt(g);for(;p.length<a;)p+="0";a&&"0"!==a&&(l+=r+p.substr(0,a))}return 0===e&&(i=!1),c.push(i?t.negPre:t.posPre,l,i?t.negSuf:t.posSuf),c.join("")}function Nn(e,t,n){var r="";for(e<0&&(r="-",e=-e),e=""+e;e.length<t;)e="0"+e;return n&&(e=e.substr(e.length-t)),r+e}function jn(e,t,n,r){return n=n||0,function(a){var i=a["get"+e]();return(n>0||i>-n)&&(i+=n),0===i&&-12==n&&(i=12),Nn(i,t,r)}}function Pn(e,t){return function(n,r){var a=n["get"+e]();return r[yr(t?"SHORT"+e:e)][a]}}function Bn(e,t,n){var r=-1*n,a=r>=0?"+":"";return a+=Nn(Math[r>0?"floor":"ceil"](r/60),2)+Nn(Math.abs(r%60),2)}function qn(e){var t=new Date(e,0,1).getDay();return new Date(e,0,(t<=4?5:12)-t)}function Rn(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function In(e){return function(t){var n=qn(t.getFullYear()),r=+Rn(t)-+n;return Nn(1+Math.round(r/6048e5),e)}}function Un(e,t){return e.getHours()<12?t.AMPMS[0]:t.AMPMS[1]}function zn(e,t){return e.getFullYear()<=0?t.ERAS[0]:t.ERAS[1]}function Vn(e,t){return e.getFullYear()<=0?t.ERANAMES[0]:t.ERANAMES[1]}function Hn(e){function t(e){var t;if(t=e.match(n)){var r=new Date(0),a=0,i=0,o=t[8]?r.setUTCFullYear:r.setFullYear,s=t[8]?r.setUTCHours:r.setHours;t[9]&&(a=p(t[9]+t[10]),i=p(t[9]+t[11])),o.call(r,p(t[1]),p(t[2])-1,p(t[3]));var l=p(t[4]||0)-a,u=p(t[5]||0)-i,c=p(t[6]||0),d=Math.round(1e3*parseFloat("0."+(t[7]||0)));return s.call(r,l,u,c,d),r}return e}var n=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/;return function(n,r,a){var o,s,l="",u=[];if(r=r||"mediumDate",r=e.DATETIME_FORMATS[r]||r,C(n)&&(n=ai.test(n)?p(n):t(n)),_(n)&&(n=new Date(n)),!E(n)||!isFinite(n.getTime()))return n;for(;r;)(s=ri.exec(r))?r=(u=z(u,s,1)).pop():(u.push(r),r=null);var c=n.getTimezoneOffset();return a&&(c=Z(a,n.getTimezoneOffset()),n=X(n,a,!0)),i(u,function(t){o=ni[t],l+=o?o(n,e.DATETIME_FORMATS,c):t.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),l}}function Yn(){return function(e,t){return b(t)&&(t=2),G(e,t)}}function Gn(){return function(e,t,n){return t=Math.abs(Number(t))===1/0?Number(t):p(t),isNaN(t)?e:(_(e)&&(e=e.toString()),Or(e)||C(e)?(n=!n||isNaN(n)?0:p(n),n=n<0&&n>=-e.length?e.length+n:n,t>=0?e.slice(n,n+t):0===n?e.slice(t,e.length):e.slice(Math.max(0,n+t),n)):e)}}function Wn(e){function t(t,n){return n=n?-1:1,t.map(function(t){var r=1,a=m;if(A(t))a=t;else if(C(t)&&("+"!=t.charAt(0)&&"-"!=t.charAt(0)||(r="-"==t.charAt(0)?-1:1,t=t.substring(1)),""!==t&&(a=e(t)).constant)){var i=a();a=function(e){return e[i]}}return{get:a,descending:r*n}})}function n(e){switch(typeof e){case"number":case"boolean":case"string":return!0;default:return!1}}function r(e,t){return"function"==typeof e.valueOf&&(e=e.valueOf(),n(e))?e:y(e)&&(e=e.toString(),n(e))?e:t}function i(e,t){var n=typeof e;return null===e?(n="string",e="null"):"string"===n?e=e.toLowerCase():"object"===n&&(e=r(e,t)),{value:e,type:n}}function o(e,t){var n=0;return e.type===t.type?e.value!==t.value&&(n=e.value<t.value?-1:1):n=e.type<t.type?-1:1,n}return function(e,n,r){function s(e,t){return{value:e,predicateValues:u.map(function(n){return i(n.get(e),t)})}}function l(e,t){for(var n=0,r=0,a=u.length;r<a&&!(n=o(e.predicateValues[r],t.predicateValues[r])*u[r].descending);++r);return n}if(!a(e))return e;Or(n)||(n=[n]),0===n.length&&(n=["+"]);var u=t(n,r);u.push({get:function(){return{}},descending:r?-1:1});var c=Array.prototype.map.call(e,s);return c.sort(l),e=c.map(function(e){return e.value})}}function Zn(e){return A(e)&&(e={link:e}),e.restrict=e.restrict||"AC",v(e)}function Jn(e,t){e.$name=t}function Xn(e,t,r,a,o){var s=this,l=[],u=s.$$parentForm=e.parent().controller("form")||ui;s.$error={},s.$$success={},s.$pending=n,s.$name=o(t.name||t.ngForm||"")(r),s.$dirty=!1,s.$pristine=!0,s.$valid=!0,s.$invalid=!1,s.$submitted=!1,u.$addControl(s),s.$rollbackViewValue=function(){i(l,function(e){e.$rollbackViewValue()})},s.$commitViewValue=function(){i(l,function(e){e.$commitViewValue()})},s.$addControl=function(e){fe(e.$name,"input"),l.push(e),e.$name&&(s[e.$name]=e)},s.$$renameControl=function(e,t){var n=e.$name;s[n]===e&&delete s[n],s[t]=e,e.$name=t},s.$removeControl=function(e){e.$name&&s[e.$name]===e&&delete s[e.$name],i(s.$pending,function(t,n){s.$setValidity(n,null,e)}),i(s.$error,function(t,n){s.$setValidity(n,null,e)}),i(s.$$success,function(t,n){s.$setValidity(n,null,e)}),q(l,e)},fr({ctrl:this,$element:e,set:function(e,t,n){var r=e[t];r?-1===r.indexOf(n)&&r.push(n):e[t]=[n]},unset:function(e,t,n){var r=e[t];r&&(q(r,n),0===r.length&&delete e[t])},parentForm:u,$animate:a}),s.$setDirty=function(){a.removeClass(e,Hi),a.addClass(e,Yi),s.$dirty=!0,s.$pristine=!1,u.$setDirty()},s.$setPristine=function(){a.setClass(e,Hi,Yi+" "+ci),s.$dirty=!1,s.$pristine=!0,s.$submitted=!1,i(l,function(e){e.$setPristine()})},s.$setUntouched=function(){i(l,function(e){e.$setUntouched()})},s.$setSubmitted=function(){a.addClass(e,ci),s.$submitted=!0,u.$setSubmitted()}}function Qn(e){e.$formatters.push(function(t){return e.$isEmpty(t)?t:t.toString()})}function Kn(e,t,n,r,a,i){er(e,t,n,r,a,i),Qn(r)}function er(e,t,n,r,a,i){var o=mr(t[0].type);if(!a.android){var s=!1;t.on("compositionstart",function(e){s=!0}),t.on("compositionend",function(){s=!1,l()})}var l=function(e){if(u&&(i.defer.cancel(u),u=null),!s){var a=t.val(),l=e&&e.type;"password"===o||n.ngTrim&&"false"===n.ngTrim||(a=jr(a)),(r.$viewValue!==a||""===a&&r.$$hasNativeValidators)&&r.$setViewValue(a,l)}};if(a.hasEvent("input"))t.on("input",l);else{var u,c=function(e,t,n){u||(u=i.defer(function(){u=null,t&&t.value===n||l(e)}))};t.on("keydown",function(e){var t=e.keyCode;91===t||15<t&&t<19||37<=t&&t<=40||c(e,this,this.value)}),a.hasEvent("paste")&&t.on("paste cut",c)}t.on("change",l),r.$render=function(){var e=r.$isEmpty(r.$viewValue)?"":r.$viewValue;t.val()!==e&&t.val(e)}}function tr(e,t){if(E(e))return e;if(C(e)){xi.lastIndex=0;var n=xi.exec(e);if(n){var r=+n[1],a=+n[2],i=0,o=0,s=0,l=0,u=qn(r),c=7*(a-1);return t&&(i=t.getHours(),o=t.getMinutes(),s=t.getSeconds(),l=t.getMilliseconds()),new Date(r,0,u.getDate()+c,i,o,s,l)}}return NaN}function nr(e,t){return function(n,r){var a,o;if(E(n))return n;if(C(n)){if('"'==n.charAt(0)&&'"'==n.charAt(n.length-1)&&(n=n.substring(1,n.length-1)),hi.test(n))return new Date(n);if(e.lastIndex=0,a=e.exec(n))return a.shift(),o=r?{yyyy:r.getFullYear(),MM:r.getMonth()+1,dd:r.getDate(),HH:r.getHours(),mm:r.getMinutes(),ss:r.getSeconds(),sss:r.getMilliseconds()/1e3}:{yyyy:1970,MM:1,dd:1,HH:0,mm:0,ss:0,sss:0},i(a,function(e,n){n<t.length&&(o[t[n]]=+e)}),new Date(o.yyyy,o.MM-1,o.dd,o.HH,o.mm,o.ss||0,1e3*o.sss||0)}return NaN}}function rr(e,t,r,a){return function(i,o,s,l,u,c,d){function f(e){return e&&!(e.getTime&&e.getTime()!==e.getTime())}function p(e){return x(e)?E(e)?e:r(e):n}ar(i,o,s,l),er(i,o,s,l,u,c);var h,g=l&&l.$options&&l.$options.timezone;if(l.$$parserName=e,l.$parsers.push(function(e){if(l.$isEmpty(e))return null;if(t.test(e)){var a=r(e,h);return g&&(a=X(a,g)),a}return n}),l.$formatters.push(function(e){if(e&&!E(e))throw Wi("datefmt","Expected `{0}` to be a date",e);return f(e)?((h=e)&&g&&(h=X(h,g,!0)),d("date")(e,a,g)):(h=null,"")}),x(s.min)||s.ngMin){var m;l.$validators.min=function(e){return!f(e)||b(m)||r(e)>=m},s.$observe("min",function(e){m=p(e),l.$validate()})}if(x(s.max)||s.ngMax){var v;l.$validators.max=function(e){return!f(e)||b(v)||r(e)<=v},s.$observe("max",function(e){v=p(e),l.$validate()})}}}function ar(e,t,r,a){var i=t[0];(a.$$hasNativeValidators=w(i.validity))&&a.$parsers.push(function(e){var r=t.prop(gr)||{};return r.badInput&&!r.typeMismatch?n:e})}function ir(e,t,r,a,i,o){if(ar(e,t,r,a),er(e,t,r,a,i,o),a.$$parserName="number",a.$parsers.push(function(e){return a.$isEmpty(e)?null:vi.test(e)?parseFloat(e):n}),a.$formatters.push(function(e){if(!a.$isEmpty(e)){if(!_(e))throw Wi("numfmt","Expected `{0}` to be a number",e);e=e.toString()}return e}),x(r.min)||r.ngMin){var s;a.$validators.min=function(e){return a.$isEmpty(e)||b(s)||e>=s},r.$observe("min",function(e){x(e)&&!_(e)&&(e=parseFloat(e,10)),s=_(e)&&!isNaN(e)?e:n,a.$validate()})}if(x(r.max)||r.ngMax){var l;a.$validators.max=function(e){return a.$isEmpty(e)||b(l)||e<=l},r.$observe("max",function(e){x(e)&&!_(e)&&(e=parseFloat(e,10)),l=_(e)&&!isNaN(e)?e:n,a.$validate()})}}function or(e,t,n,r,a,i){er(e,t,n,r,a,i),Qn(r),r.$$parserName="url",r.$validators.url=function(e,t){var n=e||t;return r.$isEmpty(n)||gi.test(n)}}function sr(e,t,n,r,a,i){er(e,t,n,r,a,i),Qn(r),r.$$parserName="email",r.$validators.email=function(e,t){var n=e||t;return r.$isEmpty(n)||mi.test(n)}}function lr(e,t,n,r){b(n.name)&&t.attr("name",l());var a=function(e){t[0].checked&&r.$setViewValue(n.value,e&&e.type)};t.on("click",a),r.$render=function(){var e=n.value;t[0].checked=e==r.$viewValue},n.$observe("value",r.$render)}function ur(e,t,n,r,a){var i;if(x(r)){if(!(i=e(r)).constant)throw Wi("constexpr","Expected constant expression for `{0}`, but saw `{1}`.",n,r);return i(t)}return a}function cr(e,t,n,r,a,i,o,s){var l=ur(s,e,"ngTrueValue",n.ngTrueValue,!0),u=ur(s,e,"ngFalseValue",n.ngFalseValue,!1),c=function(e){r.$setViewValue(t[0].checked,e&&e.type)};t.on("click",c),r.$render=function(){t[0].checked=r.$viewValue},r.$isEmpty=function(e){return!1===e},r.$formatters.push(function(e){return U(e,l)}),r.$parsers.push(function(e){return e?l:u})}function dr(e,t){return e="ngClass"+e,["$animate",function(n){function r(e,t){var n=[];e:for(var r=0;r<e.length;r++){for(var a=e[r],i=0;i<t.length;i++)if(a==t[i])continue e;n.push(a)}return n}function a(e){var t=[];return Or(e)?(i(e,function(e){t=t.concat(a(e))}),t):C(e)?e.split(" "):w(e)?(i(e,function(e,n){e&&(t=t.concat(n.split(" ")))}),t):e}return{restrict:"AC",link:function(o,s,l){function u(e){var t=d(e,1);l.$addClass(t)}function c(e){var t=d(e,-1);l.$removeClass(t)}function d(e,t){var n=s.data("$classCounts")||ge(),r=[];return i(e,function(e){(t>0||n[e])&&(n[e]=(n[e]||0)+t,n[e]===+(t>0)&&r.push(e))}),s.data("$classCounts",n),r.join(" ")}function f(e,t){var a=r(t,e),i=r(e,t);a=d(a,1),i=d(i,-1),a&&a.length&&n.addClass(s,a),i&&i.length&&n.removeClass(s,i)}function p(e){if(!0===t||o.$index%2===t){var n=a(e||[]);h?U(e,h)||f(a(h),n):u(n)}h=I(e)}var h;o.$watch(l[e],p,!0),l.$observe("class",function(t){p(o.$eval(l[e]))}),"ngClass"!==e&&o.$watch("$index",function(n,r){var i=1&n;if(i!==(1&r)){var s=a(o.$eval(l[e]));i===t?u(s):c(s)}})}}}]}function fr(e){function t(e,t,l){t===n?r("$pending",e,l):a("$pending",e,l),L(t)?t?(d(s.$error,e,l),c(s.$$success,e,l)):(c(s.$error,e,l),d(s.$$success,e,l)):(d(s.$error,e,l),d(s.$$success,e,l)),s.$pending?(i(Gi,!0),s.$valid=s.$invalid=n,o("",null)):(i(Gi,!1),s.$valid=pr(s.$error),s.$invalid=!s.$valid,o("",s.$valid));var u;o(e,u=s.$pending&&s.$pending[e]?n:!s.$error[e]&&(!!s.$$success[e]||null)),f.$setValidity(e,u,s)}function r(e,t,n){s[e]||(s[e]={}),c(s[e],t,n)}function a(e,t,r){s[e]&&d(s[e],t,r),pr(s[e])&&(s[e]=n)}function i(e,t){t&&!u[e]?(p.addClass(l,e),u[e]=!0):!t&&u[e]&&(p.removeClass(l,e),u[e]=!1)}function o(e,t){e=e?"-"+ue(e,"-"):"",i(zi+e,!0===t),i(Vi+e,!1===t)}var s=e.ctrl,l=e.$element,u={},c=e.set,d=e.unset,f=e.parentForm,p=e.$animate;u[Vi]=!(u[zi]=l.hasClass(zi)),s.$setValidity=t}function pr(e){if(e)for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}var hr=/^\/(.+)\/([a-z]*)$/,gr="validity",mr=function(e){return C(e)?e.toLowerCase():e},vr=Object.prototype.hasOwnProperty,yr=function(e){return C(e)?e.toUpperCase():e},br=function(e){return C(e)?e.replace(/[A-Z]/g,function(e){return String.fromCharCode(32|e.charCodeAt(0))}):e},xr=function(e){return C(e)?e.replace(/[a-z]/g,function(e){return String.fromCharCode(-33&e.charCodeAt(0))}):e};"i"!=="I".toLowerCase()&&(mr=br,yr=xr);var wr,$r,Cr,_r,Er=[].slice,Ar=[].splice,kr=[].push,Sr=Object.prototype.toString,Dr=Object.getPrototypeOf,Tr=r("ng"),Fr=e.angular||(e.angular={}),Mr=0;wr=t.documentMode,g.$inject=[],m.$inject=[];var Lr,Or=Array.isArray,Nr=/^\[object (Uint8(Clamped)?)|(Uint16)|(Uint32)|(Int8)|(Int16)|(Int32)|(Float(32)|(64))Array\]$/,jr=function(e){return C(e)?e.trim():e},Pr=function(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},Br=function(){if(!x(Br.rules)){var e=t.querySelector("[ng-csp]")||t.querySelector("[data-ng-csp]");if(e){var n=e.getAttribute("ng-csp")||e.getAttribute("data-ng-csp");Br.rules={noUnsafeEval:!n||-1!==n.indexOf("no-unsafe-eval"),noInlineStyle:!n||-1!==n.indexOf("no-inline-style")}}else Br.rules={noUnsafeEval:function(){try{return new Function(""),!1}catch(e){return!0}}(),noInlineStyle:!1}}return Br.rules},qr=function(){if(x(qr.name_))return qr.name_;var e,n,r,a,i=Rr.length;for(n=0;n<i;++n)if(r=Rr[n],e=t.querySelector("["+r.replace(":","\\:")+"jq]")){a=e.getAttribute(r+"jq");break}return qr.name_=a},Rr=["ng-","data-ng-","ng:","x-ng-"],Ir=/[A-Z]/g,Ur=!1,zr=1,Vr=3,Hr=8,Yr=9,Gr=11,Wr={full:"1.4.4",major:1,minor:4,dot:4,codeName:"pylon-requirement"};Ae.expando="ng339";var Zr=Ae.cache={},Jr=1,Xr=function(e,t,n){e.addEventListener(t,n,!1)},Qr=function(e,t,n){e.removeEventListener(t,n,!1)};Ae._data=function(e){return this.cache[e[this.expando]]||{}};var Kr=/([\:\-\_]+(.))/g,ea=/^moz([A-Z])/,ta={mouseleave:"mouseout",mouseenter:"mouseover"},na=r("jqLite"),ra=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,aa=/<|&#?\w+;/,ia=/<([\w:]+)/,oa=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,sa={option:[1,'<select multiple="multiple">',"</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};sa.optgroup=sa.option,sa.tbody=sa.tfoot=sa.colgroup=sa.caption=sa.thead,sa.th=sa.td;var la=Ae.prototype={ready:function(n){function r(){a||(a=!0,n())}var a=!1;"complete"===t.readyState?setTimeout(r):(this.on("DOMContentLoaded",r),Ae(e).on("load",r))},toString:function(){var e=[];return i(this,function(t){e.push(""+t)}),"["+e.join(", ")+"]"},eq:function(e){return $r(e>=0?this[e]:this[this.length+e])},length:0,push:kr,sort:[].sort,splice:[].splice},ua={};i("multiple,selected,checked,disabled,readOnly,required,open".split(","),function(e){ua[mr(e)]=e});var ca={};i("input,select,option,textarea,button,form,details".split(","),function(e){ca[e]=!0});var da={ngMinlength:"minlength",ngMaxlength:"maxlength",ngMin:"min",ngMax:"max",ngPattern:"pattern"};i({data:Me,removeData:Te,hasData:Ce},function(e,t){Ae[t]=e}),i({data:Me,inheritedData:Be,scope:function(e){return $r.data(e,"$scope")||Be(e.parentNode||e,["$isolateScope","$scope"])},isolateScope:function(e){return $r.data(e,"$isolateScope")||$r.data(e,"$isolateScopeNoTemplate")},controller:Pe,injector:function(e){return Be(e,"$injector")},removeAttr:function(e,t){e.removeAttribute(t)},hasClass:Le,css:function(e,t,n){if(t=xe(t),!x(n))return e.style[t];e.style[t]=n},attr:function(e,t,r){var a=e.nodeType;if(a!==Vr&&2!==a&&a!==Hr){var i=mr(t);if(ua[i]){if(!x(r))return e[t]||(e.attributes.getNamedItem(t)||g).specified?i:n;r?(e[t]=!0,e.setAttribute(t,i)):(e[t]=!1,e.removeAttribute(i))}else if(x(r))e.setAttribute(t,r);else if(e.getAttribute){var o=e.getAttribute(t,2);return null===o?n:o}}},prop:function(e,t,n){if(!x(n))return e[t];e[t]=n},text:function(){function e(e,t){if(b(t)){var n=e.nodeType;return n===zr||n===Vr?e.textContent:""}e.textContent=t}return e.$dv="",e}(),val:function(e,t){if(b(t)){if(e.multiple&&"select"===B(e)){var n=[];return i(e.options,function(e){e.selected&&n.push(e.value||e.text)}),0===n.length?null:n}return e.value}e.value=t},html:function(e,t){if(b(t))return e.innerHTML;Se(e,!0),e.innerHTML=t},empty:qe},function(e,t){Ae.prototype[t]=function(t,r){var a,i,o=this.length;if(e!==qe&&(2==e.length&&e!==Le&&e!==Pe?t:r)===n){if(w(t)){for(a=0;a<o;a++)if(e===Me)e(this[a],t);else for(i in t)e(this[a],i,t[i]);return this}for(var s=e.$dv,l=s===n?Math.min(o,1):o,u=0;u<l;u++){var c=e(this[u],t,r);s=s?s+c:c}return s}for(a=0;a<o;a++)e(this[a],t,r);return this}}),i({removeData:Te,on:function e(t,n,r,a){if(x(a))throw na("onargs","jqLite#on() does not support the `selector` or `eventData` parameters");if($e(t)){var i=Fe(t,!0),o=i.events,s=i.handle;s||(s=i.handle=Ve(t,o));for(var l=n.indexOf(" ")>=0?n.split(" "):[n],u=l.length;u--;){var c=o[n=l[u]];c||(o[n]=[],"mouseenter"===n||"mouseleave"===n?e(t,ta[n],function(e){var t=this,r=e.relatedTarget;r&&(r===t||t.contains(r))||s(e,n)}):"$destroy"!==n&&Xr(t,n,s),c=o[n]),c.push(r)}}},off:De,one:function(e,t,n){(e=$r(e)).on(t,function r(){e.off(t,n),e.off(t,r)}),e.on(t,n)},replaceWith:function(e,t){var n,r=e.parentNode;Se(e),i(new Ae(t),function(t){n?r.insertBefore(t,n.nextSibling):r.replaceChild(t,e),n=t})},children:function(e){var t=[];return i(e.childNodes,function(e){e.nodeType===zr&&t.push(e)}),t},contents:function(e){return e.contentDocument||e.childNodes||[]},append:function(e,t){var n=e.nodeType;if(n===zr||n===Gr)for(var r=0,a=(t=new Ae(t)).length;r<a;r++){var i=t[r];e.appendChild(i)}},prepend:function(e,t){if(e.nodeType===zr){var n=e.firstChild;i(new Ae(t),function(t){e.insertBefore(t,n)})}},wrap:function(e,t){t=$r(t).eq(0).clone()[0];var n=e.parentNode;n&&n.replaceChild(t,e),t.appendChild(e)},remove:Re,detach:function(e){Re(e,!0)},after:function(e,t){for(var n=e,r=e.parentNode,a=0,i=(t=new Ae(t)).length;a<i;a++){var o=t[a];r.insertBefore(o,n.nextSibling),n=o}},addClass:Ne,removeClass:Oe,toggleClass:function(e,t,n){t&&i(t.split(" "),function(t){var r=n;b(r)&&(r=!Le(e,t)),(r?Ne:Oe)(e,t)})},parent:function(e){var t=e.parentNode;return t&&t.nodeType!==Gr?t:null},next:function(e){return e.nextElementSibling},find:function(e,t){return e.getElementsByTagName?e.getElementsByTagName(t):[]},clone:ke,triggerHandler:function(e,t,n){var r,a,o,s=t.type||t,l=Fe(e),u=l&&l.events,c=u&&u[s];c&&(r={preventDefault:function(){this.defaultPrevented=!0},isDefaultPrevented:function(){return!0===this.defaultPrevented},stopImmediatePropagation:function(){this.immediatePropagationStopped=!0},isImmediatePropagationStopped:function(){return!0===this.immediatePropagationStopped},stopPropagation:g,type:s,target:e},t.type&&(r=d(r,t)),a=I(c),o=n?[r].concat(n):[r],i(a,function(t){r.isImmediatePropagationStopped()||t.apply(e,o)}))}},function(e,t){Ae.prototype[t]=function(t,n,r){for(var a,i=0,o=this.length;i<o;i++)b(a)?x(a=e(this[i],t,n,r))&&(a=$r(a)):je(a,e(this[i],t,n,r));return x(a)?a:this},Ae.prototype.bind=Ae.prototype.on,Ae.prototype.unbind=Ae.prototype.off}),Ge.prototype={put:function(e,t){this[Ye(e,this.nextUid)]=t},get:function(e){return this[Ye(e,this.nextUid)]},remove:function(e){var t=this[e=Ye(e,this.nextUid)];return delete this[e],t}};var fa=[function(){this.$get=[function(){return Ge}]}],pa=/^[^\(]*\(\s*([^\)]*)\)/m,ha=/,/,ga=/^\s*(_?)(\S+?)\1\s*$/,ma=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,va=r("$injector");Je.$$annotate=Ze;var ya=r("$animate"),ba=1,xa=function(){this.$get=["$q","$$rAF",function(e,t){function n(){}return n.all=g,n.chain=g,n.prototype={end:g,cancel:g,resume:g,pause:g,complete:g,then:function(n,r){return e(function(e){t(function(){e()})}).then(n,r)}},n}]},wa=function(){var e=new Ge,t=[];this.$get=["$$AnimateRunner","$rootScope",function(n,r){function a(n,a,o){var s=e.get(n);s||(e.put(n,s={}),t.push(n));var l=function(e,t){var n=!1;return e&&i(e=C(e)?e.split(" "):Or(e)?e:[],function(e){e&&(n=!0,s[e]=t)}),n},u=l(a,!0),c=l(o,!1);!u&&!c||t.length>1||r.$$postDigest(function(){i(t,function(t){var n=e.get(t);if(n){var r=et(t.attr("class")),a="",o="";i(n,function(e,t){e!==!!r[t]&&(e?a+=(a.length?" ":"")+t:o+=(o.length?" ":"")+t)}),i(t,function(e){a&&Ne(e,a),o&&Oe(e,o)}),e.remove(t)}}),t.length=0})}return{enabled:g,on:g,off:g,pin:g,push:function(e,t,r,i){return i&&i(),(r=r||{}).from&&e.css(r.from),r.to&&e.css(r.to),(r.addClass||r.removeClass)&&a(e,r.addClass,r.removeClass),new n}}}]},$a=["$provide",function(e){var t=this;this.$$registeredAnimations=Object.create(null),this.register=function(n,r){if(n&&"."!==n.charAt(0))throw ya("notcsel","Expecting class selector starting with '.' got '{0}'.",n);var a=n+"-animation";t.$$registeredAnimations[n.substr(1)]=a,e.factory(a,r)},this.classNameFilter=function(e){if(1===arguments.length&&(this.$$classNameFilter=e instanceof RegExp?e:null,this.$$classNameFilter&&new RegExp("(\\s+|\\/)ng-animate(\\s+|\\/)").test(this.$$classNameFilter.toString())))throw ya("nongcls",'$animateProvider.classNameFilter(regex) prohibits accepting a regex value which matches/contains the "{0}" CSS class.',"ng-animate");return this.$$classNameFilter},this.$get=["$$animateQueue",function(e){function t(e,t,n){if(n){var r=Ke(n);!r||r.parentNode||r.previousElementSibling||(n=null)}n?n.after(e):t.prepend(e)}return{on:e.on,off:e.off,pin:e.pin,enabled:e.enabled,cancel:function(e){e.end&&e.end()},enter:function(n,r,a,i){return r=r&&$r(r),a=a&&$r(a),r=r||a.parent(),t(n,r,a),e.push(n,"enter",tt(i))},move:function(n,r,a,i){return r=r&&$r(r),a=a&&$r(a),r=r||a.parent(),t(n,r,a),e.push(n,"move",tt(i))},leave:function(t,n){return e.push(t,"leave",tt(n),function(){t.remove()})},addClass:function(t,n,r){return r=tt(r),r.addClass=Qe(r.addclass,n),e.push(t,"addClass",r)},removeClass:function(t,n,r){return r=tt(r),r.removeClass=Qe(r.removeClass,n),e.push(t,"removeClass",r)},setClass:function(t,n,r,a){return a=tt(a),a.addClass=Qe(a.addClass,n),a.removeClass=Qe(a.removeClass,r),e.push(t,"setClass",a)},animate:function(t,n,r,a,i){return i=tt(i),i.from=i.from?d(i.from,n):n,i.to=i.to?d(i.to,r):r,a=a||"ng-inline-animate",i.tempClasses=Qe(i.tempClasses,a),e.push(t,"animate",i)}}}]}],Ca=function(){this.$get=["$$rAF","$q",function(e,t){var n=function(){};return n.prototype={done:function(e){this.defer&&this.defer[!0===e?"reject":"resolve"]()},end:function(){this.done()},cancel:function(){this.done(!0)},getPromise:function(){return this.defer||(this.defer=t.defer()),this.defer.promise},then:function(e,t){return this.getPromise().then(e,t)},catch:function(e){return this.getPromise().catch(e)},finally:function(e){return this.getPromise().finally(e)}},function(t,r){function a(){return e(function(){i(),o||s.done(),o=!0}),s}function i(){r.addClass&&(t.addClass(r.addClass),r.addClass=null),r.removeClass&&(t.removeClass(r.removeClass),r.removeClass=null),r.to&&(t.css(r.to),r.to=null)}r.from&&(t.css(r.from),r.from=null);var o,s=new n;return{start:a,end:a}}}]},_a=r("$compile");ot.$inject=["$provide","$$sanitizeUriProvider"];var Ea=/^((?:x|data)[\:\-_])/i,Aa=r("$controller"),ka=/^(\S+)(\s+as\s+(\w+))?$/,Sa=function(){this.$get=["$document",function(e){return function(t){return t?!t.nodeType&&t instanceof $r&&(t=t[0]):t=e[0].body,t.offsetWidth+1}}]},Da="application/json",Ta={"Content-Type":Da+";charset=utf-8"},Fa=/^\[|^\{(?!\{)/,Ma={"[":/]$/,"{":/}$/},La=/^\)\]\}',?\n/,Oa=r("$http"),Na=function(e){return function(){throw Oa("legacy","The method `{0}` on the promise returned from `$http` has been disabled.",e)}},ja=Fr.$interpolateMinErr=r("$interpolate");ja.throwNoconcat=function(e){throw ja("noconcat","Error while interpolating: {0}\nStrict Contextual Escaping disallows interpolations that concatenate multiple expressions when a trusted value is required.  See http://docs.angularjs.org/api/ng.$sce",e)},ja.interr=function(e,t){return ja("interr","Can't interpolate: {0}\n{1}",e,t.toString())};var Pa=/^([^\?#]*)(\?([^#]*))?(#(.*))?$/,Ba={http:80,https:443,ftp:21},qa=r("$location"),Ra={$$html5:!1,$$replace:!1,absUrl:Rt("$$absUrl"),url:function(e){if(b(e))return this.$$url;var t=Pa.exec(e);return(t[1]||""===e)&&this.path(decodeURIComponent(t[1])),(t[2]||t[1]||""===e)&&this.search(t[3]||""),this.hash(t[5]||""),this},protocol:Rt("$$protocol"),host:Rt("$$host"),port:Rt("$$port"),path:It("$$path",function(e){return e=null!==e?e.toString():"","/"==e.charAt(0)?e:"/"+e}),search:function(e,t){switch(arguments.length){case 0:return this.$$search;case 1:if(C(e)||_(e))e=e.toString(),this.$$search=ee(e);else{if(!w(e))throw qa("isrcharg","The first argument of the `$location#search()` call must be a string or an object.");i(e=R(e,{}),function(t,n){null==t&&delete e[n]}),this.$$search=e}break;default:b(t)||null===t?delete this.$$search[e]:this.$$search[e]=t}return this.$$compose(),this},hash:It("$$hash",function(e){return null!==e?e.toString():""}),replace:function(){return this.$$replace=!0,this}};i([qt,Bt,Pt],function(e){e.prototype=Object.create(Ra),e.prototype.state=function(t){if(!arguments.length)return this.$$state;if(e!==Pt||!this.$$html5)throw qa("nostate","History API state support is available only in HTML5 mode and only in browsers supporting HTML5 History API");return this.$$state=b(t)?null:t,this}});var Ia=r("$parse"),Ua=Function.prototype.call,za=Function.prototype.apply,Va=Function.prototype.bind,Ha=ge();i("+ - * / % === !== == != < > <= >= && || ! = |".split(" "),function(e){Ha[e]=!0});var Ya={n:"\n",f:"\f",r:"\r",t:"\t",v:"\v","'":"'",'"':'"'},Ga=function(e){this.options=e};Ga.prototype={constructor:Ga,lex:function(e){for(this.text=e,this.index=0,this.tokens=[];this.index<this.text.length;){var t=this.text.charAt(this.index);if('"'===t||"'"===t)this.readString(t);else if(this.isNumber(t)||"."===t&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(t))this.readIdent();else if(this.is(t,"(){}[].,;:?"))this.tokens.push({index:this.index,text:t}),this.index++;else if(this.isWhitespace(t))this.index++;else{var n=t+this.peek(),r=n+this.peek(2),a=Ha[t],i=Ha[n],o=Ha[r];if(a||i||o){var s=o?r:i?n:t;this.tokens.push({index:this.index,text:s,operator:!0}),this.index+=s.length}else this.throwError("Unexpected next character ",this.index,this.index+1)}}return this.tokens},is:function(e,t){return-1!==t.indexOf(e)},peek:function(e){var t=e||1;return this.index+t<this.text.length&&this.text.charAt(this.index+t)},isNumber:function(e){return"0"<=e&&e<="9"&&"string"==typeof e},isWhitespace:function(e){return" "===e||"\r"===e||"\t"===e||"\n"===e||"\v"===e||""===e},isIdent:function(e){return"a"<=e&&e<="z"||"A"<=e&&e<="Z"||"_"===e||"$"===e},isExpOperator:function(e){return"-"===e||"+"===e||this.isNumber(e)},throwError:function(e,t,n){n=n||this.index;var r=x(t)?"s "+t+"-"+this.index+" ["+this.text.substring(t,n)+"]":" "+n;throw Ia("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",e,r,this.text)},readNumber:function(){for(var e="",t=this.index;this.index<this.text.length;){var n=mr(this.text.charAt(this.index));if("."==n||this.isNumber(n))e+=n;else{var r=this.peek();if("e"==n&&this.isExpOperator(r))e+=n;else if(this.isExpOperator(n)&&r&&this.isNumber(r)&&"e"==e.charAt(e.length-1))e+=n;else{if(!this.isExpOperator(n)||r&&this.isNumber(r)||"e"!=e.charAt(e.length-1))break;this.throwError("Invalid exponent")}}this.index++}this.tokens.push({index:t,text:e,constant:!0,value:Number(e)})},readIdent:function(){for(var e=this.index;this.index<this.text.length;){var t=this.text.charAt(this.index);if(!this.isIdent(t)&&!this.isNumber(t))break;this.index++}this.tokens.push({index:e,text:this.text.slice(e,this.index),identifier:!0})},readString:function(e){var t=this.index;this.index++;for(var n="",r=e,a=!1;this.index<this.text.length;){var i=this.text.charAt(this.index);if(r+=i,a){if("u"===i){var o=this.text.substring(this.index+1,this.index+5);o.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+o+"]"),this.index+=4,n+=String.fromCharCode(parseInt(o,16))}else n+=Ya[i]||i;a=!1}else if("\\"===i)a=!0;else{if(i===e)return this.index++,void this.tokens.push({index:t,text:r,constant:!0,value:n});n+=i}this.index++}this.throwError("Unterminated quote",t)}};var Wa=function(e,t){this.lexer=e,this.options=t};Wa.Program="Program",Wa.ExpressionStatement="ExpressionStatement",Wa.AssignmentExpression="AssignmentExpression",Wa.ConditionalExpression="ConditionalExpression",Wa.LogicalExpression="LogicalExpression",Wa.BinaryExpression="BinaryExpression",Wa.UnaryExpression="UnaryExpression",Wa.CallExpression="CallExpression",Wa.MemberExpression="MemberExpression",Wa.Identifier="Identifier",Wa.Literal="Literal",Wa.ArrayExpression="ArrayExpression",Wa.Property="Property",Wa.ObjectExpression="ObjectExpression",Wa.ThisExpression="ThisExpression",Wa.NGValueParameter="NGValueParameter",Wa.prototype={ast:function(e){this.text=e,this.tokens=this.lexer.lex(e);var t=this.program();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),t},program:function(){for(var e=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&e.push(this.expressionStatement()),!this.expect(";"))return{type:Wa.Program,body:e}},expressionStatement:function(){return{type:Wa.ExpressionStatement,expression:this.filterChain()}},filterChain:function(){for(var e=this.expression();this.expect("|");)e=this.filter(e);return e},expression:function(){return this.assignment()},assignment:function(){var e=this.ternary();return this.expect("=")&&(e={type:Wa.AssignmentExpression,left:e,right:this.assignment(),operator:"="}),e},ternary:function(){var e,t,n=this.logicalOR();return this.expect("?")&&(e=this.expression(),this.consume(":"))?(t=this.expression(),{type:Wa.ConditionalExpression,test:n,alternate:e,consequent:t}):n},logicalOR:function(){for(var e=this.logicalAND();this.expect("||");)e={type:Wa.LogicalExpression,operator:"||",left:e,right:this.logicalAND()};return e},logicalAND:function(){for(var e=this.equality();this.expect("&&");)e={type:Wa.LogicalExpression,operator:"&&",left:e,right:this.equality()};return e},equality:function(){for(var e,t=this.relational();e=this.expect("==","!=","===","!==");)t={type:Wa.BinaryExpression,operator:e.text,left:t,right:this.relational()};return t},relational:function(){for(var e,t=this.additive();e=this.expect("<",">","<=",">=");)t={type:Wa.BinaryExpression,operator:e.text,left:t,right:this.additive()};return t},additive:function(){for(var e,t=this.multiplicative();e=this.expect("+","-");)t={type:Wa.BinaryExpression,operator:e.text,left:t,right:this.multiplicative()};return t},multiplicative:function(){for(var e,t=this.unary();e=this.expect("*","/","%");)t={type:Wa.BinaryExpression,operator:e.text,left:t,right:this.unary()};return t},unary:function(){var e;return(e=this.expect("+","-","!"))?{type:Wa.UnaryExpression,operator:e.text,prefix:!0,argument:this.unary()}:this.primary()},primary:function(){var e;this.expect("(")?(e=this.filterChain(),this.consume(")")):this.expect("[")?e=this.arrayDeclaration():this.expect("{")?e=this.object():this.constants.hasOwnProperty(this.peek().text)?e=R(this.constants[this.consume().text]):this.peek().identifier?e=this.identifier():this.peek().constant?e=this.constant():this.throwError("not a primary expression",this.peek());for(var t;t=this.expect("(","[",".");)"("===t.text?(e={type:Wa.CallExpression,callee:e,arguments:this.parseArguments()},this.consume(")")):"["===t.text?(e={type:Wa.MemberExpression,object:e,property:this.expression(),computed:!0},this.consume("]")):"."===t.text?e={type:Wa.MemberExpression,object:e,property:this.identifier(),computed:!1}:this.throwError("IMPOSSIBLE");return e},filter:function(e){for(var t=[e],n={type:Wa.CallExpression,callee:this.identifier(),arguments:t,filter:!0};this.expect(":");)t.push(this.expression());return n},parseArguments:function(){var e=[];if(")"!==this.peekToken().text)do{e.push(this.expression())}while(this.expect(","));return e},identifier:function(){var e=this.consume();return e.identifier||this.throwError("is not a valid identifier",e),{type:Wa.Identifier,name:e.text}},constant:function(){return{type:Wa.Literal,value:this.consume().value}},arrayDeclaration:function(){var e=[];if("]"!==this.peekToken().text)do{if(this.peek("]"))break;e.push(this.expression())}while(this.expect(","));return this.consume("]"),{type:Wa.ArrayExpression,elements:e}},object:function(){var e,t=[];if("}"!==this.peekToken().text)do{if(this.peek("}"))break;e={type:Wa.Property,kind:"init"},this.peek().constant?e.key=this.constant():this.peek().identifier?e.key=this.identifier():this.throwError("invalid key",this.peek()),this.consume(":"),e.value=this.expression(),t.push(e)}while(this.expect(","));return this.consume("}"),{type:Wa.ObjectExpression,properties:t}},throwError:function(e,t){throw Ia("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",t.text,e,t.index+1,this.text,this.text.substring(t.index))},consume:function(e){if(0===this.tokens.length)throw Ia("ueoe","Unexpected end of expression: {0}",this.text);var t=this.expect(e);return t||this.throwError("is unexpected, expecting ["+e+"]",this.peek()),t},peekToken:function(){if(0===this.tokens.length)throw Ia("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(e,t,n,r){return this.peekAhead(0,e,t,n,r)},peekAhead:function(e,t,n,r,a){if(this.tokens.length>e){var i=this.tokens[e],o=i.text;if(o===t||o===n||o===r||o===a||!t&&!n&&!r&&!a)return i}return!1},expect:function(e,t,n,r){var a=this.peek(e,t,n,r);return!!a&&(this.tokens.shift(),a)},constants:{true:{type:Wa.Literal,value:!0},false:{type:Wa.Literal,value:!1},null:{type:Wa.Literal,value:null},undefined:{type:Wa.Literal,value:n},this:{type:Wa.ThisExpression}}},nn.prototype={compile:function(e,t){var r=this,a=this.astBuilder.ast(e);this.state={nextId:0,filters:{},expensiveChecks:t,fn:{vars:[],body:[],own:{}},assign:{vars:[],body:[],own:{}},inputs:[]},Jt(a,r.$filter);var o,s="";if(this.stage="assign",o=Kt(a)){this.state.computing="assign";var l=this.nextId();this.recurse(o,l),s="fn.assign="+this.generateFunction("assign","s,v,l")}var u=Xt(a.body);r.stage="inputs",i(u,function(e,t){var n="fn"+t;r.state[n]={vars:[],body:[],own:{}},r.state.computing=n;var a=r.nextId();r.recurse(e,a),r.return_(a),r.state.inputs.push(n),e.watchId=t}),this.state.computing="fn",this.stage="main",this.recurse(a);var c='"'+this.USE+" "+this.STRICT+'";\n'+this.filterPrefix()+"var fn="+this.generateFunction("fn","s,l,a,i")+s+this.watchFns()+"return fn;",d=new Function("$filter","ensureSafeMemberName","ensureSafeObject","ensureSafeFunction","ifDefined","plus","text",c)(this.$filter,Vt,Ht,Yt,Gt,Wt,e);return this.state=this.stage=n,d.literal=en(a),d.constant=tn(a),d},USE:"use",STRICT:"strict",watchFns:function(){var e=[],t=this.state.inputs,n=this;return i(t,function(t){e.push("var "+t+"="+n.generateFunction(t,"s"))}),t.length&&e.push("fn.inputs=["+t.join(",")+"];"),e.join("")},generateFunction:function(e,t){return"function("+t+"){"+this.varsPrefix(e)+this.body(e)+"};"},filterPrefix:function(){var e=[],t=this;return i(this.state.filters,function(n,r){e.push(n+"=$filter("+t.escape(r)+")")}),e.length?"var "+e.join(",")+";":""},varsPrefix:function(e){return this.state[e].vars.length?"var "+this.state[e].vars.join(",")+";":""},body:function(e){return this.state[e].body.join("")},recurse:function(e,t,r,a,o,s){var l,u,c,d,f=this;if(a=a||g,!s&&x(e.watchId))return t=t||this.nextId(),void this.if_("i",this.lazyAssign(t,this.computedMember("i",e.watchId)),this.lazyRecurse(e,t,r,a,o,!0));switch(e.type){case Wa.Program:i(e.body,function(t,r){f.recurse(t.expression,n,n,function(e){u=e}),r!==e.body.length-1?f.current().body.push(u,";"):f.return_(u)});break;case Wa.Literal:d=this.escape(e.value),this.assign(t,d),a(d);break;case Wa.UnaryExpression:this.recurse(e.argument,n,n,function(e){u=e}),d=e.operator+"("+this.ifDefined(u,0)+")",this.assign(t,d),a(d);break;case Wa.BinaryExpression:this.recurse(e.left,n,n,function(e){l=e}),this.recurse(e.right,n,n,function(e){u=e}),d="+"===e.operator?this.plus(l,u):"-"===e.operator?this.ifDefined(l,0)+e.operator+this.ifDefined(u,0):"("+l+")"+e.operator+"("+u+")",this.assign(t,d),a(d);break;case Wa.LogicalExpression:t=t||this.nextId(),f.recurse(e.left,t),f.if_("&&"===e.operator?t:f.not(t),f.lazyRecurse(e.right,t)),a(t);break;case Wa.ConditionalExpression:t=t||this.nextId(),f.recurse(e.test,t),f.if_(t,f.lazyRecurse(e.alternate,t),f.lazyRecurse(e.consequent,t)),a(t);break;case Wa.Identifier:t=t||this.nextId(),r&&(r.context="inputs"===f.stage?"s":this.assign(this.nextId(),this.getHasOwnProperty("l",e.name)+"?l:s"),r.computed=!1,r.name=e.name),Vt(e.name),f.if_("inputs"===f.stage||f.not(f.getHasOwnProperty("l",e.name)),function(){f.if_("inputs"===f.stage||"s",function(){o&&1!==o&&f.if_(f.not(f.nonComputedMember("s",e.name)),f.lazyAssign(f.nonComputedMember("s",e.name),"{}")),f.assign(t,f.nonComputedMember("s",e.name))})},t&&f.lazyAssign(t,f.nonComputedMember("l",e.name))),(f.state.expensiveChecks||an(e.name))&&f.addEnsureSafeObject(t),a(t);break;case Wa.MemberExpression:l=r&&(r.context=this.nextId())||this.nextId(),t=t||this.nextId(),f.recurse(e.object,l,n,function(){f.if_(f.notNull(l),function(){e.computed?(u=f.nextId(),f.recurse(e.property,u),f.addEnsureSafeMemberName(u),o&&1!==o&&f.if_(f.not(f.computedMember(l,u)),f.lazyAssign(f.computedMember(l,u),"{}")),d=f.ensureSafeObject(f.computedMember(l,u)),f.assign(t,d),r&&(r.computed=!0,r.name=u)):(Vt(e.property.name),o&&1!==o&&f.if_(f.not(f.nonComputedMember(l,e.property.name)),f.lazyAssign(f.nonComputedMember(l,e.property.name),"{}")),d=f.nonComputedMember(l,e.property.name),(f.state.expensiveChecks||an(e.property.name))&&(d=f.ensureSafeObject(d)),f.assign(t,d),r&&(r.computed=!1,r.name=e.property.name))},function(){f.assign(t,"undefined")}),a(t)},!!o);break;case Wa.CallExpression:t=t||this.nextId(),e.filter?(u=f.filter(e.callee.name),c=[],i(e.arguments,function(e){var t=f.nextId();f.recurse(e,t),c.push(t)}),d=u+"("+c.join(",")+")",f.assign(t,d),a(t)):(u=f.nextId(),l={},c=[],f.recurse(e.callee,u,l,function(){f.if_(f.notNull(u),function(){f.addEnsureSafeFunction(u),i(e.arguments,function(e){f.recurse(e,f.nextId(),n,function(e){c.push(f.ensureSafeObject(e))})}),l.name?(f.state.expensiveChecks||f.addEnsureSafeObject(l.context),d=f.member(l.context,l.name,l.computed)+"("+c.join(",")+")"):d=u+"("+c.join(",")+")",d=f.ensureSafeObject(d),f.assign(t,d)},function(){f.assign(t,"undefined")}),a(t)}));break;case Wa.AssignmentExpression:if(u=this.nextId(),l={},!Qt(e.left))throw Ia("lval","Trying to assing a value to a non l-value");this.recurse(e.left,n,l,function(){f.if_(f.notNull(l.context),function(){f.recurse(e.right,u),f.addEnsureSafeObject(f.member(l.context,l.name,l.computed)),d=f.member(l.context,l.name,l.computed)+e.operator+u,f.assign(t,d),a(t||d)})},1);break;case Wa.ArrayExpression:c=[],i(e.elements,function(e){f.recurse(e,f.nextId(),n,function(e){c.push(e)})}),d="["+c.join(",")+"]",this.assign(t,d),a(d);break;case Wa.ObjectExpression:c=[],i(e.properties,function(e){f.recurse(e.value,f.nextId(),n,function(t){c.push(f.escape(e.key.type===Wa.Identifier?e.key.name:""+e.key.value)+":"+t)})}),d="{"+c.join(",")+"}",this.assign(t,d),a(d);break;case Wa.ThisExpression:this.assign(t,"s"),a("s");break;case Wa.NGValueParameter:this.assign(t,"v"),a("v")}},getHasOwnProperty:function(e,t){var n=e+"."+t,r=this.current().own;return r.hasOwnProperty(n)||(r[n]=this.nextId(!1,e+"&&("+this.escape(t)+" in "+e+")")),r[n]},assign:function(e,t){if(e)return this.current().body.push(e,"=",t,";"),e},filter:function(e){return this.state.filters.hasOwnProperty(e)||(this.state.filters[e]=this.nextId(!0)),this.state.filters[e]},ifDefined:function(e,t){return"ifDefined("+e+","+this.escape(t)+")"},plus:function(e,t){return"plus("+e+","+t+")"},return_:function(e){this.current().body.push("return ",e,";")},if_:function(e,t,n){if(!0===e)t();else{var r=this.current().body;r.push("if(",e,"){"),t(),r.push("}"),n&&(r.push("else{"),n(),r.push("}"))}},not:function(e){return"!("+e+")"},notNull:function(e){return e+"!=null"},nonComputedMember:function(e,t){return e+"."+t},computedMember:function(e,t){return e+"["+t+"]"},member:function(e,t,n){return n?this.computedMember(e,t):this.nonComputedMember(e,t)},addEnsureSafeObject:function(e){this.current().body.push(this.ensureSafeObject(e),";")},addEnsureSafeMemberName:function(e){this.current().body.push(this.ensureSafeMemberName(e),";")},addEnsureSafeFunction:function(e){this.current().body.push(this.ensureSafeFunction(e),";")},ensureSafeObject:function(e){return"ensureSafeObject("+e+",text)"},ensureSafeMemberName:function(e){return"ensureSafeMemberName("+e+",text)"},ensureSafeFunction:function(e){return"ensureSafeFunction("+e+",text)"},lazyRecurse:function(e,t,n,r,a,i){var o=this;return function(){o.recurse(e,t,n,r,a,i)}},lazyAssign:function(e,t){var n=this;return function(){n.assign(e,t)}},stringEscapeRegex:/[^ a-zA-Z0-9]/g,stringEscapeFn:function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)},escape:function(e){if(C(e))return"'"+e.replace(this.stringEscapeRegex,this.stringEscapeFn)+"'";if(_(e))return e.toString();if(!0===e)return"true";if(!1===e)return"false";if(null===e)return"null";if(void 0===e)return"undefined";throw Ia("esc","IMPOSSIBLE")},nextId:function(e,t){var n="v"+this.state.nextId++;return e||this.current().vars.push(n+(t?"="+t:"")),n},current:function(){return this.state[this.state.computing]}},rn.prototype={compile:function(e,t){var n=this,r=this.astBuilder.ast(e);this.expression=e,this.expensiveChecks=t,Jt(r,n.$filter);var a,o;(a=Kt(r))&&(o=this.recurse(a));var s,l=Xt(r.body);l&&(s=[],i(l,function(e,t){var r=n.recurse(e);e.input=r,s.push(r),e.watchId=t}));var u=[];i(r.body,function(e){u.push(n.recurse(e.expression))});var c=0===r.body.length?function(){}:1===r.body.length?u[0]:function(e,t){var n;return i(u,function(r){n=r(e,t)}),n};return o&&(c.assign=function(e,t,n){return o(e,n,t)}),s&&(c.inputs=s),c.literal=en(r),c.constant=tn(r),c},recurse:function(e,t,r){var a,o,s,l=this;if(e.input)return this.inputs(e.input,e.watchId);switch(e.type){case Wa.Literal:return this.value(e.value,t);case Wa.UnaryExpression:return o=this.recurse(e.argument),this["unary"+e.operator](o,t);case Wa.BinaryExpression:case Wa.LogicalExpression:return a=this.recurse(e.left),o=this.recurse(e.right),this["binary"+e.operator](a,o,t);case Wa.ConditionalExpression:return this["ternary?:"](this.recurse(e.test),this.recurse(e.alternate),this.recurse(e.consequent),t);case Wa.Identifier:return Vt(e.name,l.expression),l.identifier(e.name,l.expensiveChecks||an(e.name),t,r,l.expression);case Wa.MemberExpression:return a=this.recurse(e.object,!1,!!r),e.computed||(Vt(e.property.name,l.expression),o=e.property.name),e.computed&&(o=this.recurse(e.property)),e.computed?this.computedMember(a,o,t,r,l.expression):this.nonComputedMember(a,o,l.expensiveChecks,t,r,l.expression);case Wa.CallExpression:return s=[],i(e.arguments,function(e){s.push(l.recurse(e))}),e.filter&&(o=this.$filter(e.callee.name)),e.filter||(o=this.recurse(e.callee,!0)),e.filter?function(e,r,a,i){for(var l=[],u=0;u<s.length;++u)l.push(s[u](e,r,a,i));var c=o.apply(n,l,i);return t?{context:n,name:n,value:c}:c}:function(e,n,r,a){var i,u=o(e,n,r,a);if(null!=u.value){Ht(u.context,l.expression),Yt(u.value,l.expression);for(var c=[],d=0;d<s.length;++d)c.push(Ht(s[d](e,n,r,a),l.expression));i=Ht(u.value.apply(u.context,c),l.expression)}return t?{value:i}:i};case Wa.AssignmentExpression:return a=this.recurse(e.left,!0,1),o=this.recurse(e.right),function(e,n,r,i){var s=a(e,n,r,i),u=o(e,n,r,i);return Ht(s.value,l.expression),s.context[s.name]=u,t?{value:u}:u};case Wa.ArrayExpression:return s=[],i(e.elements,function(e){s.push(l.recurse(e))}),function(e,n,r,a){for(var i=[],o=0;o<s.length;++o)i.push(s[o](e,n,r,a));return t?{value:i}:i};case Wa.ObjectExpression:return s=[],i(e.properties,function(e){s.push({key:e.key.type===Wa.Identifier?e.key.name:""+e.key.value,value:l.recurse(e.value)})}),function(e,n,r,a){for(var i={},o=0;o<s.length;++o)i[s[o].key]=s[o].value(e,n,r,a);return t?{value:i}:i};case Wa.ThisExpression:return function(e){return t?{value:e}:e};case Wa.NGValueParameter:return function(e,n,r,a){return t?{value:r}:r}}},"unary+":function(e,t){return function(n,r,a,i){var o=e(n,r,a,i);return o=x(o)?+o:0,t?{value:o}:o}},"unary-":function(e,t){return function(n,r,a,i){var o=e(n,r,a,i);return o=x(o)?-o:0,t?{value:o}:o}},"unary!":function(e,t){return function(n,r,a,i){var o=!e(n,r,a,i);return t?{value:o}:o}},"binary+":function(e,t,n){return function(r,a,i,o){var s=Wt(e(r,a,i,o),t(r,a,i,o));return n?{value:s}:s}},"binary-":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o),l=t(r,a,i,o),u=(x(s)?s:0)-(x(l)?l:0);return n?{value:u}:u}},"binary*":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)*t(r,a,i,o);return n?{value:s}:s}},"binary/":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)/t(r,a,i,o);return n?{value:s}:s}},"binary%":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)%t(r,a,i,o);return n?{value:s}:s}},"binary===":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)===t(r,a,i,o);return n?{value:s}:s}},"binary!==":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)!==t(r,a,i,o);return n?{value:s}:s}},"binary==":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)==t(r,a,i,o);return n?{value:s}:s}},"binary!=":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)!=t(r,a,i,o);return n?{value:s}:s}},"binary<":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)<t(r,a,i,o);return n?{value:s}:s}},"binary>":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)>t(r,a,i,o);return n?{value:s}:s}},"binary<=":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)<=t(r,a,i,o);return n?{value:s}:s}},"binary>=":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)>=t(r,a,i,o);return n?{value:s}:s}},"binary&&":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)&&t(r,a,i,o);return n?{value:s}:s}},"binary||":function(e,t,n){return function(r,a,i,o){var s=e(r,a,i,o)||t(r,a,i,o);return n?{value:s}:s}},"ternary?:":function(e,t,n,r){return function(a,i,o,s){var l=e(a,i,o,s)?t(a,i,o,s):n(a,i,o,s);return r?{value:l}:l}},value:function(e,t){return function(){return t?{context:n,name:n,value:e}:e}},identifier:function(e,t,r,a,i){return function(o,s,l,u){var c=s&&e in s?s:o;a&&1!==a&&c&&!c[e]&&(c[e]={});var d=c?c[e]:n;return t&&Ht(d,i),r?{context:c,name:e,value:d}:d}},computedMember:function(e,t,n,r,a){return function(i,o,s,l){var u,c,d=e(i,o,s,l);return null!=d&&(Vt(u=t(i,o,s,l),a),r&&1!==r&&d&&!d[u]&&(d[u]={}),Ht(c=d[u],a)),n?{context:d,name:u,value:c}:c}},nonComputedMember:function(e,t,r,a,i,o){return function(s,l,u,c){var d=e(s,l,u,c);i&&1!==i&&d&&!d[t]&&(d[t]={});var f=null!=d?d[t]:n;return(r||an(t))&&Ht(f,o),a?{context:d,name:t,value:f}:f}},inputs:function(e,t){return function(n,r,a,i){return i?i[t]:e(n,r,a)}}};var Za=function(e,t,n){this.lexer=e,this.$filter=t,this.options=n,this.ast=new Wa(this.lexer),this.astCompiler=n.csp?new rn(this.ast,t):new nn(this.ast,t)};Za.prototype={constructor:Za,parse:function(e){return this.astCompiler.compile(e,this.options.expensiveChecks)}};ge(),ge();var Ja=Object.prototype.valueOf,Xa=r("$sce"),Qa={HTML:"html",CSS:"css",URL:"url",RESOURCE_URL:"resourceUrl",JS:"js"},_a=r("$compile"),Ka=t.createElement("a"),ei=$n(e.location.href);En.$inject=["$document"],kn.$inject=["$provide"],Mn.$inject=["$locale"],Ln.$inject=["$locale"];var ti=".",ni={yyyy:jn("FullYear",4),yy:jn("FullYear",2,0,!0),y:jn("FullYear",1),MMMM:Pn("Month"),MMM:Pn("Month",!0),MM:jn("Month",2,1),M:jn("Month",1,1),dd:jn("Date",2),d:jn("Date",1),HH:jn("Hours",2),H:jn("Hours",1),hh:jn("Hours",2,-12),h:jn("Hours",1,-12),mm:jn("Minutes",2),m:jn("Minutes",1),ss:jn("Seconds",2),s:jn("Seconds",1),sss:jn("Milliseconds",3),EEEE:Pn("Day"),EEE:Pn("Day",!0),a:Un,Z:Bn,ww:In(2),w:In(1),G:zn,GG:zn,GGG:zn,GGGG:Vn},ri=/((?:[^yMdHhmsaZEwG']+)|(?:'(?:[^']|'')*')|(?:E+|y+|M+|d+|H+|h+|m+|s+|a|Z|G+|w+))(.*)/,ai=/^\-?\d+$/;Hn.$inject=["$locale"];var ii=v(mr),oi=v(yr);Wn.$inject=["$parse"];var si=v({restrict:"E",compile:function(e,t){if(!t.href&&!t.xlinkHref)return function(e,t){if("a"===t[0].nodeName.toLowerCase()){var n="[object SVGAnimatedString]"===Sr.call(t.prop("href"))?"xlink:href":"href";t.on("click",function(e){t.attr(n)||e.preventDefault()})}}}}),li={};i(ua,function(e,t){function n(e,n,a){e.$watch(a[r],function(e){a.$set(t,!!e)})}if("multiple"!=e){var r=st("ng-"+t),a=n;"checked"===e&&(a=function(e,t,a){a.ngModel!==a[r]&&n(e,t,a)}),li[r]=function(){return{restrict:"A",priority:100,link:a}}}}),i(da,function(e,t){li[t]=function(){return{priority:100,link:function(e,n,r){if("ngPattern"===t&&"/"==r.ngPattern.charAt(0)){var a=r.ngPattern.match(hr);if(a)return void r.$set("ngPattern",new RegExp(a[1],a[2]))}e.$watch(r[t],function(e){r.$set(t,e)})}}}}),i(["src","srcset","href"],function(e){var t=st("ng-"+e);li[t]=function(){return{priority:99,link:function(n,r,a){var i=e,o=e;"href"===e&&"[object SVGAnimatedString]"===Sr.call(r.prop("href"))&&(o="xlinkHref",a.$attr[o]="xlink:href",i=null),a.$observe(t,function(t){t?(a.$set(o,t),wr&&i&&r.prop(i,a[o])):"href"===e&&a.$set(o,null)})}}}});var ui={$addControl:g,$$renameControl:Jn,$removeControl:g,$setValidity:g,$setDirty:g,$setPristine:g,$setSubmitted:g},ci="ng-submitted";Xn.$inject=["$element","$attrs","$scope","$animate","$interpolate"];var di=function(e){return["$timeout","$parse",function(t,r){function a(e){return""===e?r('this[""]').assign:r(e).assign||g}return{name:"form",restrict:e?"EAC":"E",controller:Xn,compile:function(r,i){r.addClass(Hi).addClass(zi);var o=i.name?"name":!(!e||!i.ngForm)&&"ngForm";return{pre:function(e,r,i,s){if(!("action"in i)){var l=function(t){e.$apply(function(){s.$commitViewValue(),s.$setSubmitted()}),t.preventDefault()};Xr(r[0],"submit",l),r.on("$destroy",function(){t(function(){Qr(r[0],"submit",l)},0,!1)})}var u=s.$$parentForm,c=o?a(s.$name):g;o&&(c(e,s),i.$observe(o,function(t){s.$name!==t&&(c(e,n),u.$$renameControl(s,t),(c=a(s.$name))(e,s))})),r.on("$destroy",function(){u.$removeControl(s),c(e,n),d(s,ui)})}}}}}]},fi=di(),pi=di(!0),hi=/\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z)/,gi=/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,mi=/^[a-z0-9!#$%&'*+\/=?^_`{|}~.-]+@[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)*$/i,vi=/^\s*(\-|\+)?(\d+|(\d*(\.\d*)))([eE][+-]?\d+)?\s*$/,yi=/^(\d{4})-(\d{2})-(\d{2})$/,bi=/^(\d{4})-(\d\d)-(\d\d)T(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,xi=/^(\d{4})-W(\d\d)$/,wi=/^(\d{4})-(\d\d)$/,$i=/^(\d\d):(\d\d)(?::(\d\d)(\.\d{1,3})?)?$/,Ci={text:Kn,date:rr("date",yi,nr(yi,["yyyy","MM","dd"]),"yyyy-MM-dd"),"datetime-local":rr("datetimelocal",bi,nr(bi,["yyyy","MM","dd","HH","mm","ss","sss"]),"yyyy-MM-ddTHH:mm:ss.sss"),time:rr("time",$i,nr($i,["HH","mm","ss","sss"]),"HH:mm:ss.sss"),week:rr("week",xi,tr,"yyyy-Www"),month:rr("month",wi,nr(wi,["yyyy","MM"]),"yyyy-MM"),number:ir,url:or,email:sr,radio:lr,checkbox:cr,hidden:g,button:g,submit:g,reset:g,file:g},_i=["$browser","$sniffer","$filter","$parse",function(e,t,n,r){return{restrict:"E",require:["?ngModel"],link:{pre:function(a,i,o,s){s[0]&&(Ci[mr(o.type)]||Ci.text)(a,i,o,s[0],t,e,n,r)}}}}],Ei=/^(true|false|\d+)$/,Ai=function(){return{restrict:"A",priority:100,compile:function(e,t){return Ei.test(t.ngValue)?function(e,t,n){n.$set("value",e.$eval(n.ngValue))}:function(e,t,n){e.$watch(n.ngValue,function(e){n.$set("value",e)})}}}},ki=["$compile",function(e){return{restrict:"AC",compile:function(t){return e.$$addBindingClass(t),function(t,r,a){e.$$addBindingInfo(r,a.ngBind),r=r[0],t.$watch(a.ngBind,function(e){r.textContent=e===n?"":e})}}}}],Si=["$interpolate","$compile",function(e,t){return{compile:function(r){return t.$$addBindingClass(r),function(r,a,i){var o=e(a.attr(i.$attr.ngBindTemplate));t.$$addBindingInfo(a,o.expressions),a=a[0],i.$observe("ngBindTemplate",function(e){a.textContent=e===n?"":e})}}}}],Di=["$sce","$parse","$compile",function(e,t,n){return{restrict:"A",compile:function(r,a){var i=t(a.ngBindHtml),o=t(a.ngBindHtml,function(e){return(e||"").toString()});return n.$$addBindingClass(r),function(t,r,a){n.$$addBindingInfo(r,a.ngBindHtml),t.$watch(o,function(){r.html(e.getTrustedHtml(i(t))||"")})}}}}],Ti=v({restrict:"A",require:"ngModel",link:function(e,t,n,r){r.$viewChangeListeners.push(function(){e.$eval(n.ngChange)})}}),Fi=dr("",!0),Mi=dr("Odd",0),Li=dr("Even",1),Oi=Zn({compile:function(e,t){t.$set("ngCloak",n),e.removeClass("ng-cloak")}}),Ni=[function(){return{restrict:"A",scope:!0,controller:"@",priority:500}}],ji={},Pi={blur:!0,focus:!0};i("click dblclick mousedown mouseup mouseover mouseout mousemove mouseenter mouseleave keydown keyup keypress submit focus blur copy cut paste".split(" "),function(e){var t=st("ng-"+e);ji[t]=["$parse","$rootScope",function(n,r){return{restrict:"A",compile:function(a,i){var o=n(i[t],null,!0);return function(t,n){n.on(e,function(n){var a=function(){o(t,{$event:n})};Pi[e]&&r.$$phase?t.$evalAsync(a):t.$apply(a)})}}}}]});var Bi=["$animate",function(e){return{multiElement:!0,transclude:"element",priority:600,terminal:!0,restrict:"A",$$tlb:!0,link:function(n,r,a,i,o){var s,l,u;n.$watch(a.ngIf,function(n){n?l||o(function(n,i){l=i,n[n.length++]=t.createComment(" end ngIf: "+a.ngIf+" "),s={clone:n},e.enter(n,r.parent(),r)}):(u&&(u.remove(),u=null),l&&(l.$destroy(),l=null),s&&(u=he(s.clone),e.leave(u).then(function(){u=null}),s=null))})}}}],qi=["$templateRequest","$anchorScroll","$animate",function(e,t,n){return{restrict:"ECA",priority:400,terminal:!0,transclude:"element",controller:Fr.noop,compile:function(r,a){var i=a.ngInclude||a.src,o=a.onload||"",s=a.autoscroll;return function(r,a,l,u,c){var d,f,p,h=0,g=function(){f&&(f.remove(),f=null),d&&(d.$destroy(),d=null),p&&(n.leave(p).then(function(){f=null}),f=p,p=null)};r.$watch(i,function(i){var l=function(){!x(s)||s&&!r.$eval(s)||t()},f=++h;i?(e(i,!0).then(function(e){if(f===h){var t=r.$new();u.template=e;var s=c(t,function(e){g(),n.enter(e,null,a).then(l)});p=s,(d=t).$emit("$includeContentLoaded",i),r.$eval(o)}},function(){f===h&&(g(),r.$emit("$includeContentError",i))}),r.$emit("$includeContentRequested",i)):(g(),u.template=null)})}}}}],Ri=["$compile",function(e){return{restrict:"ECA",priority:-400,require:"ngInclude",link:function(n,r,a,i){if(/SVG/.test(r[0].toString()))return r.empty(),void e(_e(i.template,t).childNodes)(n,function(e){r.append(e)},{futureParentElement:r});r.html(i.template),e(r.contents())(n)}}}],Ii=Zn({priority:450,compile:function(){return{pre:function(e,t,n){e.$eval(n.ngInit)}}}}),Ui=function(){return{restrict:"A",priority:100,require:"ngModel",link:function(e,t,r,a){var o=t.attr(r.$attr.ngList)||", ",s="false"!==r.ngTrim,l=s?jr(o):o,u=function(e){if(!b(e)){var t=[];return e&&i(e.split(l),function(e){e&&t.push(s?jr(e):e)}),t}};a.$parsers.push(u),a.$formatters.push(function(e){return Or(e)?e.join(o):n}),a.$isEmpty=function(e){return!e||!e.length}}}},zi="ng-valid",Vi="ng-invalid",Hi="ng-pristine",Yi="ng-dirty",Gi="ng-pending",Wi=r("ngModel"),Zi=["$scope","$exceptionHandler","$attrs","$element","$parse","$animate","$timeout","$rootScope","$q","$interpolate",function(e,t,r,a,o,s,l,u,c,d){this.$viewValue=Number.NaN,this.$modelValue=Number.NaN,this.$$rawModelValue=n,this.$validators={},this.$asyncValidators={},this.$parsers=[],this.$formatters=[],this.$viewChangeListeners=[],this.$untouched=!0,this.$touched=!1,this.$pristine=!0,this.$dirty=!1,this.$valid=!0,this.$invalid=!1,this.$error={},this.$$success={},this.$pending=n,this.$name=d(r.name||"",!1)(e);var f,p=o(r.ngModel),h=p.assign,m=p,v=h,y=null,w=this;this.$$setOptions=function(e){if(w.$options=e,e&&e.getterSetter){var t=o(r.ngModel+"()"),n=o(r.ngModel+"($$$p)");m=function(e){var n=p(e);return A(n)&&(n=t(e)),n},v=function(e,t){A(p(e))?n(e,{$$$p:w.$modelValue}):h(e,w.$modelValue)}}else if(!p.assign)throw Wi("nonassign","Expression '{0}' is non-assignable. Element: {1}",r.ngModel,Q(a))},this.$render=g,this.$isEmpty=function(e){return b(e)||""===e||null===e||e!==e};var $=a.inheritedData("$formController")||ui,C=0;fr({ctrl:this,$element:a,set:function(e,t){e[t]=!0},unset:function(e,t){delete e[t]},parentForm:$,$animate:s}),this.$setPristine=function(){w.$dirty=!1,w.$pristine=!0,s.removeClass(a,Yi),s.addClass(a,Hi)},this.$setDirty=function(){w.$dirty=!0,w.$pristine=!1,s.removeClass(a,Hi),s.addClass(a,Yi),$.$setDirty()},this.$setUntouched=function(){w.$touched=!1,w.$untouched=!0,s.setClass(a,"ng-untouched","ng-touched")},this.$setTouched=function(){w.$touched=!0,w.$untouched=!1,s.setClass(a,"ng-touched","ng-untouched")},this.$rollbackViewValue=function(){l.cancel(y),w.$viewValue=w.$$lastCommittedViewValue,w.$render()},this.$validate=function(){if(!_(w.$modelValue)||!isNaN(w.$modelValue)){var e=w.$$lastCommittedViewValue,t=w.$$rawModelValue,r=w.$valid,a=w.$modelValue,i=w.$options&&w.$options.allowInvalid;w.$$runValidators(t,e,function(e){i||r===e||(w.$modelValue=e?t:n,w.$modelValue!==a&&w.$$writeModelToScope())})}},this.$$runValidators=function(e,t,r){function a(e,t){s===C&&w.$setValidity(e,t)}function o(e){s===C&&r(e)}var s=++C;!function(){var e=w.$$parserName||"parse";return f!==n?(f||(i(w.$validators,function(e,t){a(t,null)}),i(w.$asyncValidators,function(e,t){a(t,null)})),a(e,f),f):(a(e,null),!0)}()?o(!1):function(){var n=!0;return i(w.$validators,function(r,i){var o=r(e,t);n=n&&o,a(i,o)}),!!n||(i(w.$asyncValidators,function(e,t){a(t,null)}),!1)}()?function(){var r=[],s=!0;i(w.$asyncValidators,function(i,o){var l=i(e,t);if(!O(l))throw Wi("$asyncValidators","Expected asynchronous validator to return a promise but got '{0}' instead.",l);a(o,n),r.push(l.then(function(){a(o,!0)},function(e){s=!1,a(o,!1)}))}),r.length?c.all(r).then(function(){o(s)},g):o(!0)}():o(!1)},this.$commitViewValue=function(){var e=w.$viewValue;l.cancel(y),(w.$$lastCommittedViewValue!==e||""===e&&w.$$hasNativeValidators)&&(w.$$lastCommittedViewValue=e,w.$pristine&&this.$setDirty(),this.$$parseAndValidate())},this.$$parseAndValidate=function(){function t(){w.$modelValue!==i&&w.$$writeModelToScope()}var r=w.$$lastCommittedViewValue;if(f=!b(r)||n)for(var a=0;a<w.$parsers.length;a++)if(r=w.$parsers[a](r),b(r)){f=!1;break}_(w.$modelValue)&&isNaN(w.$modelValue)&&(w.$modelValue=m(e));var i=w.$modelValue,o=w.$options&&w.$options.allowInvalid;w.$$rawModelValue=r,o&&(w.$modelValue=r,t()),w.$$runValidators(r,w.$$lastCommittedViewValue,function(e){o||(w.$modelValue=e?r:n,t())})},this.$$writeModelToScope=function(){v(e,w.$modelValue),i(w.$viewChangeListeners,function(e){try{e()}catch(e){t(e)}})},this.$setViewValue=function(e,t){w.$viewValue=e,w.$options&&!w.$options.updateOnDefault||w.$$debounceViewValueCommit(t)},this.$$debounceViewValueCommit=function(t){var n,r=0,a=w.$options;a&&x(a.debounce)&&(_(n=a.debounce)?r=n:_(n[t])?r=n[t]:_(n.default)&&(r=n.default)),l.cancel(y),r?y=l(function(){w.$commitViewValue()},r):u.$$phase?w.$commitViewValue():e.$apply(function(){w.$commitViewValue()})},e.$watch(function(){var t=m(e);if(t!==w.$modelValue&&(w.$modelValue===w.$modelValue||t===t)){w.$modelValue=w.$$rawModelValue=t,f=n;for(var r=w.$formatters,a=r.length,i=t;a--;)i=r[a](i);w.$viewValue!==i&&(w.$viewValue=w.$$lastCommittedViewValue=i,w.$render(),w.$$runValidators(t,i,g))}return t})}],Ji=["$rootScope",function(e){return{restrict:"A",require:["ngModel","^?form","^?ngModelOptions"],controller:Zi,priority:1,compile:function(t){return t.addClass(Hi).addClass("ng-untouched").addClass(zi),{pre:function(e,t,n,r){var a=r[0],i=r[1]||ui;a.$$setOptions(r[2]&&r[2].$options),i.$addControl(a),n.$observe("name",function(e){a.$name!==e&&i.$$renameControl(a,e)}),e.$on("$destroy",function(){i.$removeControl(a)})},post:function(t,n,r,a){var i=a[0];i.$options&&i.$options.updateOn&&n.on(i.$options.updateOn,function(e){i.$$debounceViewValueCommit(e&&e.type)}),n.on("blur",function(n){i.$touched||(e.$$phase?t.$evalAsync(i.$setTouched):t.$apply(i.$setTouched))})}}}}}],Xi=/(\s+|^)default(\s+|$)/,Qi=function(){return{restrict:"A",controller:["$scope","$attrs",function(e,t){var r=this;this.$options=R(e.$eval(t.ngModelOptions)),this.$options.updateOn!==n?(this.$options.updateOnDefault=!1,this.$options.updateOn=jr(this.$options.updateOn.replace(Xi,function(){return r.$options.updateOnDefault=!0," "}))):this.$options.updateOnDefault=!0}]}},Ki=Zn({terminal:!0,priority:1e3}),eo=r("ngOptions"),to=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+group\s+by\s+([\s\S]+?))?(?:\s+disable\s+when\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w]*)|(?:\(\s*([\$\w][\$\w]*)\s*,\s*([\$\w][\$\w]*)\s*\)))\s+in\s+([\s\S]+?)(?:\s+track\s+by\s+([\s\S]+?))?$/,no=["$compile","$parse",function(e,n){function r(e,t,r){function i(e,t,n,r,a){this.selectValue=e,this.viewValue=t,this.label=n,this.group=r,this.disabled=a}function o(e){var t;if(!u&&a(e))t=e;else{t=[];for(var n in e)e.hasOwnProperty(n)&&"$"!==n.charAt(0)&&t.push(n)}return t}var s=e.match(to);if(!s)throw eo("iexp","Expected expression in form of '_select_ (as _label_)? for (_key_,)?_value_ in _collection_' but got '{0}'. Element: {1}",e,Q(t));var l=s[5]||s[7],u=s[6],c=/ as /.test(s[0])&&s[1],d=s[9],f=n(s[2]?s[1]:l),p=c&&n(c)||f,h=d&&n(d),g=d?function(e,t){return h(r,t)}:function(e){return Ye(e)},m=function(e,t){return g(e,$(e,t))},v=n(s[2]||s[1]),y=n(s[3]||""),b=n(s[4]||""),x=n(s[8]),w={},$=u?function(e,t){return w[u]=t,w[l]=e,w}:function(e){return w[l]=e,w};return{trackBy:d,getTrackByValue:m,getWatchables:n(x,function(e){for(var t=[],n=o(e=e||[]),a=n.length,i=0;i<a;i++){var l=e===n?i:n[i],u=(e[l],$(e[l],l)),c=g(e[l],u);if(t.push(c),s[2]||s[1]){var d=v(r,u);t.push(d)}if(s[4]){var f=b(r,u);t.push(f)}}return t}),getOptions:function(){for(var e=[],t={},n=x(r)||[],a=o(n),s=a.length,l=0;l<s;l++){var u=n===a?l:a[l],c=$(n[u],u),f=p(r,c),h=g(f,c),w=new i(h,f,v(r,c),y(r,c),b(r,c));e.push(w),t[h]=w}return{items:e,selectValueMap:t,getOptionFromViewValue:function(e){return t[m(e)]},getViewValueFromOption:function(e){return d?Fr.copy(e.viewValue):e.viewValue}}}}}var o=t.createElement("option"),s=t.createElement("optgroup");return{restrict:"A",terminal:!0,require:["select","?ngModel"],link:function(t,n,a,l){function u(e,t){e.element=t,t.disabled=e.disabled,e.value!==t.value&&(t.value=e.selectValue),e.label!==t.label&&(t.label=e.label,t.textContent=e.label)}function c(e,t,n,r){var a;return t&&mr(t.nodeName)===n?a=t:(a=r.cloneNode(!1),t?e.insertBefore(a,t):e.appendChild(a)),a}function d(e){for(var t;e;)t=e.nextSibling,Re(e),e=t}function f(e){var t=g&&g[0],n=$&&$[0];if(t||n)for(;e&&(e===t||e===n);)e=e.nextSibling;return e}function p(){var e=C&&m.readValue();C=_.getOptions();var t={},r=n[0].firstChild;if(w&&n.prepend(g),r=f(r),C.items.forEach(function(e){var a,i,l;e.group?((a=t[e.group])||(i=c(n[0],r,"optgroup",s),r=i.nextSibling,i.label=e.group,a=t[e.group]={groupElement:i,currentOptionElement:i.firstChild}),u(e,l=c(a.groupElement,a.currentOptionElement,"option",o)),a.currentOptionElement=l.nextSibling):(u(e,l=c(n[0],r,"option",o)),r=l.nextSibling)}),Object.keys(t).forEach(function(e){d(t[e].currentOptionElement)}),d(r),h.$render(),!h.$isEmpty(e)){var a=m.readValue();(_.trackBy?U(e,a):e===a)||(h.$setViewValue(a),h.$render())}}var h=l[1];if(h){for(var g,m=l[0],v=a.multiple,y=0,b=n.children(),x=b.length;y<x;y++)if(""===b[y].value){g=b.eq(y);break}var w=!!g,$=$r(o.cloneNode(!1));$.val("?");var C,_=r(a.ngOptions,n,t),E=function(){w||n.prepend(g),n.val(""),g.prop("selected",!0),g.attr("selected",!0)},A=function(){w||g.remove()},k=function(){n.prepend($),n.val("?"),$.prop("selected",!0),$.attr("selected",!0)},S=function(){$.remove()};v?(h.$isEmpty=function(e){return!e||0===e.length},m.writeValue=function(e){C.items.forEach(function(e){e.element.selected=!1}),e&&e.forEach(function(e){var t=C.getOptionFromViewValue(e);t&&!t.disabled&&(t.element.selected=!0)})},m.readValue=function(){var e=[];return i(n.val()||[],function(t){var n=C.selectValueMap[t];n&&!n.disabled&&e.push(C.getViewValueFromOption(n))}),e},_.trackBy&&t.$watchCollection(function(){if(Or(h.$viewValue))return h.$viewValue.map(function(e){return _.getTrackByValue(e)})},function(){h.$render()})):(m.writeValue=function(e){var t=C.getOptionFromViewValue(e);t&&!t.disabled?n[0].value!==t.selectValue&&(S(),A(),n[0].value=t.selectValue,t.element.selected=!0,t.element.setAttribute("selected","selected")):null===e||w?(S(),E()):(A(),k())},m.readValue=function(){var e=C.selectValueMap[n.val()];return e&&!e.disabled?(A(),S(),C.getViewValueFromOption(e)):null},_.trackBy&&t.$watch(function(){return _.getTrackByValue(h.$viewValue)},function(){h.$render()})),w?(g.remove(),e(g)(t),g.removeClass("ng-scope")):g=$r(o.cloneNode(!1)),p(),t.$watchCollection(_.getWatchables,p)}}}}],ro=["$locale","$interpolate","$log",function(e,t,n){var r=/{}/g,a=/^when(Minus)?(.+)$/;return{link:function(o,s,l){function u(e){s.text(e||"")}var c,d=l.count,f=l.$attr.when&&s.attr(l.$attr.when),p=l.offset||0,h=o.$eval(f)||{},m={},v=t.startSymbol(),y=t.endSymbol(),x=v+d+"-"+p+y,w=Fr.noop;i(l,function(e,t){var n=a.exec(t);if(n){var r=(n[1]?"-":"")+mr(n[2]);h[r]=s.attr(l.$attr[t])}}),i(h,function(e,n){m[n]=t(e.replace(r,x))}),o.$watch(d,function(t){var r=parseFloat(t),a=isNaN(r);if(a||r in h||(r=e.pluralCat(r-p)),r!==c&&!(a&&_(c)&&isNaN(c))){w();var i=m[r];b(i)?(null!=t&&n.debug("ngPluralize: no rule defined for '"+r+"' in "+f),w=g,u()):w=o.$watch(i,u),c=r}})}}}],ao=["$parse","$animate",function(e,o){var s=r("ngRepeat"),l=function(e,t,n,r,a,i,o){e[n]=r,a&&(e[a]=i),e.$index=t,e.$first=0===t,e.$last=t===o-1,e.$middle=!(e.$first||e.$last),e.$odd=!(e.$even=0==(1&t))},u=function(e){return e.clone[0]},c=function(e){return e.clone[e.clone.length-1]};return{restrict:"A",multiElement:!0,transclude:"element",priority:1e3,terminal:!0,$$tlb:!0,compile:function(r,d){var f=d.ngRepeat,p=t.createComment(" end ngRepeat: "+f+" "),h=f.match(/^\s*([\s\S]+?)\s+in\s+([\s\S]+?)(?:\s+as\s+([\s\S]+?))?(?:\s+track\s+by\s+([\s\S]+?))?\s*$/);if(!h)throw s("iexp","Expected expression in form of '_item_ in _collection_[ track by _id_]' but got '{0}'.",f);var g=h[1],m=h[2],v=h[3],y=h[4];if(!(h=g.match(/^(?:(\s*[\$\w]+)|\(\s*([\$\w]+)\s*,\s*([\$\w]+)\s*\))$/)))throw s("iidexp","'_item_' in '_item_ in _collection_' should be an identifier or '(_key_, _value_)' expression, but got '{0}'.",g);var b=h[3]||h[1],x=h[2];if(v&&(!/^[$a-zA-Z_][$a-zA-Z0-9_]*$/.test(v)||/^(null|undefined|this|\$index|\$first|\$middle|\$last|\$even|\$odd|\$parent|\$root|\$id)$/.test(v)))throw s("badident","alias '{0}' is invalid --- must be a valid JS identifier which is not a reserved name.",v);var w,$,C,_,E={$id:Ye};return y?w=e(y):(C=function(e,t){return Ye(t)},_=function(e){return e}),function(e,t,r,d,h){w&&($=function(t,n,r){return x&&(E[x]=t),E[b]=n,E.$index=r,w(e,E)});var g=ge();e.$watchCollection(m,function(r){var d,m,y,w,E,A,k,S,D,T,F,M,L=t[0],O=ge();if(v&&(e[v]=r),a(r))D=r,S=$||C;else{S=$||_,D=[];for(var N in r)r.hasOwnProperty(N)&&"$"!==N.charAt(0)&&D.push(N)}for(w=D.length,F=new Array(w),d=0;d<w;d++)if(E=r===D?d:D[d],A=r[E],k=S(E,A,d),g[k])T=g[k],delete g[k],O[k]=T,F[d]=T;else{if(O[k])throw i(F,function(e){e&&e.scope&&(g[e.id]=e)}),s("dupes","Duplicates in a repeater are not allowed. Use 'track by' expression to specify unique keys. Repeater: {0}, Duplicate key: {1}, Duplicate value: {2}",f,k,A);F[d]={id:k,scope:n,clone:n},O[k]=!0}for(var j in g){if(T=g[j],M=he(T.clone),o.leave(M),M[0].parentNode)for(d=0,m=M.length;d<m;d++)M[d].$$NG_REMOVED=!0;T.scope.$destroy()}for(d=0;d<w;d++)if(E=r===D?d:D[d],A=r[E],(T=F[d]).scope){y=L;do{y=y.nextSibling}while(y&&y.$$NG_REMOVED);u(T)!=y&&o.move(he(T.clone),null,$r(L)),L=c(T),l(T.scope,d,b,A,x,E,w)}else h(function(e,t){T.scope=t;var n=p.cloneNode(!1);e[e.length++]=n,o.enter(e,null,$r(L)),L=n,T.clone=e,O[T.id]=T,l(T.scope,d,b,A,x,E,w)});g=O})}}}}],io=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,r){t.$watch(r.ngShow,function(t){e[t?"removeClass":"addClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],oo=["$animate",function(e){return{restrict:"A",multiElement:!0,link:function(t,n,r){t.$watch(r.ngHide,function(t){e[t?"addClass":"removeClass"](n,"ng-hide",{tempClasses:"ng-hide-animate"})})}}}],so=Zn(function(e,t,n){e.$watch(n.ngStyle,function(e,n){n&&e!==n&&i(n,function(e,n){t.css(n,"")}),e&&t.css(e)},!0)}),lo=["$animate",function(e){return{require:"ngSwitch",controller:["$scope",function(){this.cases={}}],link:function(n,r,a,o){var s=a.ngSwitch||a.on,l=[],u=[],c=[],d=[],f=function(e,t){return function(){e.splice(t,1)}};n.$watch(s,function(n){var r,a;for(r=0,a=c.length;r<a;++r)e.cancel(c[r]);for(c.length=0,r=0,a=d.length;r<a;++r){var s=he(u[r].clone);d[r].$destroy(),(c[r]=e.leave(s)).then(f(c,r))}u.length=0,d.length=0,(l=o.cases["!"+n]||o.cases["?"])&&i(l,function(n){n.transclude(function(r,a){d.push(a);var i=n.element;r[r.length++]=t.createComment(" end ngSwitchWhen: ");var o={clone:r};u.push(o),e.enter(r,i.parent(),i)})})})}}}],uo=Zn({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,r,a){r.cases["!"+n.ngSwitchWhen]=r.cases["!"+n.ngSwitchWhen]||[],r.cases["!"+n.ngSwitchWhen].push({transclude:a,element:t})}}),co=Zn({transclude:"element",priority:1200,require:"^ngSwitch",multiElement:!0,link:function(e,t,n,r,a){r.cases["?"]=r.cases["?"]||[],r.cases["?"].push({transclude:a,element:t})}}),fo=Zn({restrict:"EAC",link:function(e,t,n,a,i){if(!i)throw r("ngTransclude")("orphan","Illegal use of ngTransclude directive in the template! No parent directive that requires a transclusion found. Element: {0}",Q(t));i(function(e){t.empty(),t.append(e)})}}),po=["$templateCache",function(e){return{restrict:"E",terminal:!0,compile:function(t,n){if("text/ng-template"==n.type){var r=n.id,a=t[0].text;e.put(r,a)}}}}],ho={$setViewValue:g,$render:g},go=["$element","$scope","$attrs",function(e,r,a){var i=this,o=new Ge;i.ngModelCtrl=ho,i.unknownOption=$r(t.createElement("option")),i.renderUnknownOption=function(t){var n="? "+Ye(t)+" ?";i.unknownOption.val(n),e.prepend(i.unknownOption),e.val(n)},r.$on("$destroy",function(){i.renderUnknownOption=g}),i.removeUnknownOption=function(){i.unknownOption.parent()&&i.unknownOption.remove()},i.readValue=function(){return i.removeUnknownOption(),e.val()},i.writeValue=function(t){i.hasOption(t)?(i.removeUnknownOption(),e.val(t),""===t&&i.emptyOption.prop("selected",!0)):null==t&&i.emptyOption?(i.removeUnknownOption(),e.val("")):i.renderUnknownOption(t)},i.addOption=function(e,t){fe(e,'"option value"'),""===e&&(i.emptyOption=t);var n=o.get(e)||0;o.put(e,n+1)},i.removeOption=function(e){var t=o.get(e);t&&(1===t?(o.remove(e),""===e&&(i.emptyOption=n)):o.put(e,t-1))},i.hasOption=function(e){return!!o.get(e)}}],mo=function(){return{restrict:"E",require:["select","?ngModel"],controller:go,link:function(e,t,n,r){var a=r[1];if(a){var o=r[0];if(o.ngModelCtrl=a,a.$render=function(){o.writeValue(a.$viewValue)},t.on("change",function(){e.$apply(function(){a.$setViewValue(o.readValue())})}),n.multiple){o.readValue=function(){var e=[];return i(t.find("option"),function(t){t.selected&&e.push(t.value)}),e},o.writeValue=function(e){var n=new Ge(e);i(t.find("option"),function(e){e.selected=x(n.get(e.value))})};var s,l=NaN;e.$watch(function(){l!==a.$viewValue||U(s,a.$viewValue)||(s=I(a.$viewValue),a.$render()),l=a.$viewValue}),a.$isEmpty=function(e){return!e||0===e.length}}}}}},vo=["$interpolate",function(e){function t(e){e[0].hasAttribute("selected")&&(e[0].selected=!0)}return{restrict:"E",priority:100,compile:function(n,r){if(b(r.value)){var a=e(n.text(),!0);a||r.$set("value",n.text())}return function(e,n,r){var i=n.parent(),o=i.data("$selectController")||i.parent().data("$selectController");o&&o.ngModelCtrl&&(a?e.$watch(a,function(e,a){r.$set("value",e),a!==e&&o.removeOption(a),o.addOption(e,n),o.ngModelCtrl.$render(),t(n)}):(o.addOption(r.value,n),o.ngModelCtrl.$render(),t(n)),n.on("$destroy",function(){o.removeOption(r.value),o.ngModelCtrl.$render()}))}}}}],yo=v({restrict:"E",terminal:!1}),bo=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){r&&(n.required=!0,r.$validators.required=function(e,t){return!n.required||!r.$isEmpty(t)},n.$observe("required",function(){r.$validate()}))}}},xo=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,a,i){if(i){var o,s=a.ngPattern||a.pattern;a.$observe("pattern",function(e){if(C(e)&&e.length>0&&(e=new RegExp("^"+e+"$")),e&&!e.test)throw r("ngPattern")("noregexp","Expected {0} to be a RegExp but was {1}. Element: {2}",s,e,Q(t));o=e||n,i.$validate()}),i.$validators.pattern=function(e){return i.$isEmpty(e)||b(o)||o.test(e)}}}}},wo=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var a=-1;n.$observe("maxlength",function(e){var t=p(e);a=isNaN(t)?-1:t,r.$validate()}),r.$validators.maxlength=function(e,t){return a<0||r.$isEmpty(t)||t.length<=a}}}}},$o=function(){return{restrict:"A",require:"?ngModel",link:function(e,t,n,r){if(r){var a=0;n.$observe("minlength",function(e){a=p(e)||0,r.$validate()}),r.$validators.minlength=function(e,t){return r.$isEmpty(t)||t.length>=a}}}}};e.angular.bootstrap?console.log("WARNING: Tried to load angular more than once."):(!function(){var t;if(!Ur){var r=qr();Cr=e.jQuery,x(r)&&(Cr=null===r?n:e[r]),Cr&&Cr.fn.on?($r=Cr,d(Cr.fn,{scope:la.scope,isolateScope:la.isolateScope,controller:la.controller,injector:la.injector,inheritedData:la.inheritedData}),t=Cr.cleanData,Cr.cleanData=function(e){var n;if(Lr)Lr=!1;else for(var r,a=0;null!=(r=e[a]);a++)(n=Cr._data(r,"events"))&&n.$destroy&&Cr(r).triggerHandler("$destroy");t(e)}):$r=Ae,Fr.element=$r,Ur=!0}}(),function(t){d(t,{bootstrap:oe,copy:R,extend:d,merge:f,equals:U,element:$r,forEach:i,injector:Je,noop:g,bind:H,toJson:G,fromJson:W,identity:m,isUndefined:b,isDefined:x,isString:C,isFunction:A,isObject:w,isNumber:_,isElement:j,isArray:Or,version:Wr,isDate:E,lowercase:mr,uppercase:yr,callbacks:{counter:0},getTestability:le,$$minErr:r,$$csp:Br,reloadWithDebugInfo:se}),(_r=me(e))("ng",["ngLocale"],["$provide",function(e){e.provider({$$sanitizeUri:pn}),e.provider("$compile",ot).directive({a:si,input:_i,textarea:_i,form:fi,script:po,select:mo,style:yo,option:vo,ngBind:ki,ngBindHtml:Di,ngBindTemplate:Si,ngClass:Fi,ngClassEven:Li,ngClassOdd:Mi,ngCloak:Oi,ngController:Ni,ngForm:pi,ngHide:oo,ngIf:Bi,ngInclude:qi,ngInit:Ii,ngNonBindable:Ki,ngPluralize:ro,ngRepeat:ao,ngShow:io,ngStyle:so,ngSwitch:lo,ngSwitchWhen:uo,ngSwitchDefault:co,ngOptions:no,ngTransclude:fo,ngModel:Ji,ngList:Ui,ngChange:Ti,pattern:xo,ngPattern:xo,required:bo,ngRequired:bo,minlength:$o,ngMinlength:$o,maxlength:wo,ngMaxlength:wo,ngValue:Ai,ngModelOptions:Qi}).directive({ngInclude:Ri}).directive(li).directive(ji),e.provider({$anchorScroll:Xe,$animate:$a,$animateCss:Ca,$$animateQueue:wa,$$AnimateRunner:xa,$browser:rt,$cacheFactory:at,$controller:dt,$document:ft,$exceptionHandler:pt,$filter:kn,$$forceReflow:Sa,$interpolate:kt,$interval:St,$http:Ct,$httpParamSerializer:gt,$httpParamSerializerJQLike:mt,$httpBackend:Et,$location:Ut,$log:zt,$parse:sn,$rootScope:fn,$q:ln,$$q:un,$sce:vn,$sceDelegate:mn,$sniffer:yn,$templateCache:it,$templateRequest:bn,$$testability:xn,$timeout:wn,$window:_n,$$rAF:dn,$$jqLite:He,$$HashMap:fa,$$cookieReader:An})}])}(Fr),Fr.module("ngLocale",[],["$provide",function(e){function t(e){var t=(e+="").indexOf(".");return-1==t?0:e.length-t-1}function r(e,r){var a=r;n===a&&(a=Math.min(t(e),3));var i=Math.pow(10,a);return{v:a,f:(e*i|0)%i}}var a={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};e.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ERANAMES:["Before Christ","Anno Domini"],ERAS:["BC","AD"],FIRSTDAYOFWEEK:6,MONTH:["January","February","March","April","May","June","July","August","September","October","November","December"],SHORTDAY:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],SHORTMONTH:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],WEEKENDRANGE:[5,6],fullDate:"EEEE, MMMM d, y",longDate:"MMMM d, y",medium:"MMM d, y h:mm:ss a",mediumDate:"MMM d, y",mediumTime:"h:mm:ss a",short:"M/d/yy h:mm a",shortDate:"M/d/yy",shortTime:"h:mm a"},NUMBER_FORMATS:{CURRENCY_SYM:"$",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""}]},id:"en-us",pluralCat:function(e,t){var n=0|e,i=r(e,t);return 1==n&&0==i.v?a.ONE:a.OTHER}})}]),$r(t).ready(function(){ie(t,oe)}))}(window,document),!window.angular.$$csp().noInlineStyle&&window.angular.element(document.head).prepend('<style type="text/css">@charset "UTF-8";[ng\\:cloak],[ng-cloak],[data-ng-cloak],[x-ng-cloak],.ng-cloak,.x-ng-cloak,.ng-hide:not(.ng-hide-animate){display:none !important;}ng\\:form{display:block;}.ng-animate-shim{visibility:hidden;}.ng-anchor{position:absolute;}</style>'),function(e,t){"use strict";function n(){function n(e,t){var n,r={},a=e.split(",");for(n=0;n<a.length;n++)r[t?l(a[n]):a[n]]=!0;return r}function r(t,n){null===t||void 0===t?t="":"string"!=typeof t&&(t=""+t),x.innerHTML=t;var r=5;do{if(0===r)throw p("uinput","Failed to sanitize html because the input is unstable");r--,e.document.documentMode&&v(x),t=x.innerHTML,x.innerHTML=t}while(t!==x.innerHTML);for(var a=x.firstChild;a;){switch(a.nodeType){case 1:n.start(a.nodeName.toLowerCase(),h(a.attributes));break;case 3:n.chars(a.textContent)}var i;if(!((i=a.firstChild)||(1===a.nodeType&&n.end(a.nodeName.toLowerCase()),i=y("nextSibling",a))))for(;null==i&&(a=y("parentNode",a))!==x;)i=y("nextSibling",a),1===a.nodeType&&n.end(a.nodeName.toLowerCase());a=i}for(;a=x.firstChild;)x.removeChild(a)}function h(e){for(var t={},n=0,r=e.length;n<r;n++){var a=e[n];t[a.name]=a.value}return t}function g(e){return e.replace(/&/g,"&amp;").replace(w,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace($,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(e,t){var n=!1,r=a(e,e.push);return{start:function(e,a){e=l(e),!n&&T[e]&&(n=e),n||!0!==F[e]||(r("<"),r(e),o(a,function(n,a){var i=l(a),o="img"===e&&"src"===i||"background"===i;!0!==N[i]||!0===M[i]&&!t(n,o)||(r(" "),r(a),r('="'),r(g(n)),r('"'))}),r(">"))},end:function(e){e=l(e),n||!0!==F[e]||!0===C[e]||(r("</"),r(e),r(">")),e==n&&(n=!1)},chars:function(e){n||r(g(e))}}}function v(t){for(;t;){if(t.nodeType===e.Node.ELEMENT_NODE)for(var n=t.attributes,r=0,a=n.length;r<a;r++){var i=n[r],o=i.name.toLowerCase();"xmlns:ns1"!==o&&0!==o.lastIndexOf("ns1:",0)||(t.removeAttributeNode(i),r--,a--)}var s=t.firstChild;s&&v(s),t=y("nextSibling",t)}}function y(e,t){var n=t[e];if(n&&c.call(t,n))throw p("elclob","Failed to sanitize html because the element is clobbered: {0}",t.outerHTML||t.outerText);return n}var b=!1;this.$get=["$$sanitizeUri",function(e){return b&&i(F,D),function(t){var n=[];return d(t,f(n,function(t,n){return!/^unsafe:/.test(e(t,n))})),n.join("")}}],this.enableSvg=function(e){return s(e)?(b=e,this):b},a=t.bind,i=t.extend,o=t.forEach,s=t.isDefined,l=t.lowercase,u=t.noop,d=r,f=m,c=e.Node.prototype.contains||function(e){return!!(16&this.compareDocumentPosition(e))};var x,w=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,$=/([^#-~ |!])/g,C=n("area,br,col,hr,img,wbr"),_=n("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),E=n("rp,rt"),A=i({},E,_),k=i({},_,n("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),S=i({},E,n("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),D=n("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),T=n("script,style"),F=i({},C,k,S,A),M=n("background,cite,href,longdesc,src,xlink:href"),L=n("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),O=n("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),N=i({},M,O,L);!function(e){var t;if(!e.document||!e.document.implementation)throw p("noinert","Can't create an inert html document");var n=((t=e.document.implementation.createHTMLDocument("inert")).documentElement||t.getDocumentElement()).getElementsByTagName("body");if(1===n.length)x=n[0];else{var r=t.createElement("html");x=t.createElement("body"),r.appendChild(x),t.appendChild(r)}}(e)}function r(e){var t=[];return f(t,u).chars(e),t.join("")}var a,i,o,s,l,u,c,d,f,p=t.$$minErr("$sanitize");t.module("ngSanitize",[]).provider("$sanitize",n).info({angularVersion:"1.6.4"}),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,a=/^mailto:/i,i=t.$$minErr("linky"),o=t.isDefined,s=t.isFunction,l=t.isObject,u=t.isString;return function(t,c,d){function f(e){e&&y.push(r(e))}if(null==t||""===t)return t;if(!u(t))throw i("notstring","Expected string but received: {0}",t);for(var p,h,g,m=s(d)?d:l(d)?function(){return d}:function(){return{}},v=t,y=[];p=v.match(n);)h=p[0],p[2]||p[4]||(h=(p[3]?"http://":"mailto:")+h),g=p.index,f(v.substr(0,g)),function(e,t){var n,r=m(e);y.push("<a ");for(n in r)y.push(n+'="'+r[n]+'" ');!o(c)||"target"in r||y.push('target="',c,'" '),y.push('href="',e.replace(/"/g,"&quot;"),'">'),f(t),y.push("</a>")}(h,p[0].replace(a,"")),v=v.substring(g+p[0].length);return f(v),e(y.join(""))}}])}(window,window.angular),function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){function n(e){var t="length"in e&&e.length,n=Q.type(e);return"function"!==n&&!Q.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e))}function r(e,t,n){if(Q.isFunction(t))return Q.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return Q.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(oe.test(t))return Q.filter(t,e,n);t=Q.filter(t,e)}return Q.grep(e,function(e){return Y.call(t,e)>=0!==n})}function a(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function i(e){var t=fe[e]={};return Q.each(e.match(de)||[],function(e,n){t[n]=!0}),t}function o(){X.removeEventListener("DOMContentLoaded",o,!1),e.removeEventListener("load",o,!1),Q.ready()}function s(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Q.expando+s.uid++}function l(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(ye,"-$1").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:ve.test(n)?Q.parseJSON(n):n)}catch(e){}me.set(e,t,n)}else n=void 0;return n}function u(){return!0}function c(){return!1}function d(){try{return X.activeElement}catch(e){}}function f(e,t){return Q.nodeName(e,"table")&&Q.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function p(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function h(e){var t=Le.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function g(e,t){for(var n=0,r=e.length;n<r;n++)ge.set(e[n],"globalEval",!t||ge.get(t[n],"globalEval"))}function m(e,t){var n,r,a,i,o,s,l,u;if(1===t.nodeType){if(ge.hasData(e)&&(i=ge.access(e),o=ge.set(t,i),u=i.events)){delete o.handle,o.events={};for(a in u)for(n=0,r=u[a].length;n<r;n++)Q.event.add(t,a,u[a][n])}me.hasData(e)&&(s=me.access(e),l=Q.extend({},s),me.set(t,l))}}function v(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&Q.nodeName(e,t)?Q.merge([e],n):n}function y(e,t){var n=t.nodeName.toLowerCase();"input"===n&&$e.test(e.type)?t.checked=e.checked:"input"!==n&&"textarea"!==n||(t.defaultValue=e.defaultValue)}function b(t,n){var r,a=Q(n.createElement(t)).appendTo(n.body),i=e.getDefaultComputedStyle&&(r=e.getDefaultComputedStyle(a[0]))?r.display:Q.css(a[0],"display");return a.detach(),i}function x(e){var t=X,n=Pe[e];return n||("none"!==(n=b(e,t))&&n||((t=(je=(je||Q("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),n=b(e,t),je.detach()),Pe[e]=n),n}function w(e,t,n){var r,a,i,o,s=e.style;return(n=n||Re(e))&&(o=n.getPropertyValue(t)||n[t]),n&&(""!==o||Q.contains(e.ownerDocument,e)||(o=Q.style(e,t)),qe.test(o)&&Be.test(t)&&(r=s.width,a=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=n.width,s.width=r,s.minWidth=a,s.maxWidth=i)),void 0!==o?o+"":o}function $(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}function C(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),r=t,a=Ye.length;a--;)if((t=Ye[a]+n)in e)return t;return r}function _(e,t,n){var r=Ue.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function E(e,t,n,r,a){for(var i=n===(r?"border":"content")?4:"width"===t?1:0,o=0;i<4;i+=2)"margin"===n&&(o+=Q.css(e,n+xe[i],!0,a)),r?("content"===n&&(o-=Q.css(e,"padding"+xe[i],!0,a)),"margin"!==n&&(o-=Q.css(e,"border"+xe[i]+"Width",!0,a))):(o+=Q.css(e,"padding"+xe[i],!0,a),"padding"!==n&&(o+=Q.css(e,"border"+xe[i]+"Width",!0,a)));return o}function A(e,t,n){var r=!0,a="width"===t?e.offsetWidth:e.offsetHeight,i=Re(e),o="border-box"===Q.css(e,"boxSizing",!1,i);if(a<=0||null==a){if(((a=w(e,t,i))<0||null==a)&&(a=e.style[t]),qe.test(a))return a;r=o&&(J.boxSizingReliable()||a===e.style[t]),a=parseFloat(a)||0}return a+E(e,t,n||(o?"border":"content"),r,i)+"px"}function k(e,t){for(var n,r,a,i=[],o=0,s=e.length;o<s;o++)(r=e[o]).style&&(i[o]=ge.get(r,"olddisplay"),n=r.style.display,t?(i[o]||"none"!==n||(r.style.display=""),""===r.style.display&&we(r)&&(i[o]=ge.access(r,"olddisplay",x(r.nodeName)))):(a=we(r),"none"===n&&a||ge.set(r,"olddisplay",a?n:Q.css(r,"display"))));for(o=0;o<s;o++)(r=e[o]).style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?i[o]||"":"none"));return e}function S(e,t,n,r,a){return new S.prototype.init(e,t,n,r,a)}function D(){return setTimeout(function(){Ge=void 0}),Ge=Q.now()}function T(e,t){var n,r=0,a={height:e};for(t=t?1:0;r<4;r+=2-t)a["margin"+(n=xe[r])]=a["padding"+n]=e;return t&&(a.opacity=a.width=e),a}function F(e,t,n){for(var r,a=(Ke[t]||[]).concat(Ke["*"]),i=0,o=a.length;i<o;i++)if(r=a[i].call(n,t,e))return r}function M(e,t,n){var r,a,i,o,s,l,u,c=this,d={},f=e.style,p=e.nodeType&&we(e),h=ge.get(e,"fxshow");n.queue||(null==(s=Q._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,c.always(function(){c.always(function(){s.unqueued--,Q.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],"inline"===("none"===(u=Q.css(e,"display"))?ge.get(e,"olddisplay")||x(e.nodeName):u)&&"none"===Q.css(e,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",c.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(r in t)if(a=t[r],Ze.exec(a)){if(delete t[r],i=i||"toggle"===a,a===(p?"hide":"show")){if("show"!==a||!h||void 0===h[r])continue;p=!0}d[r]=h&&h[r]||Q.style(e,r)}else u=void 0;if(Q.isEmptyObject(d))"inline"===("none"===u?x(e.nodeName):u)&&(f.display=u);else{h?"hidden"in h&&(p=h.hidden):h=ge.access(e,"fxshow",{}),i&&(h.hidden=!p),p?Q(e).show():c.done(function(){Q(e).hide()}),c.done(function(){var t;ge.remove(e,"fxshow");for(t in d)Q.style(e,t,d[t])});for(r in d)o=F(p?h[r]:0,r,c),r in h||(h[r]=o.start,p&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function L(e,t){var n,r,a,i,o;for(n in e)if(r=Q.camelCase(n),a=t[r],i=e[n],Q.isArray(i)&&(a=i[1],i=e[n]=i[0]),n!==r&&(e[r]=i,delete e[n]),(o=Q.cssHooks[r])&&"expand"in o){i=o.expand(i),delete e[r];for(n in i)n in e||(e[n]=i[n],t[n]=a)}else t[r]=a}function O(e,t,n){var r,a,i=0,o=Qe.length,s=Q.Deferred().always(function(){delete l.elem}),l=function(){if(a)return!1;for(var t=Ge||D(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),i=0,o=u.tweens.length;i<o;i++)u.tweens[i].run(r);return s.notifyWith(e,[u,r,n]),r<1&&o?n:(s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:Q.extend({},t),opts:Q.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Ge||D(),duration:n.duration,tweens:[],createTween:function(t,n){var r=Q.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(a)return this;for(a=!0;n<r;n++)u.tweens[n].run(1);return t?s.resolveWith(e,[u,t]):s.rejectWith(e,[u,t]),this}}),c=u.props;for(L(c,u.opts.specialEasing);i<o;i++)if(r=Qe[i].call(u,e,c,u.opts))return r;return Q.map(c,F,u),Q.isFunction(u.opts.start)&&u.opts.start.call(e,u),Q.fx.timer(Q.extend(l,{elem:e,anim:u,queue:u.opts.queue})),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always)}function N(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,a=0,i=t.toLowerCase().match(de)||[];if(Q.isFunction(n))for(;r=i[a++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function j(e,t,n,r){function a(s){var l;return i[s]=!0,Q.each(e[s]||[],function(e,s){var u=s(t,n,r);return"string"!=typeof u||o||i[u]?o?!(l=u):void 0:(t.dataTypes.unshift(u),a(u),!1)}),l}var i={},o=e===gt;return a(t.dataTypes[0])||!i["*"]&&a("*")}function P(e,t){var n,r,a=Q.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((a[n]?e:r||(r={}))[n]=t[n]);return r&&Q.extend(!0,e,r),e}function B(e,t,n){for(var r,a,i,o,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){l.unshift(a);break}if(l[0]in n)i=l[0];else{for(a in n){if(!l[0]||e.converters[a+" "+l[0]]){i=a;break}o||(o=a)}i=i||o}if(i)return i!==l[0]&&l.unshift(i),n[i]}function q(e,t,n,r){var a,i,o,s,l,u={},c=e.dataTypes.slice();if(c[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(i=c.shift();i;)if(e.responseFields[i]&&(n[e.responseFields[i]]=t),!l&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=i,i=c.shift())if("*"===i)i=l;else if("*"!==l&&l!==i){if(!(o=u[l+" "+i]||u["* "+i]))for(a in u)if((s=a.split(" "))[1]===i&&(o=u[l+" "+s[0]]||u["* "+s[0]])){!0===o?o=u[a]:!0!==u[a]&&(i=s[0],c.unshift(s[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+l+" to "+i}}}return{state:"success",data:t}}function R(e,t,n,r){var a;if(Q.isArray(t))Q.each(t,function(t,a){n||xt.test(e)?r(e,a):R(e+"["+("object"==typeof a?t:"")+"]",a,n,r)});else if(n||"object"!==Q.type(t))r(e,t);else for(a in t)R(e+"["+a+"]",t[a],n,r)}function I(e){return Q.isWindow(e)?e:9===e.nodeType&&e.defaultView}var U=[],z=U.slice,V=U.concat,H=U.push,Y=U.indexOf,G={},W=G.toString,Z=G.hasOwnProperty,J={},X=e.document,Q=function(e,t){return new Q.fn.init(e,t)},K=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,ee=/^-ms-/,te=/-([\da-z])/gi,ne=function(e,t){return t.toUpperCase()};Q.fn=Q.prototype={jquery:"2.1.4",constructor:Q,selector:"",length:0,toArray:function(){return z.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:z.call(this)},pushStack:function(e){var t=Q.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return Q.each(this,e,t)},map:function(e){return this.pushStack(Q.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(z.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:H,sort:U.sort,splice:U.splice},Q.extend=Q.fn.extend=function(){var e,t,n,r,a,i,o=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"==typeof o||Q.isFunction(o)||(o={}),s===l&&(o=this,s--);s<l;s++)if(null!=(e=arguments[s]))for(t in e)n=o[t],o!==(r=e[t])&&(u&&r&&(Q.isPlainObject(r)||(a=Q.isArray(r)))?(a?(a=!1,i=n&&Q.isArray(n)?n:[]):i=n&&Q.isPlainObject(n)?n:{},o[t]=Q.extend(u,i,r)):void 0!==r&&(o[t]=r));return o},Q.extend({expando:"jQuery"+("2.1.4"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===Q.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!Q.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"===Q.type(e)&&!e.nodeType&&!Q.isWindow(e)&&!(e.constructor&&!Z.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?G[W.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;(e=Q.trim(e))&&(1===e.indexOf("use strict")?((t=X.createElement("script")).text=e,X.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(ee,"ms-").replace(te,ne)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,r){var a=0,i=e.length,o=n(e);if(r){if(o)for(;a<i&&!1!==t.apply(e[a],r);a++);else for(a in e)if(!1===t.apply(e[a],r))break}else if(o)for(;a<i&&!1!==t.call(e[a],a,e[a]);a++);else for(a in e)if(!1===t.call(e[a],a,e[a]))break;return e},trim:function(e){return null==e?"":(e+"").replace(K,"")},makeArray:function(e,t){var r=t||[];return null!=e&&(n(Object(e))?Q.merge(r,"string"==typeof e?[e]:e):H.call(r,e)),r},inArray:function(e,t,n){return null==t?-1:Y.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,a=e.length;r<n;r++)e[a++]=t[r];return e.length=a,e},grep:function(e,t,n){for(var r=[],a=0,i=e.length,o=!n;a<i;a++)!t(e[a],a)!==o&&r.push(e[a]);return r},map:function(e,t,r){var a,i=0,o=e.length,s=[];if(n(e))for(;i<o;i++)null!=(a=t(e[i],i,r))&&s.push(a);else for(i in e)null!=(a=t(e[i],i,r))&&s.push(a);return V.apply([],s)},guid:1,proxy:function(e,t){var n,r,a;if("string"==typeof t&&(n=e[t],t=e,e=n),Q.isFunction(e))return r=z.call(arguments,2),a=function(){return e.apply(t||this,r.concat(z.call(arguments)))},a.guid=e.guid=e.guid||Q.guid++,a},now:Date.now,support:J}),Q.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){G["[object "+t+"]"]=t.toLowerCase()});var re=function(e){function t(e,t,n,r){var a,i,o,s,u,d,f,p,h,g;if((t?t.ownerDocument||t:B)!==T&&D(t),t=t||T,n=n||[],s=t.nodeType,"string"!=typeof e||!e||1!==s&&9!==s&&11!==s)return n;if(!r&&M){if(11!==s&&(a=me.exec(e)))if(o=a[1]){if(9===s){if(!(i=t.getElementById(o))||!i.parentNode)return n;if(i.id===o)return n.push(i),n}else if(t.ownerDocument&&(i=t.ownerDocument.getElementById(o))&&j(t,i)&&i.id===o)return n.push(i),n}else{if(a[2])return J.apply(n,t.getElementsByTagName(e)),n;if((o=a[3])&&b.getElementsByClassName)return J.apply(n,t.getElementsByClassName(o)),n}if(b.qsa&&(!L||!L.test(e))){if(p=f=P,h=t,g=1!==s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(d=C(e),(f=t.getAttribute("id"))?p=f.replace(ye,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",u=d.length;u--;)d[u]=p+c(d[u]);h=ve.test(e)&&l(t.parentNode)||t,g=d.join(",")}if(g)try{return J.apply(n,h.querySelectorAll(g)),n}catch(e){}finally{f||t.removeAttribute("id")}}}return E(e.replace(oe,"$1"),t,n,r)}function n(){function e(n,r){return t.push(n+" ")>x.cacheLength&&delete e[t.shift()],e[n+" "]=r}var t=[];return e}function r(e){return e[P]=!0,e}function a(e){var t=T.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function i(e,t){for(var n=e.split("|"),r=e.length;r--;)x.attrHandle[n[r]]=t}function o(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||H)-(~e.sourceIndex||H);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return r(function(t){return t=+t,r(function(n,r){for(var a,i=e([],n.length,t),o=i.length;o--;)n[a=i[o]]&&(n[a]=!(r[a]=n[a]))})})}function l(e){return e&&void 0!==e.getElementsByTagName&&e}function u(){}function c(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function d(e,t,n){var r=t.dir,a=n&&"parentNode"===r,i=R++;return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||a)return e(t,n,i)}:function(t,n,o){var s,l,u=[q,i];if(o){for(;t=t[r];)if((1===t.nodeType||a)&&e(t,n,o))return!0}else for(;t=t[r];)if(1===t.nodeType||a){if(l=t[P]||(t[P]={}),(s=l[r])&&s[0]===q&&s[1]===i)return u[2]=s[2];if(l[r]=u,u[2]=e(t,n,o))return!0}}}function f(e){return e.length>1?function(t,n,r){for(var a=e.length;a--;)if(!e[a](t,n,r))return!1;return!0}:e[0]}function p(e,n,r){for(var a=0,i=n.length;a<i;a++)t(e,n[a],r);return r}function h(e,t,n,r,a){for(var i,o=[],s=0,l=e.length,u=null!=t;s<l;s++)(i=e[s])&&(n&&!n(i,r,a)||(o.push(i),u&&t.push(s)));return o}function g(e,t,n,a,i,o){return a&&!a[P]&&(a=g(a)),i&&!i[P]&&(i=g(i,o)),r(function(r,o,s,l){var u,c,d,f=[],g=[],m=o.length,v=r||p(t||"*",s.nodeType?[s]:s,[]),y=!e||!r&&t?v:h(v,f,e,s,l),b=n?i||(r?e:m||a)?[]:o:y;if(n&&n(y,b,s,l),a)for(u=h(b,g),a(u,[],s,l),c=u.length;c--;)(d=u[c])&&(b[g[c]]=!(y[g[c]]=d));if(r){if(i||e){if(i){for(u=[],c=b.length;c--;)(d=b[c])&&u.push(y[c]=d);i(null,b=[],u,l)}for(c=b.length;c--;)(d=b[c])&&(u=i?Q(r,d):f[c])>-1&&(r[u]=!(o[u]=d))}}else b=h(b===o?b.splice(m,b.length):b),i?i(null,o,b,l):J.apply(o,b)})}function m(e){for(var t,n,r,a=e.length,i=x.relative[e[0].type],o=i||x.relative[" "],s=i?1:0,l=d(function(e){return e===t},o,!0),u=d(function(e){return Q(t,e)>-1},o,!0),p=[function(e,n,r){var a=!i&&(r||n!==A)||((t=n).nodeType?l(e,n,r):u(e,n,r));return t=null,a}];s<a;s++)if(n=x.relative[e[s].type])p=[d(f(p),n)];else{if((n=x.filter[e[s].type].apply(null,e[s].matches))[P]){for(r=++s;r<a&&!x.relative[e[r].type];r++);return g(s>1&&f(p),s>1&&c(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(oe,"$1"),n,s<r&&m(e.slice(s,r)),r<a&&m(e=e.slice(r)),r<a&&c(e))}p.push(n)}return f(p)}function v(e,n){var a=n.length>0,i=e.length>0,o=function(r,o,s,l,u){var c,d,f,p=0,g="0",m=r&&[],v=[],y=A,b=r||i&&x.find.TAG("*",u),w=q+=null==y?1:Math.random()||.1,$=b.length;for(u&&(A=o!==T&&o);g!==$&&null!=(c=b[g]);g++){if(i&&c){for(d=0;f=e[d++];)if(f(c,o,s)){l.push(c);break}u&&(q=w)}a&&((c=!f&&c)&&p--,r&&m.push(c))}if(p+=g,a&&g!==p){for(d=0;f=n[d++];)f(m,v,o,s);if(r){if(p>0)for(;g--;)m[g]||v[g]||(v[g]=W.call(l));v=h(v)}J.apply(l,v),u&&!r&&v.length>0&&p+n.length>1&&t.uniqueSort(l)}return u&&(q=w,A=y),m};return a?r(o):o}var y,b,x,w,$,C,_,E,A,k,S,D,T,F,M,L,O,N,j,P="sizzle"+1*new Date,B=e.document,q=0,R=0,I=n(),U=n(),z=n(),V=function(e,t){return e===t&&(S=!0),0},H=1<<31,Y={}.hasOwnProperty,G=[],W=G.pop,Z=G.push,J=G.push,X=G.slice,Q=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},K="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ee="[\\x20\\t\\r\\n\\f]",te="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ne=te.replace("w","w#"),re="\\["+ee+"*("+te+")(?:"+ee+"*([*^$|!~]?=)"+ee+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ne+"))|)"+ee+"*\\]",ae=":("+te+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+re+")*)|.*)\\)|)",ie=new RegExp(ee+"+","g"),oe=new RegExp("^"+ee+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ee+"+$","g"),se=new RegExp("^"+ee+"*,"+ee+"*"),le=new RegExp("^"+ee+"*([>+~]|"+ee+")"+ee+"*"),ue=new RegExp("="+ee+"*([^\\]'\"]*?)"+ee+"*\\]","g"),ce=new RegExp(ae),de=new RegExp("^"+ne+"$"),fe={ID:new RegExp("^#("+te+")"),CLASS:new RegExp("^\\.("+te+")"),TAG:new RegExp("^("+te.replace("w","w*")+")"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ee+"*(even|odd|(([+-]|)(\\d*)n|)"+ee+"*(?:([+-]|)"+ee+"*(\\d+)|))"+ee+"*\\)|)","i"),bool:new RegExp("^(?:"+K+")$","i"),needsContext:new RegExp("^"+ee+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ee+"*((?:-\\d)?\\d*)"+ee+"*\\)|)(?=[^-]|$)","i")},pe=/^(?:input|select|textarea|button)$/i,he=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,me=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ve=/[+~]/,ye=/'|\\/g,be=new RegExp("\\\\([\\da-f]{1,6}"+ee+"?|("+ee+")|.)","ig"),xe=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:r<0?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},we=function(){D()};try{J.apply(G=X.call(B.childNodes),B.childNodes),G[B.childNodes.length].nodeType}catch(e){J={apply:G.length?function(e,t){Z.apply(e,X.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}b=t.support={},$=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},D=t.setDocument=function(e){var t,n,r=e?e.ownerDocument||e:B;return r!==T&&9===r.nodeType&&r.documentElement?(T=r,F=r.documentElement,(n=r.defaultView)&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",we,!1):n.attachEvent&&n.attachEvent("onunload",we)),M=!$(r),b.attributes=a(function(e){return e.className="i",!e.getAttribute("className")}),b.getElementsByTagName=a(function(e){return e.appendChild(r.createComment("")),!e.getElementsByTagName("*").length}),b.getElementsByClassName=ge.test(r.getElementsByClassName),b.getById=a(function(e){return F.appendChild(e).id=P,!r.getElementsByName||!r.getElementsByName(P).length}),b.getById?(x.find.ID=function(e,t){if(void 0!==t.getElementById&&M){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},x.filter.ID=function(e){var t=e.replace(be,xe);return function(e){return e.getAttribute("id")===t}}):(delete x.find.ID,x.filter.ID=function(e){var t=e.replace(be,xe);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),x.find.TAG=b.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):b.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],a=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[a++];)1===n.nodeType&&r.push(n);return r}return i},x.find.CLASS=b.getElementsByClassName&&function(e,t){if(M)return t.getElementsByClassName(e)},O=[],L=[],(b.qsa=ge.test(r.querySelectorAll))&&(a(function(e){F.appendChild(e).innerHTML="<a id='"+P+"'></a><select id='"+P+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&L.push("[*^$]="+ee+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||L.push("\\["+ee+"*(?:value|"+K+")"),e.querySelectorAll("[id~="+P+"-]").length||L.push("~="),e.querySelectorAll(":checked").length||L.push(":checked"),e.querySelectorAll("a#"+P+"+*").length||L.push(".#.+[+~]")}),a(function(e){var t=r.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&L.push("name"+ee+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||L.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),L.push(",.*:")})),(b.matchesSelector=ge.test(N=F.matches||F.webkitMatchesSelector||F.mozMatchesSelector||F.oMatchesSelector||F.msMatchesSelector))&&a(function(e){b.disconnectedMatch=N.call(e,"div"),N.call(e,"[s!='']:x"),O.push("!=",ae)}),L=L.length&&new RegExp(L.join("|")),O=O.length&&new RegExp(O.join("|")),t=ge.test(F.compareDocumentPosition),j=t||ge.test(F.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},V=t?function(e,t){if(e===t)return S=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!b.sortDetached&&t.compareDocumentPosition(e)===n?e===r||e.ownerDocument===B&&j(B,e)?-1:t===r||t.ownerDocument===B&&j(B,t)?1:k?Q(k,e)-Q(k,t):0:4&n?-1:1)}:function(e,t){if(e===t)return S=!0,0;var n,a=0,i=e.parentNode,s=t.parentNode,l=[e],u=[t];if(!i||!s)return e===r?-1:t===r?1:i?-1:s?1:k?Q(k,e)-Q(k,t):0;if(i===s)return o(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)u.unshift(n);for(;l[a]===u[a];)a++;return a?o(l[a],u[a]):l[a]===B?-1:u[a]===B?1:0},r):T},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==T&&D(e),n=n.replace(ue,"='$1']"),b.matchesSelector&&M&&(!O||!O.test(n))&&(!L||!L.test(n)))try{var r=N.call(e,n);if(r||b.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){}return t(n,T,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==T&&D(e),j(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==T&&D(e);var n=x.attrHandle[t.toLowerCase()],r=n&&Y.call(x.attrHandle,t.toLowerCase())?n(e,t,!M):void 0;return void 0!==r?r:b.attributes||!M?e.getAttribute(t):(r=e.getAttributeNode(t))&&r.specified?r.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],r=0,a=0;if(S=!b.detectDuplicates,k=!b.sortStable&&e.slice(0),e.sort(V),S){for(;t=e[a++];)t===e[a]&&(r=n.push(a));for(;r--;)e.splice(n[r],1)}return k=null,e},w=t.getText=function(e){var t,n="",r=0,a=e.nodeType;if(a){if(1===a||9===a||11===a){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=w(e)}else if(3===a||4===a)return e.nodeValue}else for(;t=e[r++];)n+=w(t);return n},(x=t.selectors={cacheLength:50,createPseudo:r,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(be,xe),e[3]=(e[3]||e[4]||e[5]||"").replace(be,xe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&ce.test(n)&&(t=C(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(be,xe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=I[e+" "];return t||(t=new RegExp("(^|"+ee+")"+e+"("+ee+"|$)"))&&I(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,n,r){return function(a){var i=t.attr(a,e);return null==i?"!="===n:!n||(i+="","="===n?i===r:"!="===n?i!==r:"^="===n?r&&0===i.indexOf(r):"*="===n?r&&i.indexOf(r)>-1:"$="===n?r&&i.slice(-r.length)===r:"~="===n?(" "+i.replace(ie," ")+" ").indexOf(r)>-1:"|="===n&&(i===r||i.slice(0,r.length+1)===r+"-"))}},CHILD:function(e,t,n,r,a){var i="nth"!==e.slice(0,3),o="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===a?function(e){return!!e.parentNode}:function(t,n,l){var u,c,d,f,p,h,g=i!==o?"nextSibling":"previousSibling",m=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(m){if(i){for(;g;){for(d=t;d=d[g];)if(s?d.nodeName.toLowerCase()===v:1===d.nodeType)return!1;h=g="only"===e&&!h&&"nextSibling"}return!0}if(h=[o?m.firstChild:m.lastChild],o&&y){for(p=(u=(c=m[P]||(m[P]={}))[e]||[])[0]===q&&u[1],f=u[0]===q&&u[2],d=p&&m.childNodes[p];d=++p&&d&&d[g]||(f=p=0)||h.pop();)if(1===d.nodeType&&++f&&d===t){c[e]=[q,p,f];break}}else if(y&&(u=(t[P]||(t[P]={}))[e])&&u[0]===q)f=u[1];else for(;(d=++p&&d&&d[g]||(f=p=0)||h.pop())&&((s?d.nodeName.toLowerCase()!==v:1!==d.nodeType)||!++f||(y&&((d[P]||(d[P]={}))[e]=[q,f]),d!==t)););return(f-=a)===r||f%r==0&&f/r>=0}}},PSEUDO:function(e,n){var a,i=x.pseudos[e]||x.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return i[P]?i(n):i.length>1?(a=[e,e,"",n],x.setFilters.hasOwnProperty(e.toLowerCase())?r(function(e,t){for(var r,a=i(e,n),o=a.length;o--;)e[r=Q(e,a[o])]=!(t[r]=a[o])}):function(e){return i(e,0,a)}):i}},pseudos:{not:r(function(e){var t=[],n=[],a=_(e.replace(oe,"$1"));return a[P]?r(function(e,t,n,r){for(var i,o=a(e,null,r,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(t[s]=i))}):function(e,r,i){return t[0]=e,a(t,null,i,n),t[0]=null,!n.pop()}}),has:r(function(e){return function(n){return t(e,n).length>0}}),contains:r(function(e){return e=e.replace(be,xe),function(t){return(t.textContent||t.innerText||w(t)).indexOf(e)>-1}}),lang:r(function(e){return de.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(be,xe).toLowerCase(),function(t){var n;do{if(n=M?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===F},focus:function(e){return e===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!x.pseudos.empty(e)},header:function(e){return he.test(e.nodeName)},input:function(e){return pe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:s(function(){return[0]}),last:s(function(e,t){return[t-1]}),eq:s(function(e,t,n){return[n<0?n+t:n]}),even:s(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:s(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:s(function(e,t,n){for(var r=n<0?n+t:n;--r>=0;)e.push(r);return e}),gt:s(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=x.pseudos.eq;for(y in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[y]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(y);for(y in{submit:!0,reset:!0})x.pseudos[y]=function(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}(y);return u.prototype=x.filters=x.pseudos,x.setFilters=new u,C=t.tokenize=function(e,n){var r,a,i,o,s,l,u,c=U[e+" "];if(c)return n?0:c.slice(0);for(s=e,l=[],u=x.preFilter;s;){r&&!(a=se.exec(s))||(a&&(s=s.slice(a[0].length)||s),l.push(i=[])),r=!1,(a=le.exec(s))&&(r=a.shift(),i.push({value:r,type:a[0].replace(oe," ")}),s=s.slice(r.length));for(o in x.filter)!(a=fe[o].exec(s))||u[o]&&!(a=u[o](a))||(r=a.shift(),i.push({value:r,type:o,matches:a}),s=s.slice(r.length));if(!r)break}return n?s.length:s?t.error(e):U(e,l).slice(0)},_=t.compile=function(e,t){var n,r=[],a=[],i=z[e+" "];if(!i){for(t||(t=C(e)),n=t.length;n--;)(i=m(t[n]))[P]?r.push(i):a.push(i);(i=z(e,v(a,r))).selector=e}return i},E=t.select=function(e,t,n,r){var a,i,o,s,u,d="function"==typeof e&&e,f=!r&&C(e=d.selector||e);if(n=n||[],1===f.length){if((i=f[0]=f[0].slice(0)).length>2&&"ID"===(o=i[0]).type&&b.getById&&9===t.nodeType&&M&&x.relative[i[1].type]){if(!(t=(x.find.ID(o.matches[0].replace(be,xe),t)||[])[0]))return n;d&&(t=t.parentNode),e=e.slice(i.shift().value.length)}for(a=fe.needsContext.test(e)?0:i.length;a--&&(o=i[a],!x.relative[s=o.type]);)if((u=x.find[s])&&(r=u(o.matches[0].replace(be,xe),ve.test(i[0].type)&&l(t.parentNode)||t))){if(i.splice(a,1),!(e=r.length&&c(i)))return J.apply(n,r),n;break}}return(d||_(e,f))(r,t,!M,n,ve.test(e)&&l(t.parentNode)||t),n},b.sortStable=P.split("").sort(V).join("")===P,b.detectDuplicates=!!S,D(),b.sortDetached=a(function(e){return 1&e.compareDocumentPosition(T.createElement("div"))}),a(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||i("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),b.attributes&&a(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||i("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),a(function(e){return null==e.getAttribute("disabled")})||i(K,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),t}(e);Q.find=re,Q.expr=re.selectors,Q.expr[":"]=Q.expr.pseudos,Q.unique=re.uniqueSort,Q.text=re.getText,Q.isXMLDoc=re.isXML,Q.contains=re.contains;var ae=Q.expr.match.needsContext,ie=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,oe=/^.[^:#\[\.,]*$/;Q.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?Q.find.matchesSelector(r,e)?[r]:[]:Q.find.matches(e,Q.grep(t,function(e){return 1===e.nodeType}))},Q.fn.extend({find:function(e){var t,n=this.length,r=[],a=this;if("string"!=typeof e)return this.pushStack(Q(e).filter(function(){for(t=0;t<n;t++)if(Q.contains(a[t],this))return!0}));for(t=0;t<n;t++)Q.find(e,a[t],r);return r=this.pushStack(n>1?Q.unique(r):r),r.selector=this.selector?this.selector+" "+e:e,r},filter:function(e){return this.pushStack(r(this,e||[],!1))},not:function(e){return this.pushStack(r(this,e||[],!0))},is:function(e){return!!r(this,"string"==typeof e&&ae.test(e)?Q(e):e||[],!1).length}});var se,le=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(Q.fn.init=function(e,t){var n,r;if(!e)return this;if("string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:le.exec(e))||!n[1]&&t)return!t||t.jquery?(t||se).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof Q?t[0]:t,Q.merge(this,Q.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:X,!0)),ie.test(n[1])&&Q.isPlainObject(t))for(n in t)Q.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(r=X.getElementById(n[2]))&&r.parentNode&&(this.length=1,this[0]=r),this.context=X,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):Q.isFunction(e)?void 0!==se.ready?se.ready(e):e(Q):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),Q.makeArray(e,this))}).prototype=Q.fn,se=Q(X);var ue=/^(?:parents|prev(?:Until|All))/,ce={children:!0,contents:!0,next:!0,prev:!0};Q.extend({dir:function(e,t,n){for(var r=[],a=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(a&&Q(e).is(n))break;r.push(e)}return r},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),Q.fn.extend({has:function(e){var t=Q(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(Q.contains(this,t[e]))return!0})},closest:function(e,t){for(var n,r=0,a=this.length,i=[],o=ae.test(e)||"string"!=typeof e?Q(e,t||this.context):0;r<a;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&Q.find.matchesSelector(n,e))){i.push(n);break}return this.pushStack(i.length>1?Q.unique(i):i)},index:function(e){return e?"string"==typeof e?Y.call(Q(e),this[0]):Y.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(Q.unique(Q.merge(this.get(),Q(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),Q.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return Q.dir(e,"parentNode")},parentsUntil:function(e,t,n){return Q.dir(e,"parentNode",n)},next:function(e){return a(e,"nextSibling")},prev:function(e){return a(e,"previousSibling")},nextAll:function(e){return Q.dir(e,"nextSibling")},prevAll:function(e){return Q.dir(e,"previousSibling")},nextUntil:function(e,t,n){return Q.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return Q.dir(e,"previousSibling",n)},siblings:function(e){return Q.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return Q.sibling(e.firstChild)},contents:function(e){return e.contentDocument||Q.merge([],e.childNodes)}},function(e,t){Q.fn[e]=function(n,r){var a=Q.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(a=Q.filter(r,a)),this.length>1&&(ce[e]||Q.unique(a),ue.test(e)&&a.reverse()),this.pushStack(a)}});var de=/\S+/g,fe={};Q.Callbacks=function(e){var t,n,r,a,o,s,l=[],u=!(e="string"==typeof e?fe[e]||i(e):Q.extend({},e)).once&&[],c=function(i){for(t=e.memory&&i,n=!0,s=a||0,a=0,o=l.length,r=!0;l&&s<o;s++)if(!1===l[s].apply(i[0],i[1])&&e.stopOnFalse){t=!1;break}r=!1,l&&(u?u.length&&c(u.shift()):t?l=[]:d.disable())},d={add:function(){if(l){var n=l.length;!function t(n){Q.each(n,function(n,r){var a=Q.type(r);"function"===a?e.unique&&d.has(r)||l.push(r):r&&r.length&&"string"!==a&&t(r)})}(arguments),r?o=l.length:t&&(a=n,c(t))}return this},remove:function(){return l&&Q.each(arguments,function(e,t){for(var n;(n=Q.inArray(t,l,n))>-1;)l.splice(n,1),r&&(n<=o&&o--,n<=s&&s--)}),this},has:function(e){return e?Q.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],o=0,this},disable:function(){return l=u=t=void 0,this},disabled:function(){return!l},lock:function(){return u=void 0,t||d.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||n&&!u||(t=[e,(t=t||[]).slice?t.slice():t],r?u.push(t):c(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},Q.extend({Deferred:function(e){var t=[["resolve","done",Q.Callbacks("once memory"),"resolved"],["reject","fail",Q.Callbacks("once memory"),"rejected"],["notify","progress",Q.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return a.done(arguments).fail(arguments),this},then:function(){var e=arguments;return Q.Deferred(function(n){Q.each(t,function(t,i){var o=Q.isFunction(e[t])&&e[t];a[i[1]](function(){var e=o&&o.apply(this,arguments);e&&Q.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[i[0]+"With"](this===r?n.promise():this,o?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?Q.extend(e,r):r}},a={};return r.pipe=r.then,Q.each(t,function(e,i){var o=i[2],s=i[3];r[i[1]]=o.add,s&&o.add(function(){n=s},t[1^e][2].disable,t[2][2].lock),a[i[0]]=function(){return a[i[0]+"With"](this===a?r:this,arguments),this},a[i[0]+"With"]=o.fireWith}),r.promise(a),e&&e.call(a,a),a},when:function(e){var t,n,r,a=0,i=z.call(arguments),o=i.length,s=1!==o||e&&Q.isFunction(e.promise)?o:0,l=1===s?e:Q.Deferred(),u=function(e,n,r){return function(a){n[e]=this,r[e]=arguments.length>1?z.call(arguments):a,r===t?l.notifyWith(n,r):--s||l.resolveWith(n,r)}};if(o>1)for(t=new Array(o),n=new Array(o),r=new Array(o);a<o;a++)i[a]&&Q.isFunction(i[a].promise)?i[a].promise().done(u(a,r,i)).fail(l.reject).progress(u(a,n,t)):--s;return s||l.resolveWith(r,i),l.promise()}});var pe;Q.fn.ready=function(e){return Q.ready.promise().done(e),this},Q.extend({isReady:!1,readyWait:1,holdReady:function(e){e?Q.readyWait++:Q.ready(!0)},ready:function(e){(!0===e?--Q.readyWait:Q.isReady)||(Q.isReady=!0,!0!==e&&--Q.readyWait>0||(pe.resolveWith(X,[Q]),Q.fn.triggerHandler&&(Q(X).triggerHandler("ready"),Q(X).off("ready"))))}}),Q.ready.promise=function(t){return pe||(pe=Q.Deferred(),"complete"===X.readyState?setTimeout(Q.ready):(X.addEventListener("DOMContentLoaded",o,!1),e.addEventListener("load",o,!1))),pe.promise(t)},Q.ready.promise();var he=Q.access=function(e,t,n,r,a,i,o){var s=0,l=e.length,u=null==n;if("object"===Q.type(n)){a=!0;for(s in n)Q.access(e,t,s,n[s],!0,i,o)}else if(void 0!==r&&(a=!0,Q.isFunction(r)||(o=!0),u&&(o?(t.call(e,r),t=null):(u=t,t=function(e,t,n){return u.call(Q(e),n)})),t))for(;s<l;s++)t(e[s],n,o?r:r.call(e[s],s,t(e[s],n)));return a?e:u?t.call(e):l?t(e[0],n):i};Q.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},s.uid=1,s.accepts=Q.acceptData,s.prototype={key:function(e){if(!s.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=s.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,Q.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,a=this.key(e),i=this.cache[a];if("string"==typeof t)i[t]=n;else if(Q.isEmptyObject(i))Q.extend(this.cache[a],t);else for(r in t)i[r]=t[r];return i},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var r;return void 0===t||t&&"string"==typeof t&&void 0===n?(r=this.get(e,t),void 0!==r?r:this.get(e,Q.camelCase(t))):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r,a,i=this.key(e),o=this.cache[i];if(void 0===t)this.cache[i]={};else{Q.isArray(t)?r=t.concat(t.map(Q.camelCase)):(a=Q.camelCase(t),r=t in o?[t,a]:(r=a)in o?[r]:r.match(de)||[]),n=r.length;for(;n--;)delete o[r[n]]}},hasData:function(e){return!Q.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var ge=new s,me=new s,ve=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ye=/([A-Z])/g;Q.extend({hasData:function(e){return me.hasData(e)||ge.hasData(e)},data:function(e,t,n){return me.access(e,t,n)},removeData:function(e,t){me.remove(e,t)},_data:function(e,t,n){return ge.access(e,t,n)},_removeData:function(e,t){ge.remove(e,t)}}),Q.fn.extend({data:function(e,t){var n,r,a,i=this[0],o=i&&i.attributes;if(void 0===e){if(this.length&&(a=me.get(i),1===i.nodeType&&!ge.get(i,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(r=o[n].name).indexOf("data-")&&(r=Q.camelCase(r.slice(5)),l(i,r,a[r]));ge.set(i,"hasDataAttrs",!0)}return a}return"object"==typeof e?this.each(function(){me.set(this,e)}):he(this,function(t){var n,r=Q.camelCase(e);if(i&&void 0===t){if(void 0!==(n=me.get(i,e)))return n;if(void 0!==(n=me.get(i,r)))return n;if(void 0!==(n=l(i,r,void 0)))return n}else this.each(function(){var n=me.get(this,r);me.set(this,r,t),-1!==e.indexOf("-")&&void 0!==n&&me.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){me.remove(this,e)})}}),Q.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=ge.get(e,t),n&&(!r||Q.isArray(n)?r=ge.access(e,t,Q.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=Q.queue(e,t),r=n.length,a=n.shift(),i=Q._queueHooks(e,t),o=function(){Q.dequeue(e,t)};"inprogress"===a&&(a=n.shift(),r--),a&&("fx"===t&&n.unshift("inprogress"),delete i.stop,a.call(e,o,i)),!r&&i&&i.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return ge.get(e,n)||ge.access(e,n,{empty:Q.Callbacks("once memory").add(function(){ge.remove(e,[t+"queue",n])})})}}),Q.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?Q.queue(this[0],e):void 0===t?this:this.each(function(){var n=Q.queue(this,e,t);Q._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&Q.dequeue(this,e)})},dequeue:function(e){return this.each(function(){Q.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,a=Q.Deferred(),i=this,o=this.length,s=function(){--r||a.resolveWith(i,[i])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=ge.get(i[o],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),a.promise(t)}});var be=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,xe=["Top","Right","Bottom","Left"],we=function(e,t){return e=t||e,"none"===Q.css(e,"display")||!Q.contains(e.ownerDocument,e)},$e=/^(?:checkbox|radio)$/i;!function(){var e=X.createDocumentFragment().appendChild(X.createElement("div")),t=X.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),J.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",J.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();J.focusinBubbles="onfocusin"in e;var Ce=/^key/,_e=/^(?:mouse|pointer|contextmenu)|click/,Ee=/^(?:focusinfocus|focusoutblur)$/,Ae=/^([^.]*)(?:\.(.+)|)$/;Q.event={global:{},add:function(e,t,n,r,a){var i,o,s,l,u,c,d,f,p,h,g,m=ge.get(e);if(m)for(n.handler&&(n=(i=n).handler,a=i.selector),n.guid||(n.guid=Q.guid++),(l=m.events)||(l=m.events={}),(o=m.handle)||(o=m.handle=function(t){return void 0!==Q&&Q.event.triggered!==t.type?Q.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(de)||[""]).length;u--;)p=g=(s=Ae.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),p&&(d=Q.event.special[p]||{},p=(a?d.delegateType:d.bindType)||p,d=Q.event.special[p]||{},c=Q.extend({type:p,origType:g,data:r,handler:n,guid:n.guid,selector:a,needsContext:a&&Q.expr.match.needsContext.test(a),namespace:h.join(".")},i),(f=l[p])||((f=l[p]=[]).delegateCount=0,d.setup&&!1!==d.setup.call(e,r,h,o)||e.addEventListener&&e.addEventListener(p,o,!1)),d.add&&(d.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),a?f.splice(f.delegateCount++,0,c):f.push(c),Q.event.global[p]=!0)},remove:function(e,t,n,r,a){var i,o,s,l,u,c,d,f,p,h,g,m=ge.hasData(e)&&ge.get(e);if(m&&(l=m.events)){for(u=(t=(t||"").match(de)||[""]).length;u--;)if(s=Ae.exec(t[u])||[],p=g=s[1],h=(s[2]||"").split(".").sort(),p){for(d=Q.event.special[p]||{},f=l[p=(r?d.delegateType:d.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=i=f.length;i--;)c=f[i],!a&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(f.splice(i,1),c.selector&&f.delegateCount--,d.remove&&d.remove.call(e,c));o&&!f.length&&(d.teardown&&!1!==d.teardown.call(e,h,m.handle)||Q.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)Q.event.remove(e,p+t[u],n,r,!0);Q.isEmptyObject(l)&&(delete m.handle,ge.remove(e,"events"))}},trigger:function(t,n,r,a){var i,o,s,l,u,c,d,f=[r||X],p=Z.call(t,"type")?t.type:t,h=Z.call(t,"namespace")?t.namespace.split("."):[];if(o=s=r=r||X,3!==r.nodeType&&8!==r.nodeType&&!Ee.test(p+Q.event.triggered)&&(p.indexOf(".")>=0&&(p=(h=p.split(".")).shift(),h.sort()),u=p.indexOf(":")<0&&"on"+p,t=t[Q.expando]?t:new Q.Event(p,"object"==typeof t&&t),t.isTrigger=a?2:3,t.namespace=h.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:Q.makeArray(n,[t]),d=Q.event.special[p]||{},a||!d.trigger||!1!==d.trigger.apply(r,n))){if(!a&&!d.noBubble&&!Q.isWindow(r)){for(l=d.delegateType||p,Ee.test(l+p)||(o=o.parentNode);o;o=o.parentNode)f.push(o),s=o;s===(r.ownerDocument||X)&&f.push(s.defaultView||s.parentWindow||e)}for(i=0;(o=f[i++])&&!t.isPropagationStopped();)t.type=i>1?l:d.bindType||p,(c=(ge.get(o,"events")||{})[t.type]&&ge.get(o,"handle"))&&c.apply(o,n),(c=u&&o[u])&&c.apply&&Q.acceptData(o)&&(t.result=c.apply(o,n),!1===t.result&&t.preventDefault());return t.type=p,a||t.isDefaultPrevented()||d._default&&!1!==d._default.apply(f.pop(),n)||!Q.acceptData(r)||u&&Q.isFunction(r[p])&&!Q.isWindow(r)&&((s=r[u])&&(r[u]=null),Q.event.triggered=p,r[p](),Q.event.triggered=void 0,s&&(r[u]=s)),t.result}},dispatch:function(e){e=Q.event.fix(e);var t,n,r,a,i,o=[],s=z.call(arguments),l=(ge.get(this,"events")||{})[e.type]||[],u=Q.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,e)){for(o=Q.event.handlers.call(this,e,l),t=0;(a=o[t++])&&!e.isPropagationStopped();)for(e.currentTarget=a.elem,n=0;(i=a.handlers[n++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(i.namespace)||(e.handleObj=i,e.data=i.data,void 0!==(r=((Q.event.special[i.origType]||{}).handle||i.handler).apply(a.elem,s))&&!1===(e.result=r)&&(e.preventDefault(),e.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,a,i,o=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==e.type){for(r=[],n=0;n<s;n++)void 0===r[a=(i=t[n]).selector+" "]&&(r[a]=i.needsContext?Q(a,this).index(l)>=0:Q.find(a,this,null,[l]).length),r[a]&&r.push(i);r.length&&o.push({elem:l,handlers:r})}return s<t.length&&o.push({elem:this,handlers:t.slice(s)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,a,i=t.button;return null==e.pageX&&null!=t.clientX&&(r=(n=e.target.ownerDocument||X).documentElement,a=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||a&&a.scrollLeft||0)-(r&&r.clientLeft||a&&a.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||a&&a.scrollTop||0)-(r&&r.clientTop||a&&a.clientTop||0)),e.which||void 0===i||(e.which=1&i?1:2&i?3:4&i?2:0),e}},fix:function(e){if(e[Q.expando])return e;var t,n,r,a=e.type,i=e,o=this.fixHooks[a];for(o||(this.fixHooks[a]=o=_e.test(a)?this.mouseHooks:Ce.test(a)?this.keyHooks:{}),r=o.props?this.props.concat(o.props):this.props,e=new Q.Event(i),t=r.length;t--;)e[n=r[t]]=i[n];return e.target||(e.target=X),3===e.target.nodeType&&(e.target=e.target.parentNode),o.filter?o.filter(e,i):e},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==d()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===d()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if("checkbox"===this.type&&this.click&&Q.nodeName(this,"input"))return this.click(),!1},_default:function(e){return Q.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var a=Q.extend(new Q.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?Q.event.trigger(a,null,t):Q.event.dispatch.call(t,a),a.isDefaultPrevented()&&n.preventDefault()}},Q.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},Q.Event=function(e,t){if(!(this instanceof Q.Event))return new Q.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?u:c):this.type=e,t&&Q.extend(this,t),this.timeStamp=e&&e.timeStamp||Q.now(),this[Q.expando]=!0},Q.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=u,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=u,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=u,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},Q.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){Q.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,a=e.relatedTarget,i=e.handleObj;return a&&(a===r||Q.contains(r,a))||(e.type=i.origType,n=i.handler.apply(this,arguments),e.type=t),n}}}),J.focusinBubbles||Q.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){Q.event.simulate(t,e.target,Q.event.fix(e),!0)};Q.event.special[t]={setup:function(){var r=this.ownerDocument||this,a=ge.access(r,t);a||r.addEventListener(e,n,!0),ge.access(r,t,(a||0)+1)},teardown:function(){var r=this.ownerDocument||this,a=ge.access(r,t)-1;a?ge.access(r,t,a):(r.removeEventListener(e,n,!0),ge.remove(r,t))}}}),Q.fn.extend({on:function(e,t,n,r,a){var i,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=void 0);for(o in e)this.on(o,t,n,e[o],a);return this}if(null==n&&null==r?(r=t,n=t=void 0):null==r&&("string"==typeof t?(r=n,n=void 0):(r=n,n=t,t=void 0)),!1===r)r=c;else if(!r)return this;return 1===a&&(i=r,(r=function(e){return Q().off(e),i.apply(this,arguments)}).guid=i.guid||(i.guid=Q.guid++)),this.each(function(){Q.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,a;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,Q(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(a in e)this.off(a,t,e[a]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=c),this.each(function(){Q.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){Q.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return Q.event.trigger(e,t,n,!0)}});var ke=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Se=/<([\w:]+)/,De=/<|&#?\w+;/,Te=/<(?:script|style|link)/i,Fe=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^$|\/(?:java|ecma)script/i,Le=/^true\/(.*)/,Oe=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ne={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ne.optgroup=Ne.option,Ne.tbody=Ne.tfoot=Ne.colgroup=Ne.caption=Ne.thead,Ne.th=Ne.td,Q.extend({clone:function(e,t,n){var r,a,i,o,s=e.cloneNode(!0),l=Q.contains(e.ownerDocument,e);if(!(J.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||Q.isXMLDoc(e)))for(o=v(s),r=0,a=(i=v(e)).length;r<a;r++)y(i[r],o[r]);if(t)if(n)for(i=i||v(e),o=o||v(s),r=0,a=i.length;r<a;r++)m(i[r],o[r]);else m(e,s);return(o=v(s,"script")).length>0&&g(o,!l&&v(e,"script")),s},buildFragment:function(e,t,n,r){for(var a,i,o,s,l,u,c=t.createDocumentFragment(),d=[],f=0,p=e.length;f<p;f++)if((a=e[f])||0===a)if("object"===Q.type(a))Q.merge(d,a.nodeType?[a]:a);else if(De.test(a)){for(i=i||c.appendChild(t.createElement("div")),o=(Se.exec(a)||["",""])[1].toLowerCase(),s=Ne[o]||Ne._default,i.innerHTML=s[1]+a.replace(ke,"<$1></$2>")+s[2],u=s[0];u--;)i=i.lastChild;Q.merge(d,i.childNodes),(i=c.firstChild).textContent=""}else d.push(t.createTextNode(a));for(c.textContent="",f=0;a=d[f++];)if((!r||-1===Q.inArray(a,r))&&(l=Q.contains(a.ownerDocument,a),i=v(c.appendChild(a),"script"),l&&g(i),n))for(u=0;a=i[u++];)Me.test(a.type||"")&&n.push(a);return c},cleanData:function(e){for(var t,n,r,a,i=Q.event.special,o=0;void 0!==(n=e[o]);o++){if(Q.acceptData(n)&&(a=n[ge.expando])&&(t=ge.cache[a])){if(t.events)for(r in t.events)i[r]?Q.event.remove(n,r):Q.removeEvent(n,r,t.handle);ge.cache[a]&&delete ge.cache[a]}delete me.cache[n[me.expando]]}}}),Q.fn.extend({text:function(e){return he(this,function(e){return void 0===e?Q.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||f(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=f(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var n,r=e?Q.filter(e,this):this,a=0;null!=(n=r[a]);a++)t||1!==n.nodeType||Q.cleanData(v(n)),n.parentNode&&(t&&Q.contains(n.ownerDocument,n)&&g(v(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(Q.cleanData(v(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return Q.clone(this,e,t)})},html:function(e){return he(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Te.test(e)&&!Ne[(Se.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(ke,"<$1></$2>");try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(Q.cleanData(v(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,Q.cleanData(v(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=V.apply([],e);var n,r,a,i,o,s,l=0,u=this.length,c=this,d=u-1,f=e[0],g=Q.isFunction(f);if(g||u>1&&"string"==typeof f&&!J.checkClone&&Fe.test(f))return this.each(function(n){var r=c.eq(n);g&&(e[0]=f.call(this,n,r.html())),r.domManip(e,t)});if(u&&(n=Q.buildFragment(e,this[0].ownerDocument,!1,this),r=n.firstChild,1===n.childNodes.length&&(n=r),r)){for(i=(a=Q.map(v(n,"script"),p)).length;l<u;l++)o=n,l!==d&&(o=Q.clone(o,!0,!0),i&&Q.merge(a,v(o,"script"))),t.call(this[l],o,l);if(i)for(s=a[a.length-1].ownerDocument,Q.map(a,h),l=0;l<i;l++)o=a[l],Me.test(o.type||"")&&!ge.access(o,"globalEval")&&Q.contains(s,o)&&(o.src?Q._evalUrl&&Q._evalUrl(o.src):Q.globalEval(o.textContent.replace(Oe,"")))}return this}}),Q.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){Q.fn[e]=function(e){for(var n,r=[],a=Q(e),i=a.length-1,o=0;o<=i;o++)n=o===i?this:this.clone(!0),Q(a[o])[t](n),H.apply(r,n.get());return this.pushStack(r)}});var je,Pe={},Be=/^margin/,qe=new RegExp("^("+be+")(?!px)[a-z%]+$","i"),Re=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){o.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",o.innerHTML="",a.appendChild(i);var t=e.getComputedStyle(o,null);n="1%"!==t.top,r="4px"===t.width,a.removeChild(i)}var n,r,a=X.documentElement,i=X.createElement("div"),o=X.createElement("div");o.style&&(o.style.backgroundClip="content-box",o.cloneNode(!0).style.backgroundClip="",J.clearCloneStyle="content-box"===o.style.backgroundClip,i.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",i.appendChild(o),e.getComputedStyle&&Q.extend(J,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==r&&t(),r},reliableMarginRight:function(){var t,n=o.appendChild(X.createElement("div"));return n.style.cssText=o.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",o.style.width="1px",a.appendChild(i),t=!parseFloat(e.getComputedStyle(n,null).marginRight),a.removeChild(i),o.removeChild(n),t}}))}(),Q.swap=function(e,t,n,r){var a,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];a=n.apply(e,r||[]);for(i in t)e.style[i]=o[i];return a};var Ie=/^(none|table(?!-c[ea]).+)/,Ue=new RegExp("^("+be+")(.*)$","i"),ze=new RegExp("^([+-])=("+be+")","i"),Ve={position:"absolute",visibility:"hidden",display:"block"},He={letterSpacing:"0",fontWeight:"400"},Ye=["Webkit","O","Moz","ms"];Q.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=w(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,i,o,s=Q.camelCase(t),l=e.style;if(t=Q.cssProps[s]||(Q.cssProps[s]=C(l,s)),o=Q.cssHooks[t]||Q.cssHooks[s],void 0===n)return o&&"get"in o&&void 0!==(a=o.get(e,!1,r))?a:l[t];"string"===(i=typeof n)&&(a=ze.exec(n))&&(n=(a[1]+1)*a[2]+parseFloat(Q.css(e,t)),i="number"),null!=n&&n===n&&("number"!==i||Q.cssNumber[s]||(n+="px"),J.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,r))||(l[t]=n))}},css:function(e,t,n,r){var a,i,o,s=Q.camelCase(t);return t=Q.cssProps[s]||(Q.cssProps[s]=C(e.style,s)),(o=Q.cssHooks[t]||Q.cssHooks[s])&&"get"in o&&(a=o.get(e,!0,n)),void 0===a&&(a=w(e,t,r)),"normal"===a&&t in He&&(a=He[t]),""===n||n?(i=parseFloat(a),!0===n||Q.isNumeric(i)?i||0:a):a}}),Q.each(["height","width"],function(e,t){Q.cssHooks[t]={get:function(e,n,r){if(n)return Ie.test(Q.css(e,"display"))&&0===e.offsetWidth?Q.swap(e,Ve,function(){return A(e,t,r)}):A(e,t,r)},set:function(e,n,r){var a=r&&Re(e);return _(e,n,r?E(e,t,r,"border-box"===Q.css(e,"boxSizing",!1,a),a):0)}}}),Q.cssHooks.marginRight=$(J.reliableMarginRight,function(e,t){if(t)return Q.swap(e,{display:"inline-block"},w,[e,"marginRight"])}),Q.each({margin:"",padding:"",border:"Width"},function(e,t){Q.cssHooks[e+t]={expand:function(n){for(var r=0,a={},i="string"==typeof n?n.split(" "):[n];r<4;r++)a[e+xe[r]+t]=i[r]||i[r-2]||i[0];return a}},Be.test(e)||(Q.cssHooks[e+t].set=_)}),Q.fn.extend({css:function(e,t){return he(this,function(e,t,n){var r,a,i={},o=0;if(Q.isArray(t)){for(r=Re(e),a=t.length;o<a;o++)i[t[o]]=Q.css(e,t[o],!1,r);return i}return void 0!==n?Q.style(e,t,n):Q.css(e,t)},e,t,arguments.length>1)},show:function(){return k(this,!0)},hide:function(){return k(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){we(this)?Q(this).show():Q(this).hide()})}}),Q.Tween=S,S.prototype={constructor:S,init:function(e,t,n,r,a,i){this.elem=e,this.prop=n,this.easing=a||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=i||(Q.cssNumber[n]?"":"px")},cur:function(){var e=S.propHooks[this.prop];return e&&e.get?e.get(this):S.propHooks._default.get(this)},run:function(e){var t,n=S.propHooks[this.prop];return this.options.duration?this.pos=t=Q.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):S.propHooks._default.set(this),this}},S.prototype.init.prototype=S.prototype,S.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=Q.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){Q.fx.step[e.prop]?Q.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[Q.cssProps[e.prop]]||Q.cssHooks[e.prop])?Q.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},S.propHooks.scrollTop=S.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},Q.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},Q.fx=S.prototype.init,Q.fx.step={};var Ge,We,Ze=/^(?:toggle|show|hide)$/,Je=new RegExp("^(?:([+-])=|)("+be+")([a-z%]*)$","i"),Xe=/queueHooks$/,Qe=[M],Ke={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),a=Je.exec(t),i=a&&a[3]||(Q.cssNumber[e]?"":"px"),o=(Q.cssNumber[e]||"px"!==i&&+r)&&Je.exec(Q.css(n.elem,e)),s=1,l=20;if(o&&o[3]!==i){i=i||o[3],a=a||[],o=+r||1;do{o/=s=s||".5",Q.style(n.elem,e,o+i)}while(s!==(s=n.cur()/r)&&1!==s&&--l)}return a&&(o=n.start=+o||+r||0,n.unit=i,n.end=a[1]?o+(a[1]+1)*a[2]:+a[2]),n}]};Q.Animation=Q.extend(O,{tweener:function(e,t){Q.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,r=0,a=e.length;r<a;r++)n=e[r],Ke[n]=Ke[n]||[],Ke[n].unshift(t)},prefilter:function(e,t){t?Qe.unshift(e):Qe.push(e)}}),Q.speed=function(e,t,n){var r=e&&"object"==typeof e?Q.extend({},e):{complete:n||!n&&t||Q.isFunction(e)&&e,duration:e,easing:n&&t||t&&!Q.isFunction(t)&&t};return r.duration=Q.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in Q.fx.speeds?Q.fx.speeds[r.duration]:Q.fx.speeds._default,null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){Q.isFunction(r.old)&&r.old.call(this),r.queue&&Q.dequeue(this,r.queue)},r},Q.fn.extend({fadeTo:function(e,t,n,r){return this.filter(we).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var a=Q.isEmptyObject(e),i=Q.speed(t,n,r),o=function(){var t=O(this,Q.extend({},e),i);(a||ge.get(this,"finish"))&&t.stop(!0)};return o.finish=o,a||!1===i.queue?this.each(o):this.queue(i.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,a=null!=e&&e+"queueHooks",i=Q.timers,o=ge.get(this);if(a)o[a]&&o[a].stop&&r(o[a]);else for(a in o)o[a]&&o[a].stop&&Xe.test(a)&&r(o[a]);for(a=i.length;a--;)i[a].elem!==this||null!=e&&i[a].queue!==e||(i[a].anim.stop(n),t=!1,i.splice(a,1));!t&&n||Q.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=ge.get(this),r=n[e+"queue"],a=n[e+"queueHooks"],i=Q.timers,o=r?r.length:0;for(n.finish=!0,Q.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),Q.each(["toggle","show","hide"],function(e,t){var n=Q.fn[t];Q.fn[t]=function(e,r,a){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(T(t,!0),e,r,a)}}),Q.each({slideDown:T("show"),slideUp:T("hide"),slideToggle:T("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){Q.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),Q.timers=[],Q.fx.tick=function(){var e,t=0,n=Q.timers;for(Ge=Q.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||Q.fx.stop(),Ge=void 0},Q.fx.timer=function(e){Q.timers.push(e),e()?Q.fx.start():Q.timers.pop()},Q.fx.interval=13,Q.fx.start=function(){We||(We=setInterval(Q.fx.tick,Q.fx.interval))},Q.fx.stop=function(){clearInterval(We),We=null},Q.fx.speeds={slow:600,fast:200,_default:400},Q.fn.delay=function(e,t){return e=Q.fx?Q.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},function(){var e=X.createElement("input"),t=X.createElement("select"),n=t.appendChild(X.createElement("option"));e.type="checkbox",J.checkOn=""!==e.value,J.optSelected=n.selected,t.disabled=!0,J.optDisabled=!n.disabled,(e=X.createElement("input")).value="t",e.type="radio",J.radioValue="t"===e.value}();var et,tt=Q.expr.attrHandle;Q.fn.extend({attr:function(e,t){return he(this,Q.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){Q.removeAttr(this,e)})}}),Q.extend({attr:function(e,t,n){var r,a,i=e.nodeType;if(e&&3!==i&&8!==i&&2!==i)return void 0===e.getAttribute?Q.prop(e,t,n):(1===i&&Q.isXMLDoc(e)||(t=t.toLowerCase(),r=Q.attrHooks[t]||(Q.expr.match.bool.test(t)?et:void 0)),void 0===n?r&&"get"in r&&null!==(a=r.get(e,t))?a:(a=Q.find.attr(e,t),null==a?void 0:a):null!==n?r&&"set"in r&&void 0!==(a=r.set(e,n,t))?a:(e.setAttribute(t,n+""),n):void Q.removeAttr(e,t))},removeAttr:function(e,t){var n,r,a=0,i=t&&t.match(de);if(i&&1===e.nodeType)for(;n=i[a++];)r=Q.propFix[n]||n,Q.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!J.radioValue&&"radio"===t&&Q.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),et={set:function(e,t,n){return!1===t?Q.removeAttr(e,n):e.setAttribute(n,n),n}},Q.each(Q.expr.match.bool.source.match(/\w+/g),function(e,t){var n=tt[t]||Q.find.attr;tt[t]=function(e,t,r){var a,i;return r||(i=tt[t],tt[t]=a,a=null!=n(e,t,r)?t.toLowerCase():null,tt[t]=i),a}});var nt=/^(?:input|select|textarea|button)$/i;Q.fn.extend({prop:function(e,t){return he(this,Q.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[Q.propFix[e]||e]})}}),Q.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,n){var r,a,i=e.nodeType;if(e&&3!==i&&8!==i&&2!==i)return(1!==i||!Q.isXMLDoc(e))&&(t=Q.propFix[t]||t,a=Q.propHooks[t]),void 0!==n?a&&"set"in a&&void 0!==(r=a.set(e,n,t))?r:e[t]=n:a&&"get"in a&&null!==(r=a.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||nt.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),J.optSelected||(Q.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),Q.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Q.propFix[this.toLowerCase()]=this});var rt=/[\t\r\n\f]/g;Q.fn.extend({addClass:function(e){var t,n,r,a,i,o,s="string"==typeof e&&e,l=0,u=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).addClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(de)||[];l<u;l++)if(n=this[l],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(rt," "):" ")){for(i=0;a=t[i++];)r.indexOf(" "+a+" ")<0&&(r+=a+" ");o=Q.trim(r),n.className!==o&&(n.className=o)}return this},removeClass:function(e){var t,n,r,a,i,o,s=0===arguments.length||"string"==typeof e&&e,l=0,u=this.length;if(Q.isFunction(e))return this.each(function(t){Q(this).removeClass(e.call(this,t,this.className))});if(s)for(t=(e||"").match(de)||[];l<u;l++)if(n=this[l],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(rt," "):"")){for(i=0;a=t[i++];)for(;r.indexOf(" "+a+" ")>=0;)r=r.replace(" "+a+" "," ");o=e?Q.trim(r):"",n.className!==o&&(n.className=o)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):Q.isFunction(e)?this.each(function(n){Q(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n)for(var t,r=0,a=Q(this),i=e.match(de)||[];t=i[r++];)a.hasClass(t)?a.removeClass(t):a.addClass(t);else"undefined"!==n&&"boolean"!==n||(this.className&&ge.set(this,"__className__",this.className),this.className=this.className||!1===e?"":ge.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,r=this.length;n<r;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(rt," ").indexOf(t)>=0)return!0;return!1}});var at=/\r/g;Q.fn.extend({val:function(e){var t,n,r,a=this[0];{if(arguments.length)return r=Q.isFunction(e),this.each(function(n){var a;1===this.nodeType&&(null==(a=r?e.call(this,n,Q(this).val()):e)?a="":"number"==typeof a?a+="":Q.isArray(a)&&(a=Q.map(a,function(e){return null==e?"":e+""})),(t=Q.valHooks[this.type]||Q.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,a,"value")||(this.value=a))});if(a)return(t=Q.valHooks[a.type]||Q.valHooks[a.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(a,"value"))?n:(n=a.value,"string"==typeof n?n.replace(at,""):null==n?"":n)}}}),Q.extend({valHooks:{option:{get:function(e){var t=Q.find.attr(e,"value");return null!=t?t:Q.trim(Q.text(e))}},select:{get:function(e){for(var t,n,r=e.options,a=e.selectedIndex,i="select-one"===e.type||a<0,o=i?null:[],s=i?a+1:r.length,l=a<0?s:i?a:0;l<s;l++)if(((n=r[l]).selected||l===a)&&(J.optDisabled?!n.disabled:null===n.getAttribute("disabled"))&&(!n.parentNode.disabled||!Q.nodeName(n.parentNode,"optgroup"))){if(t=Q(n).val(),i)return t;o.push(t)}return o},set:function(e,t){for(var n,r,a=e.options,i=Q.makeArray(t),o=a.length;o--;)((r=a[o]).selected=Q.inArray(r.value,i)>=0)&&(n=!0);return n||(e.selectedIndex=-1),i}}}}),Q.each(["radio","checkbox"],function(){Q.valHooks[this]={set:function(e,t){if(Q.isArray(t))return e.checked=Q.inArray(Q(e).val(),t)>=0}},J.checkOn||(Q.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),Q.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){Q.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),Q.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var it=Q.now(),ot=/\?/;Q.parseJSON=function(e){return JSON.parse(e+"")},Q.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(e){t=void 0}return t&&!t.getElementsByTagName("parsererror").length||Q.error("Invalid XML: "+e),t};var st=/#.*$/,lt=/([?&])_=[^&]*/,ut=/^(.*?):[ \t]*([^\r\n]*)$/gm,ct=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,dt=/^(?:GET|HEAD)$/,ft=/^\/\//,pt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ht={},gt={},mt="*/".concat("*"),vt=e.location.href,yt=pt.exec(vt.toLowerCase())||[];Q.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:vt,type:"GET",isLocal:ct.test(yt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":mt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Q.parseJSON,"text xml":Q.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?P(P(e,Q.ajaxSettings),t):P(Q.ajaxSettings,e)},ajaxPrefilter:N(ht),ajaxTransport:N(gt),ajax:function(e,t){function n(e,t,n,o){var l,c,v,y,x,$=t;2!==b&&(b=2,s&&clearTimeout(s),r=void 0,i=o||"",w.readyState=e>0?4:0,l=e>=200&&e<300||304===e,n&&(y=B(d,w,n)),y=q(d,y,w,l),l?(d.ifModified&&((x=w.getResponseHeader("Last-Modified"))&&(Q.lastModified[a]=x),(x=w.getResponseHeader("etag"))&&(Q.etag[a]=x)),204===e||"HEAD"===d.type?$="nocontent":304===e?$="notmodified":($=y.state,c=y.data,l=!(v=y.error))):(v=$,!e&&$||($="error",e<0&&(e=0))),w.status=e,w.statusText=(t||$)+"",l?h.resolveWith(f,[c,$,w]):h.rejectWith(f,[w,$,v]),w.statusCode(m),m=void 0,u&&p.trigger(l?"ajaxSuccess":"ajaxError",[w,d,l?c:v]),g.fireWith(f,[w,$]),u&&(p.trigger("ajaxComplete",[w,d]),--Q.active||Q.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var r,a,i,o,s,l,u,c,d=Q.ajaxSetup({},t),f=d.context||d,p=d.context&&(f.nodeType||f.jquery)?Q(f):Q.event,h=Q.Deferred(),g=Q.Callbacks("once memory"),m=d.statusCode||{},v={},y={},b=0,x="canceled",w={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!o)for(o={};t=ut.exec(i);)o[t[1].toLowerCase()]=t[2];t=o[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,v[e]=t),this},overrideMimeType:function(e){return b||(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(b<2)for(t in e)m[t]=[m[t],e[t]];else w.always(e[w.status]);return this},abort:function(e){var t=e||x;return r&&r.abort(t),n(0,t),this}};if(h.promise(w).complete=g.add,w.success=w.done,w.error=w.fail,d.url=((e||d.url||vt)+"").replace(st,"").replace(ft,yt[1]+"//"),d.type=t.method||t.type||d.method||d.type,d.dataTypes=Q.trim(d.dataType||"*").toLowerCase().match(de)||[""],null==d.crossDomain&&(l=pt.exec(d.url.toLowerCase()),d.crossDomain=!(!l||l[1]===yt[1]&&l[2]===yt[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(yt[3]||("http:"===yt[1]?"80":"443")))),d.data&&d.processData&&"string"!=typeof d.data&&(d.data=Q.param(d.data,d.traditional)),j(ht,d,t,w),2===b)return w;(u=Q.event&&d.global)&&0==Q.active++&&Q.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!dt.test(d.type),a=d.url,d.hasContent||(d.data&&(a=d.url+=(ot.test(a)?"&":"?")+d.data,delete d.data),!1===d.cache&&(d.url=lt.test(a)?a.replace(lt,"$1_="+it++):a+(ot.test(a)?"&":"?")+"_="+it++)),d.ifModified&&(Q.lastModified[a]&&w.setRequestHeader("If-Modified-Since",Q.lastModified[a]),Q.etag[a]&&w.setRequestHeader("If-None-Match",Q.etag[a])),(d.data&&d.hasContent&&!1!==d.contentType||t.contentType)&&w.setRequestHeader("Content-Type",d.contentType),w.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+mt+"; q=0.01":""):d.accepts["*"]);for(c in d.headers)w.setRequestHeader(c,d.headers[c]);if(d.beforeSend&&(!1===d.beforeSend.call(f,w,d)||2===b))return w.abort();x="abort";for(c in{success:1,error:1,complete:1})w[c](d[c]);if(r=j(gt,d,t,w)){w.readyState=1,u&&p.trigger("ajaxSend",[w,d]),d.async&&d.timeout>0&&(s=setTimeout(function(){w.abort("timeout")},d.timeout));try{b=1,r.send(v,n)}catch(e){if(!(b<2))throw e;n(-1,e)}}else n(-1,"No Transport");return w},getJSON:function(e,t,n){return Q.get(e,t,n,"json")},getScript:function(e,t){return Q.get(e,void 0,t,"script")}}),Q.each(["get","post"],function(e,t){Q[t]=function(e,n,r,a){return Q.isFunction(n)&&(a=a||r,r=n,n=void 0),Q.ajax({url:e,type:t,dataType:a,data:n,success:r})}}),Q._evalUrl=function(e){return Q.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},Q.fn.extend({wrapAll:function(e){var t;return Q.isFunction(e)?this.each(function(t){Q(this).wrapAll(e.call(this,t))}):(this[0]&&(t=Q(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return Q.isFunction(e)?this.each(function(t){Q(this).wrapInner(e.call(this,t))}):this.each(function(){var t=Q(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=Q.isFunction(e);return this.each(function(n){Q(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){Q.nodeName(this,"body")||Q(this).replaceWith(this.childNodes)}).end()}}),Q.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},Q.expr.filters.visible=function(e){return!Q.expr.filters.hidden(e)};var bt=/%20/g,xt=/\[\]$/,wt=/\r?\n/g,$t=/^(?:submit|button|image|reset|file)$/i,Ct=/^(?:input|select|textarea|keygen)/i;Q.param=function(e,t){var n,r=[],a=function(e,t){t=Q.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=Q.ajaxSettings&&Q.ajaxSettings.traditional),Q.isArray(e)||e.jquery&&!Q.isPlainObject(e))Q.each(e,function(){a(this.name,this.value)});else for(n in e)R(n,e[n],t,a);return r.join("&").replace(bt,"+")},Q.fn.extend({serialize:function(){return Q.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=Q.prop(this,"elements");return e?Q.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!Q(this).is(":disabled")&&Ct.test(this.nodeName)&&!$t.test(e)&&(this.checked||!$e.test(e))}).map(function(e,t){var n=Q(this).val();return null==n?null:Q.isArray(n)?Q.map(n,function(e){return{name:t.name,value:e.replace(wt,"\r\n")}}):{name:t.name,value:n.replace(wt,"\r\n")}}).get()}}),Q.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var _t=0,Et={},At={0:200,1223:204},kt=Q.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",function(){for(var e in Et)Et[e]()}),J.cors=!!kt&&"withCredentials"in kt,J.ajax=kt=!!kt,Q.ajaxTransport(function(e){var t;if(J.cors||kt&&!e.crossDomain)return{send:function(n,r){var a,i=e.xhr(),o=++_t;if(i.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)i[a]=e.xhrFields[a];e.mimeType&&i.overrideMimeType&&i.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(a in n)i.setRequestHeader(a,n[a]);t=function(e){return function(){t&&(delete Et[o],t=i.onload=i.onerror=null,"abort"===e?i.abort():"error"===e?r(i.status,i.statusText):r(At[i.status]||i.status,i.statusText,"string"==typeof i.responseText?{text:i.responseText}:void 0,i.getAllResponseHeaders()))}},i.onload=t(),i.onerror=t("error"),t=Et[o]=t("abort");try{i.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}}),Q.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return Q.globalEval(e),e}}}),Q.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),Q.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,a){t=Q("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&a("error"===e.type?404:200,e.type)}),X.head.appendChild(t[0])},abort:function(){n&&n()}}}});var St=[],Dt=/(=)\?(?=&|$)|\?\?/;Q.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=St.pop()||Q.expando+"_"+it++;return this[e]=!0,e}}),Q.ajaxPrefilter("json jsonp",function(t,n,r){var a,i,o,s=!1!==t.jsonp&&(Dt.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Dt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return a=t.jsonpCallback=Q.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Dt,"$1"+a):!1!==t.jsonp&&(t.url+=(ot.test(t.url)?"&":"?")+t.jsonp+"="+a),t.converters["script json"]=function(){return o||Q.error(a+" was not called"),o[0]},t.dataTypes[0]="json",i=e[a],e[a]=function(){o=arguments},r.always(function(){e[a]=i,t[a]&&(t.jsonpCallback=n.jsonpCallback,St.push(a)),o&&Q.isFunction(i)&&i(o[0]),o=i=void 0}),"script"}),Q.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||X;var r=ie.exec(e),a=!n&&[];return r?[t.createElement(r[1])]:(r=Q.buildFragment([e],t,a),a&&a.length&&Q(a).remove(),Q.merge([],r.childNodes))};var Tt=Q.fn.load;Q.fn.load=function(e,t,n){if("string"!=typeof e&&Tt)return Tt.apply(this,arguments);var r,a,i,o=this,s=e.indexOf(" ");return s>=0&&(r=Q.trim(e.slice(s)),e=e.slice(0,s)),Q.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(a="POST"),o.length>0&&Q.ajax({url:e,type:a,dataType:"html",data:t}).done(function(e){i=arguments,o.html(r?Q("<div>").append(Q.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,i||[e.responseText,t,e])}),this},Q.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){Q.fn[t]=function(e){return this.on(t,e)}}),Q.expr.filters.animated=function(e){return Q.grep(Q.timers,function(t){return e===t.elem}).length};var Ft=e.document.documentElement;Q.offset={setOffset:function(e,t,n){var r,a,i,o,s,l,u=Q.css(e,"position"),c=Q(e),d={};"static"===u&&(e.style.position="relative"),s=c.offset(),i=Q.css(e,"top"),l=Q.css(e,"left"),("absolute"===u||"fixed"===u)&&(i+l).indexOf("auto")>-1?(o=(r=c.position()).top,a=r.left):(o=parseFloat(i)||0,a=parseFloat(l)||0),Q.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(d.top=t.top-s.top+o),null!=t.left&&(d.left=t.left-s.left+a),"using"in t?t.using.call(e,d):c.css(d)}},Q.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){Q.offset.setOffset(this,e,t)});var t,n,r=this[0],a={top:0,left:0},i=r&&r.ownerDocument;if(i)return t=i.documentElement,Q.contains(t,r)?(void 0!==r.getBoundingClientRect&&(a=r.getBoundingClientRect()),n=I(i),{top:a.top+n.pageYOffset-t.clientTop,left:a.left+n.pageXOffset-t.clientLeft}):a},position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===Q.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),Q.nodeName(e[0],"html")||(r=e.offset()),r.top+=Q.css(e[0],"borderTopWidth",!0),r.left+=Q.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-Q.css(n,"marginTop",!0),left:t.left-r.left-Q.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Ft;e&&!Q.nodeName(e,"html")&&"static"===Q.css(e,"position");)e=e.offsetParent;return e||Ft})}}),Q.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;Q.fn[t]=function(a){return he(this,function(t,a,i){var o=I(t);if(void 0===i)return o?o[n]:t[a];o?o.scrollTo(r?e.pageXOffset:i,r?i:e.pageYOffset):t[a]=i},t,a,arguments.length,null)}}),Q.each(["top","left"],function(e,t){Q.cssHooks[t]=$(J.pixelPosition,function(e,n){if(n)return n=w(e,t),qe.test(n)?Q(e).position()[t]+"px":n})}),Q.each({Height:"height",Width:"width"},function(e,t){Q.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){Q.fn[r]=function(r,a){var i=arguments.length&&(n||"boolean"!=typeof r),o=n||(!0===r||!0===a?"margin":"border");return he(this,function(t,n,r){var a;return Q.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(a=t.documentElement,Math.max(t.body["scroll"+e],a["scroll"+e],t.body["offset"+e],a["offset"+e],a["client"+e])):void 0===r?Q.css(t,n,o):Q.style(t,n,r,o)},t,i?r:void 0,i,null)}})}),Q.fn.size=function(){return this.length},Q.fn.andSelf=Q.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Q});var Mt=e.jQuery,Lt=e.$;return Q.noConflict=function(t){return e.$===Q&&(e.$=Lt),t&&e.jQuery===Q&&(e.jQuery=Mt),Q},void 0===t&&(e.jQuery=e.$=Q),Q}),function(){var e,t,n,r,a,i,o,s,l,u,c,d,f,p,h,g,m,v,y,b,x,w,$,C,_,E,A,k,S,D,T,F,M;o=function(t,n,r,a){return new e(t,n,r,a)},"undefined"!=typeof module&&null!==module&&null!=module.exports&&(module.exports=o),"function"==typeof define&&define.amd?define([],function(){return o}):("undefined"!=typeof exports&&null!==exports?exports:this).chroma=o,o.color=function(t,n,r,a){return new e(t,n,r,a)},o.hsl=function(t,n,r,a){return new e(t,n,r,a,"hsl")},o.hsv=function(t,n,r,a){return new e(t,n,r,a,"hsv")},o.rgb=function(t,n,r,a){return new e(t,n,r,a,"rgb")},o.hex=function(t){return new e(t)},o.css=function(t){return new e(t)},o.lab=function(t,n,r){return new e(t,n,r,"lab")},o.lch=function(t,n,r){return new e(t,n,r,"lch")},o.hsi=function(t,n,r){return new e(t,n,r,"hsi")},o.gl=function(t,n,r,a){return new e(255*t,255*n,255*r,a,"gl")},o.interpolate=function(t,n,r,a){return null==t||null==n?"#000":("string"===D(t)&&(t=new e(t)),"string"===D(n)&&(n=new e(n)),t.interpolate(r,n,a))},o.mix=o.interpolate,o.contrast=function(t,n){var r,a;return"string"===D(t)&&(t=new e(t)),"string"===D(n)&&(n=new e(n)),r=t.luminance(),a=n.luminance(),r>a?(r+.05)/(a+.05):(a+.05)/(r+.05)},o.luminance=function(e){return o(e).luminance()},o._Color=e,e=function(){function e(){var e,t,n,r,a,i,o,l,u,h,m,v,b,x,w;for(a=this,n=[],u=0,h=arguments.length;u<h;u++)null!=(t=arguments[u])&&n.push(t);if(0===n.length)i=(m=[255,0,255,1,"rgb"])[0],o=m[1],l=m[2],e=m[3],r=m[4];else if("array"===D(n[0])){if(3===n[0].length)i=(v=n[0])[0],o=v[1],l=v[2],e=1;else{if(4!==n[0].length)throw"unknown input argument";i=(b=n[0])[0],o=b[1],l=b[2],e=b[3]}r=null!=(x=n[1])?x:"rgb"}else"string"===D(n[0])?(i=n[0],r="hex"):"object"===D(n[0])?(i=(w=n[0]._rgb)[0],o=w[1],l=w[2],e=w[3],r="rgb"):n.length>=3&&(i=n[0],o=n[1],l=n[2]);3===n.length?(r="rgb",e=1):4===n.length?"string"===D(n[3])?(r=n[3],e=1):"number"===D(n[3])&&(r="rgb",e=n[3]):5===n.length&&(e=n[3],r=n[4]),null==e&&(e=1),"rgb"===r?a._rgb=[i,o,l,e]:"gl"===r?a._rgb=[255*i,255*o,255*l,e]:"hsl"===r?(a._rgb=f(i,o,l),a._rgb[3]=e):"hsv"===r?(a._rgb=p(i,o,l),a._rgb[3]=e):"hex"===r?a._rgb=c(i):"lab"===r?(a._rgb=g(i,o,l),a._rgb[3]=e):"lch"===r?(a._rgb=y(i,o,l),a._rgb[3]=e):"hsi"===r&&(a._rgb=d(i,o,l),a._rgb[3]=e),s(a._rgb)}return e.prototype.rgb=function(){return this._rgb.slice(0,3)},e.prototype.rgba=function(){return this._rgb},e.prototype.hex=function(){return $(this._rgb)},e.prototype.toString=function(){return this.name()},e.prototype.hsl=function(){return _(this._rgb)},e.prototype.hsv=function(){return E(this._rgb)},e.prototype.lab=function(){return A(this._rgb)},e.prototype.lch=function(){return k(this._rgb)},e.prototype.hsi=function(){return C(this._rgb)},e.prototype.gl=function(){return[this._rgb[0]/255,this._rgb[1]/255,this._rgb[2]/255,this._rgb[3]]},e.prototype.luminance=function(){return x(this._rgb)},e.prototype.name=function(){var e,t;e=this.hex();for(t in o.colors)if(e===o.colors[t])return t;return e},e.prototype.alpha=function(e){return arguments.length?(this._rgb[3]=e,this):this._rgb[3]},e.prototype.css=function(e){var t,n,r,a;return null==e&&(e="rgb"),n=this,r=n._rgb,3===e.length&&r[3]<1&&(e+="a"),"rgb"===e?e+"("+r.slice(0,3).map(Math.round).join(",")+")":"rgba"===e?e+"("+r.slice(0,3).map(Math.round).join(",")+","+r[3]+")":"hsl"===e||"hsla"===e?(t=n.hsl(),a=function(e){return Math.round(100*e)/100},t[0]=a(t[0]),t[1]=a(100*t[1])+"%",t[2]=a(100*t[2])+"%",4===e.length&&(t[3]=r[3]),e+"("+t.join(",")+")"):void 0},e.prototype.interpolate=function(t,n,r){var a,i,o,s,l,u,c,d,f,p,h,g,m;if(c=this,null==r&&(r="rgb"),"string"===D(n)&&(n=new e(n)),"hsl"===r||"hsv"===r||"lch"===r||"hsi"===r)"hsl"===r?(g=c.hsl(),m=n.hsl()):"hsv"===r?(g=c.hsv(),m=n.hsv()):"hsi"===r?(g=c.hsi(),m=n.hsi()):"lch"===r&&(g=c.lch(),m=n.lch()),"h"===r.substr(0,1)?(i=g[0],p=g[1],l=g[2],o=m[0],h=m[1],u=m[2]):(l=g[0],p=g[1],i=g[2],u=m[0],h=m[1],o=m[2]),isNaN(i)||isNaN(o)?isNaN(i)?isNaN(o)?a=Number.NaN:(a=o,1!==l&&0!==l||"hsv"===r||(f=h)):(a=i,1!==u&&0!==u||"hsv"===r||(f=p)):a=i+t*(o>i&&o-i>180?o-(i+360):o<i&&i-o>180?o+360-i:o-i),null==f&&(f=p+t*(h-p)),s=l+t*(u-l),d="h"===r.substr(0,1)?new e(a,f,s,r):new e(s,f,a,r);else if("rgb"===r)g=c._rgb,m=n._rgb,d=new e(g[0]+t*(m[0]-g[0]),g[1]+t*(m[1]-g[1]),g[2]+t*(m[2]-g[2]),r);else{if("lab"!==r)throw"color mode "+r+" is not supported";g=c.lab(),m=n.lab(),d=new e(g[0]+t*(m[0]-g[0]),g[1]+t*(m[1]-g[1]),g[2]+t*(m[2]-g[2]),r)}return d.alpha(c.alpha()+t*(n.alpha()-c.alpha())),d},e.prototype.premultiply=function(){var e,t;return t=this.rgb(),e=this.alpha(),o(t[0]*e,t[1]*e,t[2]*e,e)},e.prototype.darken=function(e){var t,n;return null==e&&(e=20),n=this,t=n.lch(),t[0]-=e,o.lch(t).alpha(n.alpha())},e.prototype.darker=function(e){return this.darken(e)},e.prototype.brighten=function(e){return null==e&&(e=20),this.darken(-e)},e.prototype.brighter=function(e){return this.brighten(e)},e.prototype.saturate=function(e){var t,n;return null==e&&(e=20),n=this,t=n.lch(),t[1]+=e,o.lch(t).alpha(n.alpha())},e.prototype.desaturate=function(e){return null==e&&(e=20),this.saturate(-e)},e}(),s=function(e){var t;for(t in e)t<3?(e[t]<0&&(e[t]=0),e[t]>255&&(e[t]=255)):3===t&&(e[t]<0&&(e[t]=0),e[t]>1&&(e[t]=1));return e},u=function(e){var t,n,r,a,i,s,l,u;if(e=e.toLowerCase(),null!=o.colors&&o.colors[e])return c(o.colors[e]);if(r=e.match(/rgb\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*\)/)){for(a=r.slice(1,4),n=i=0;i<=2;n=++i)a[n]=+a[n];a[3]=1}else if(r=e.match(/rgba\(\s*(\-?\d+),\s*(\-?\d+)\s*,\s*(\-?\d+)\s*,\s*([01]|[01]?\.\d+)\)/))for(a=r.slice(1,5),n=s=0;s<=3;n=++s)a[n]=+a[n];else if(r=e.match(/rgb\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/)){for(a=r.slice(1,4),n=l=0;l<=2;n=++l)a[n]=Math.round(2.55*a[n]);a[3]=1}else if(r=e.match(/rgba\(\s*(\-?\d+(?:\.\d+)?)%,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/)){for(a=r.slice(1,5),n=u=0;u<=2;n=++u)a[n]=Math.round(2.55*a[n]);a[3]=+a[3]}else(r=e.match(/hsl\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*\)/))?((t=r.slice(1,4))[1]*=.01,t[2]*=.01,(a=f(t))[3]=1):(r=e.match(/hsla\(\s*(\-?\d+(?:\.\d+)?),\s*(\-?\d+(?:\.\d+)?)%\s*,\s*(\-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)/))&&((t=r.slice(1,4))[1]*=.01,t[2]*=.01,(a=f(t))[3]=+r[4]);return a},c=function(e){var t,n,r,a,i,o;if(e.match(/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/))return 4!==e.length&&7!==e.length||(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]),o=parseInt(e,16),a=o>>16,r=o>>8&255,n=255&o,[a,r,n,1];if(e.match(/^#?([A-Fa-f0-9]{8})$/))return 9===e.length&&(e=e.substr(1)),o=parseInt(e,16),a=o>>24&255,r=o>>16&255,n=o>>8&255,t=255&o,[a,r,n,t];if(i=u(e))return i;throw"unknown color: "+e},d=function(e,r,a){var i,o,s,u;return u=T(arguments),e=u[0],r=u[1],a=u[2],e/=360,e<1/3?o=1-((i=(1-r)/3)+(s=(1+r*l(n*e)/l(t-n*e))/3)):e<2/3?i=1-((s=(1-r)/3)+(o=(1+r*l(n*(e-=1/3))/l(t-n*e))/3)):s=1-((o=(1-r)/3)+(i=(1+r*l(n*(e-=2/3))/l(t-n*e))/3)),s=b(a*s*3),o=b(a*o*3),i=b(a*i*3),[255*s,255*o,255*i]},f=function(){var e,t,n,r,a,i,o,s,l,u,c,d,f,p;if(f=T(arguments),r=f[0],s=f[1],i=f[2],0===s)o=n=e=255*i;else{for(c=[0,0,0],t=[0,0,0],l=2*i-(u=i<.5?i*(1+s):i+s-i*s),r/=360,c[0]=r+1/3,c[1]=r,c[2]=r-1/3,a=d=0;d<=2;a=++d)c[a]<0&&(c[a]+=1),c[a]>1&&(c[a]-=1),6*c[a]<1?t[a]=l+6*(u-l)*c[a]:2*c[a]<1?t[a]=u:3*c[a]<2?t[a]=l+(u-l)*(2/3-c[a])*6:t[a]=l;o=(p=[Math.round(255*t[0]),Math.round(255*t[1]),Math.round(255*t[2])])[0],n=p[1],e=p[2]}return[o,n,e]},p=function(){var e,t,n,r,a,i,o,s,l,u,c,d,f,p,h,g,m,v;if(d=T(arguments),r=d[0],l=d[1],c=d[2],c*=255,0===l)s=n=e=c;else switch(360===r&&(r=0),r>360&&(r-=360),r<0&&(r+=360),r/=60,a=Math.floor(r),t=r-a,i=c*(1-l),o=c*(1-l*t),u=c*(1-l*(1-t)),a){case 0:s=(f=[c,u,i])[0],n=f[1],e=f[2];break;case 1:s=(p=[o,c,i])[0],n=p[1],e=p[2];break;case 2:s=(h=[i,c,u])[0],n=h[1],e=h[2];break;case 3:s=(g=[i,o,c])[0],n=g[1],e=g[2];break;case 4:s=(m=[u,i,c])[0],n=m[1],e=m[2];break;case 5:s=(v=[c,i,o])[0],n=v[1],e=v[2]}return s=Math.round(s),n=Math.round(n),e=Math.round(e),[s,n,e]},r=.95047,a=1.08883,h=function(){var e,t,n,r,a,i;return i=T(arguments),a=i[0],e=i[1],t=i[2],n=Math.sqrt(e*e+t*t),r=Math.atan2(t,e)/Math.PI*180,[a,n,r]},g=function(e,t,n){var i,o,s,l,u,c,d;return void 0!==e&&3===e.length&&(e=(c=e)[0],t=c[1],n=c[2]),void 0!==e&&3===e.length&&(e=(d=e)[0],t=d[1],n=d[2]),l=(e+16)/116,s=l+t/500,u=l-n/200,s=m(s)*r,l=1*m(l),u=m(u)*a,o=M(3.2404542*s-1.5371385*l-.4985314*u),i=M(-.969266*s+1.8760108*l+.041556*u),n=M(.0556434*s-.2040259*l+1.0572252*u),[b(o,0,255),b(i,0,255),b(n,0,255),1]},m=function(e){return e>.206893034?e*e*e:(e-4/29)/7.787037},M=function(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))},v=function(){var e,t,n,r;return r=T(arguments),n=r[0],e=r[1],t=r[2],t=t*Math.PI/180,[n,Math.cos(t)*e,Math.sin(t)*e]},y=function(e,t,n){var r,a,i,o,s,l,u;return l=v(e,t,n),r=l[0],a=l[1],i=l[2],u=g(r,a,i),s=u[0],o=u[1],i=u[2],[b(s,0,255),b(o,0,255),b(i,0,255)]},x=function(e,t,n){var r;return r=T(arguments),e=r[0],t=r[1],n=r[2],e=w(e),t=w(t),n=w(n),.2126*e+.7152*t+.0722*n},w=function(e){return e/=255,e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)},$=function(){var e,t,n,r,a,i;return i=T(arguments),n=i[0],t=i[1],e=i[2],a=n<<16|t<<8|e,"#"+(r="000000"+a.toString(16)).substr(r.length-6)},C=function(){var e,t,n,r,a,i,o,s,l;return l=T(arguments),o=l[0],n=l[1],t=l[2],e=2*Math.PI,o/=255,n/=255,t/=255,i=Math.min(o,n,t),a=(o+n+t)/3,s=1-i/a,0===s?r=0:(r=(o-n+(o-t))/2,r/=Math.sqrt((o-n)*(o-n)+(o-t)*(n-t)),r=Math.acos(r),t>n&&(r=e-r),r/=e),[360*r,s,a]},_=function(e,t,n){var r,a,i,o,s,l;return void 0!==e&&e.length>=3&&(e=(l=e)[0],t=l[1],n=l[2]),e/=255,t/=255,n/=255,o=Math.min(e,t,n),i=Math.max(e,t,n),a=(i+o)/2,i===o?(s=0,r=Number.NaN):s=a<.5?(i-o)/(i+o):(i-o)/(2-i-o),e===i?r=(t-n)/(i-o):t===i?r=2+(n-e)/(i-o):n===i&&(r=4+(e-t)/(i-o)),(r*=60)<0&&(r+=360),[r,s,a]},E=function(){var e,t,n,r,a,i,o,s,l,u;return u=T(arguments),o=u[0],n=u[1],e=u[2],i=Math.min(o,n,e),a=Math.max(o,n,e),t=a-i,l=a/255,0===a?(r=Number.NaN,s=0):(s=t/a,o===a&&(r=(n-e)/t),n===a&&(r=2+(e-o)/t),e===a&&(r=4+(o-n)/t),(r*=60)<0&&(r+=360)),[r,s,l]},A=function(){var e,t,n,i,o,s,l;return l=T(arguments),n=l[0],t=l[1],e=l[2],n=S(n),t=S(t),e=S(e),i=F((.4124564*n+.3575761*t+.1804375*e)/r),o=F((.2126729*n+.7151522*t+.072175*e)/1),s=F((.0193339*n+.119192*t+.9503041*e)/a),[116*o-16,500*(i-o),200*(o-s)]},S=function(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)},F=function(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29},k=function(){var e,t,n,r,a,i,o;return i=T(arguments),a=i[0],n=i[1],t=i[2],o=A(a,n,t),r=o[0],e=o[1],t=o[2],h(r,e,t)},o.scale=function(e,t){var n,r,a,i,s,l,u,c,d,f,p,h,g,m,v,y,b,x,w;return m="rgb",v=o("#ccc"),w=0,!1,p=[0,1],d=[],b=!1,x=[],g=0,h=1,f=!1,y=0,c={},s=function(e,t){var n,r,a,s,l,u,c;if(null==e&&(e=["#ddd","#222"]),null!=e&&"string"===D(e)&&null!=(null!=(l=o.brewer)?l[e]:void 0)&&(e=o.brewer[e]),"array"===D(e)){for(n=a=0,u=(e=e.slice(0)).length-1;0<=u?a<=u:a>=u;n=0<=u?++a:--a)r=e[n],"string"===D(r)&&(e[n]=o(r));if(null!=t)x=t;else for(x=[],n=s=0,c=e.length-1;0<=c?s<=c:s>=c;n=0<=c?++s:--s)x.push(n/(e.length-1))}return i(),d=e},l=function(e){return null==e&&(e=[]),p=e,g=e[0],h=e[e.length-1],i(),y=2===e.length?0:e.length-1},r=function(e){var t,n;if(null!=p){for(n=p.length-1,t=0;t<n&&e>=p[t];)t++;return t-1}return 0},u=function(e){return e},function(e){var t,n,a,i,o;return o=e,p.length>2&&(i=p.length-1,t=r(e),a=p[0]+(p[1]-p[0])*(0+.5*w),n=p[i-1]+(p[i]-p[i-1])*(1-.5*w),o=g+(p[t]+.5*(p[t+1]-p[t])-a)/(n-a)*(h-g)),o},a=function(e,t){var n,a,i,s,l,f,b;if(null==t&&(t=!1),isNaN(e))return v;if(t?l=e:p.length>2?l=r(e)/(y-1):h!==g?(l=(e-g)/(h-g),l=Math.min(1,Math.max(0,l))):l=g,t||(l=u(l)),i=Math.floor(1e4*l),c[i])n=c[i];else{if("array"===D(d))for(a=f=0,b=x.length-1;0<=b?f<=b:f>=b;a=0<=b?++f:--f){if(s=x[a],l<=s){n=d[a];break}if(l>=s&&a===x.length-1){n=d[a];break}if(l>s&&l<x[a+1]){l=(l-s)/(x[a+1]-s),n=o.interpolate(d[a],d[a+1],l,m);break}}else"function"===D(d)&&(n=d(l));c[i]=n}return n},i=function(){return c={}},s(e,t),n=function(e){var t;return t=a(e),b&&t[b]?t[b]():t},n.domain=function(e,t,r,a){var i;return null==r&&(r="e"),arguments.length?(null!=t&&(i=o.analyze(e,a),e=0===t?[i.min,i.max]:o.limits(i,r,t)),l(e),n):p},n.mode=function(e){return arguments.length?(m=e,i(),n):m},n.range=function(e,t){return s(e,t),n},n.out=function(e){return b=e,n},n.spread=function(e){return arguments.length?(w=e,n):w},n.correctLightness=function(e){return arguments.length?(f=e,i(),u=f?function(e){var t,n,r,i,o,s,l,u,c;for(t=a(0,!0).lab()[0],n=a(1,!0).lab()[0],l=t>n,r=a(e,!0).lab()[0],i=r-(o=t+(n-t)*e),u=0,c=1,s=20;Math.abs(i)>.01&&s-- >0;)!function(){l&&(i*=-1),i<0?(u=e,e+=.5*(c-e)):(c=e,e+=.5*(u-e)),r=a(e,!0).lab()[0],i=r-o}();return e}:function(e){return e},n):f},n.colors=function(t){var r,a,i,o,s,l;if(null==t&&(t="hex"),e=[],a=[],p.length>2)for(r=i=1,l=p.length;1<=l?i<l:i>l;r=1<=l?++i:--i)a.push(.5*(p[r-1]+p[r]));else a=p;for(o=0,s=a.length;o<s;o++)r=a[o],e.push(n(r)[t]());return e},n},null==o.scales&&(o.scales={}),o.scales.cool=function(){return o.scale([o.hsl(180,1,.9),o.hsl(250,.7,.4)])},o.scales.hot=function(){return o.scale(["#000","#f00","#ff0","#fff"],[0,.25,.75,1]).mode("rgb")},o.analyze=function(e,t,n){var r,a,i,s,l,u;if(i={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0},null==n&&(n=function(){return!0}),r=function(e){null==e||isNaN(e)||(i.values.push(e),i.sum+=e,e<i.min&&(i.min=e),e>i.max&&(i.max=e),i.count+=1)},s=function(e,a){if(n(e,a))return r(null!=t&&"function"===D(t)?t(e):null!=t&&"string"===D(t)||"number"===D(t)?e[t]:e)},"array"===D(e))for(l=0,u=e.length;l<u;l++)s(e[l]);else for(a in e)s(e[a],a);return i.domain=[i.min,i.max],i.limits=function(e,t){return o.limits(i,e,t)},i},o.limits=function(e,t,n){var r,a,i,s,l,u,c,d,f,p,h,g,m,v,y,b,x,w,$,C,_,E,A,k,S,T,F,M,L,O,N,j,P,B,q,R,I,U,z,V,H,Y,G,W,Z,J,X,Q,K,ee,te,ne,re,ae,ie;if(null==t&&(t="equal"),null==n&&(n=7),"array"===D(e)&&(e=o.analyze(e)),m=e.min,h=e.max,e.sum,S=e.values.sort(function(e,t){return e-t}),p=[],"c"===t.substr(0,1)&&(p.push(m),p.push(h)),"e"===t.substr(0,1)){for(p.push(m),c=T=1,R=n-1;1<=R?T<=R:T>=R;c=1<=R?++T:--T)p.push(m+c/n*(h-m));p.push(h)}else if("l"===t.substr(0,1)){if(m<=0)throw"Logarithmic scales are only possible for values > 0";for(v=Math.LOG10E*Math.log(m),g=Math.LOG10E*Math.log(h),p.push(m),c=F=1,G=n-1;1<=G?F<=G:F>=G;c=1<=G?++F:--F)p.push(Math.pow(10,v+c/n*(g-v)));p.push(h)}else if("q"===t.substr(0,1)){for(p.push(m),c=M=1,W=n-1;1<=W?M<=W:M>=W;c=1<=W?++M:--M)$=S.length*c/n,(C=Math.floor($))===$?p.push(S[C]):(_=$-C,p.push(S[C]*_+S[C+1]*(1-_)));p.push(h)}else if("k"===t.substr(0,1)){for(b=S.length,r=new Array(b),l=new Array(n),E=!0,x=0,i=null,(i=[]).push(m),c=L=1,Z=n-1;1<=Z?L<=Z:L>=Z;c=1<=Z?++L:--L)i.push(m+c/n*(h-m));for(i.push(h);E;){for(d=O=0,J=n-1;0<=J?O<=J:O>=J;d=0<=J?++O:--O)l[d]=0;for(c=N=0,X=b-1;0<=X?N<=X:N>=X;c=0<=X?++N:--N){for(k=S[c],y=Number.MAX_VALUE,d=j=0,Q=n-1;0<=Q?j<=Q:j>=Q;d=0<=Q?++j:--j)(u=Math.abs(i[d]-k))<y&&(y=u,a=d);l[a]++,r[c]=a}for(w=new Array(n),d=P=0,K=n-1;0<=K?P<=K:P>=K;d=0<=K?++P:--P)w[d]=null;for(c=B=0,ee=b-1;0<=ee?B<=ee:B>=ee;c=0<=ee?++B:--B)null===w[s=r[c]]?w[s]=S[c]:w[s]+=S[c];for(d=q=0,I=n-1;0<=I?q<=I:q>=I;d=0<=I?++q:--q)w[d]*=1/l[d];for(E=!1,d=te=0,U=n-1;0<=U?te<=U:te>=U;d=0<=U?++te:--te)if(w[d]!==i[c]){E=!0;break}i=w,++x>200&&(E=!1)}for(f={},d=ne=0,z=n-1;0<=z?ne<=z:ne>=z;d=0<=z?++ne:--ne)f[d]=[];for(c=re=0,V=b-1;0<=V?re<=V:re>=V;c=0<=V?++re:--re)f[s=r[c]].push(S[c]);for(A=[],d=ae=0,H=n-1;0<=H?ae<=H:ae>=H;d=0<=H?++ae:--ae)A.push(f[d][0]),A.push(f[d][f[d].length-1]);for(A=A.sort(function(e,t){return e-t}),p.push(A[0]),c=ie=1,Y=A.length-1;ie<=Y;c=ie+=2)isNaN(A[c])||p.push(A[c])}return p},o.brewer={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},o.colors={indigo:"#4b0082",gold:"#ffd700",hotpink:"#ff69b4",firebrick:"#b22222",indianred:"#cd5c5c",yellow:"#ffff00",mistyrose:"#ffe4e1",darkolivegreen:"#556b2f",olive:"#808000",darkseagreen:"#8fbc8f",pink:"#ffc0cb",tomato:"#ff6347",lightcoral:"#f08080",orangered:"#ff4500",navajowhite:"#ffdead",lime:"#00ff00",palegreen:"#98fb98",darkslategrey:"#2f4f4f",greenyellow:"#adff2f",burlywood:"#deb887",seashell:"#fff5ee",mediumspringgreen:"#00fa9a",fuchsia:"#ff00ff",papayawhip:"#ffefd5",blanchedalmond:"#ffebcd",chartreuse:"#7fff00",dimgray:"#696969",black:"#000000",peachpuff:"#ffdab9",springgreen:"#00ff7f",aquamarine:"#7fffd4",white:"#ffffff",orange:"#ffa500",lightsalmon:"#ffa07a",darkslategray:"#2f4f4f",brown:"#a52a2a",ivory:"#fffff0",dodgerblue:"#1e90ff",peru:"#cd853f",lawngreen:"#7cfc00",chocolate:"#d2691e",crimson:"#dc143c",forestgreen:"#228b22",darkgrey:"#a9a9a9",lightseagreen:"#20b2aa",cyan:"#00ffff",mintcream:"#f5fffa",silver:"#c0c0c0",antiquewhite:"#faebd7",mediumorchid:"#ba55d3",skyblue:"#87ceeb",gray:"#808080",darkturquoise:"#00ced1",goldenrod:"#daa520",darkgreen:"#006400",floralwhite:"#fffaf0",darkviolet:"#9400d3",darkgray:"#a9a9a9",moccasin:"#ffe4b5",saddlebrown:"#8b4513",grey:"#808080",darkslateblue:"#483d8b",lightskyblue:"#87cefa",lightpink:"#ffb6c1",mediumvioletred:"#c71585",slategrey:"#708090",red:"#ff0000",deeppink:"#ff1493",limegreen:"#32cd32",darkmagenta:"#8b008b",palegoldenrod:"#eee8aa",plum:"#dda0dd",turquoise:"#40e0d0",lightgrey:"#d3d3d3",lightgoldenrodyellow:"#fafad2",darkgoldenrod:"#b8860b",lavender:"#e6e6fa",maroon:"#800000",yellowgreen:"#9acd32",sandybrown:"#f4a460",thistle:"#d8bfd8",violet:"#ee82ee",navy:"#000080",magenta:"#ff00ff",dimgrey:"#696969",tan:"#d2b48c",rosybrown:"#bc8f8f",olivedrab:"#6b8e23",blue:"#0000ff",lightblue:"#add8e6",ghostwhite:"#f8f8ff",honeydew:"#f0fff0",cornflowerblue:"#6495ed",slateblue:"#6a5acd",linen:"#faf0e6",darkblue:"#00008b",powderblue:"#b0e0e6",seagreen:"#2e8b57",darkkhaki:"#bdb76b",snow:"#fffafa",sienna:"#a0522d",mediumblue:"#0000cd",royalblue:"#4169e1",lightcyan:"#e0ffff",green:"#008000",mediumpurple:"#9370db",midnightblue:"#191970",cornsilk:"#fff8dc",paleturquoise:"#afeeee",bisque:"#ffe4c4",slategray:"#708090",darkcyan:"#008b8b",khaki:"#f0e68c",wheat:"#f5deb3",teal:"#008080",darkorchid:"#9932cc",deepskyblue:"#00bfff",salmon:"#fa8072",darkred:"#8b0000",steelblue:"#4682b4",palevioletred:"#db7093",lightslategray:"#778899",aliceblue:"#f0f8ff",lightslategrey:"#778899",lightgreen:"#90ee90",orchid:"#da70d6",gainsboro:"#dcdcdc",mediumseagreen:"#3cb371",lightgray:"#d3d3d3",mediumturquoise:"#48d1cc",lemonchiffon:"#fffacd",cadetblue:"#5f9ea0",lightyellow:"#ffffe0",lavenderblush:"#fff0f5",coral:"#ff7f50",purple:"#800080",aqua:"#00ffff",whitesmoke:"#f5f5f5",mediumslateblue:"#7b68ee",darkorange:"#ff8c00",mediumaquamarine:"#66cdaa",darksalmon:"#e9967a",beige:"#f5f5dc",blueviolet:"#8a2be2",azure:"#f0ffff",lightsteelblue:"#b0c4de",oldlace:"#fdf5e6"},D=function(){var e,t,n,r,a;for(e={},n=0,r=(a="Boolean Number String Function Array Date RegExp Undefined Null".split(" ")).length;n<r;n++)t=a[n],e["[object "+t+"]"]=t.toLowerCase();return function(t){var n;return n=Object.prototype.toString.call(t),e[n]||"object"}}(),b=function(e,t,n){return null==t&&(t=0),null==n&&(n=1),e<t&&(e=t),e>n&&(e=n),e},T=function(e){return e.length>=3?e:e[0]},n=2*Math.PI,t=Math.PI/3,l=Math.cos,i=function(e){var t,n,r,a,s,l,u,c,d,f,p;return e=function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)a=e[t],r.push(o(a));return r}(),2===e.length?(d=function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)a=e[t],r.push(a.lab());return r}(),s=d[0],l=d[1],t=function(e){var t,n;return n=function(){var n,r;for(r=[],t=n=0;n<=2;t=++n)r.push(s[t]+e*(l[t]-s[t]));return r}(),o.lab.apply(o,n)}):3===e.length?(f=function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)a=e[t],r.push(a.lab());return r}(),s=f[0],l=f[1],u=f[2],t=function(e){var t,n;return n=function(){var n,r;for(r=[],t=n=0;n<=2;t=++n)r.push((1-e)*(1-e)*s[t]+2*(1-e)*e*l[t]+e*e*u[t]);return r}(),o.lab.apply(o,n)}):4===e.length?(p=function(){var t,n,r;for(r=[],t=0,n=e.length;t<n;t++)a=e[t],r.push(a.lab());return r}(),s=p[0],l=p[1],u=p[2],c=p[3],t=function(e){var t,n;return n=function(){var n,r;for(r=[],t=n=0;n<=2;t=++n)r.push((1-e)*(1-e)*(1-e)*s[t]+3*(1-e)*(1-e)*e*l[t]+3*(1-e)*e*e*u[t]+e*e*e*c[t]);return r}(),o.lab.apply(o,n)}):5===e.length&&(n=i(e.slice(0,3)),r=i(e.slice(2,5)),t=function(e){return e<.5?n(2*e):r(2*(e-.5))}),t},o.interpolate.bezier=i}.call(this),function(e){var t={}.hasOwnProperty,n=function(e,n){var r;for(r in e)t.call(e,r)&&n(r,e[r])},r=function(e,t){return t?(n(t,function(t,n){e[t]=n}),e):e},a=/["'\\\b\f\n\r\t]/,i=/[ !#-&\(-\[\]-~]/,o=function(e,t){var n={es6:!1,json:!1},o=t&&t.json;t=r(n,t);var s,l,u,c=e,d=-1,f=c.length;for(s="";++d<f;){var p=c.charAt(d);if(t.es6&&(l=c.charCodeAt(d))>=55296&&l<=56319&&f>d+1&&(u=c.charCodeAt(d+1))>=56320&&u<=57343)s+="\\u{"+(1024*(l-55296)+u-56320+65536).toString(16).toUpperCase()+"}",d++;else if(i.test(p))s+=p;else if('"'!=p)if("'"!=p)if(a.test(p))s+=p;else{var h=p.charCodeAt(0).toString(16).toUpperCase(),g=h.length>2||o;s+="\\"+(g?"u":"x")+("0000"+h).slice(g?-4:-2)}else s+=p;else s+=p}return s};o.version="0.5.0",e.jsesc=o}(this),function(e){var t=function(){"use strict";var e=function(e){var t=-e.getTimezoneOffset();return null!==t?t:0},n=function(e,t,n){var r=new Date;return void 0!==e&&r.setFullYear(e),r.setMonth(t),r.setDate(n),r},r=function(t){return e(n(t,0,2))},a=function(t){return e(n(t,5,2))},i=function(){var e=r(),t=a(),n=e-t;return n<0?e+",1":n>0?t+",1,s":e+",0"};return{determine:function(){var e=i();return new t.TimeZone(t.olson.timezones[e])},date_is_dst:function(t){var n=t.getMonth()>7,i=n?a(t.getFullYear()):r(t.getFullYear()),o=i-e(t);return i<0||n?0!==o:o<0},dst_start_for:function(e){var t=new Date(2010,6,15,1,0,0,0);return{"America/Denver":new Date(2011,2,13,3,0,0,0),"America/Mazatlan":new Date(2011,3,3,3,0,0,0),"America/Chicago":new Date(2011,2,13,3,0,0,0),"America/Mexico_City":new Date(2011,3,3,3,0,0,0),"America/Asuncion":new Date(2012,9,7,3,0,0,0),"America/Santiago":new Date(2012,9,3,3,0,0,0),"America/Campo_Grande":new Date(2012,9,21,5,0,0,0),"America/Montevideo":new Date(2011,9,2,3,0,0,0),"America/Sao_Paulo":new Date(2011,9,16,5,0,0,0),"America/Los_Angeles":new Date(2011,2,13,8,0,0,0),"America/Santa_Isabel":new Date(2011,3,5,8,0,0,0),"America/Havana":new Date(2012,2,10,2,0,0,0),"America/New_York":new Date(2012,2,10,7,0,0,0),"Europe/Helsinki":new Date(2013,2,31,5,0,0,0),"Pacific/Auckland":new Date(2011,8,26,7,0,0,0),"America/Halifax":new Date(2011,2,13,6,0,0,0),"America/Goose_Bay":new Date(2011,2,13,2,1,0,0),"America/Miquelon":new Date(2011,2,13,5,0,0,0),"America/Godthab":new Date(2011,2,27,1,0,0,0),"Europe/Moscow":t,"Asia/Amman":new Date(2013,2,29,1,0,0,0),"Asia/Beirut":new Date(2013,2,31,2,0,0,0),"Asia/Damascus":new Date(2013,3,6,2,0,0,0),"Asia/Jerusalem":new Date(2013,2,29,5,0,0,0),"Asia/Yekaterinburg":t,"Asia/Omsk":t,"Asia/Krasnoyarsk":t,"Asia/Irkutsk":t,"Asia/Yakutsk":t,"Asia/Vladivostok":t,"Asia/Baku":new Date(2013,2,31,4,0,0),"Asia/Yerevan":new Date(2013,2,31,3,0,0),"Asia/Kamchatka":t,"Asia/Gaza":new Date(2010,2,27,4,0,0),"Africa/Cairo":new Date(2010,4,1,3,0,0),"Europe/Minsk":t,"Pacific/Apia":new Date(2010,10,1,1,0,0,0),"Pacific/Fiji":new Date(2010,11,1,0,0,0),"Australia/Perth":new Date(2008,10,1,1,0,0,0)}[e]}}}();t.TimeZone=function(e){"use strict";var n={"America/Denver":["America/Denver","America/Mazatlan"],"America/Chicago":["America/Chicago","America/Mexico_City"],"America/Santiago":["America/Santiago","America/Asuncion","America/Campo_Grande"],"America/Montevideo":["America/Montevideo","America/Sao_Paulo"],"Asia/Beirut":["Asia/Amman","Asia/Jerusalem","Asia/Beirut","Europe/Helsinki","Asia/Damascus"],"Pacific/Auckland":["Pacific/Auckland","Pacific/Fiji"],"America/Los_Angeles":["America/Los_Angeles","America/Santa_Isabel"],"America/New_York":["America/Havana","America/New_York"],"America/Halifax":["America/Goose_Bay","America/Halifax"],"America/Godthab":["America/Miquelon","America/Godthab"],"Asia/Dubai":["Europe/Moscow"],"Asia/Dhaka":["Asia/Yekaterinburg"],"Asia/Jakarta":["Asia/Omsk"],"Asia/Shanghai":["Asia/Krasnoyarsk","Australia/Perth"],"Asia/Tokyo":["Asia/Irkutsk"],"Australia/Brisbane":["Asia/Yakutsk"],"Pacific/Noumea":["Asia/Vladivostok"],"Pacific/Tarawa":["Asia/Kamchatka","Pacific/Fiji"],"Pacific/Tongatapu":["Pacific/Apia"],"Asia/Baghdad":["Europe/Minsk"],"Asia/Baku":["Asia/Yerevan","Asia/Baku"],"Africa/Johannesburg":["Asia/Gaza","Africa/Cairo"]},r=e;return function(){return void 0!==n[r]}()&&function(){for(var e=n[r],a=e.length,i=0,o=e[0];i<a;i+=1)if(o=e[i],t.date_is_dst(t.dst_start_for(o)))return void(r=o)}(),{name:function(){return r}}},t.olson={},t.olson.timezones={"-720,0":"Pacific/Majuro","-660,0":"Pacific/Pago_Pago","-600,1":"America/Adak","-600,0":"Pacific/Honolulu","-570,0":"Pacific/Marquesas","-540,0":"Pacific/Gambier","-540,1":"America/Anchorage","-480,1":"America/Los_Angeles","-480,0":"Pacific/Pitcairn","-420,0":"America/Phoenix","-420,1":"America/Denver","-360,0":"America/Guatemala","-360,1":"America/Chicago","-360,1,s":"Pacific/Easter","-300,0":"America/Bogota","-300,1":"America/New_York","-270,0":"America/Caracas","-240,1":"America/Halifax","-240,0":"America/Santo_Domingo","-240,1,s":"America/Santiago","-210,1":"America/St_Johns","-180,1":"America/Godthab","-180,0":"America/Argentina/Buenos_Aires","-180,1,s":"America/Montevideo","-120,0":"America/Noronha","-120,1":"America/Noronha","-60,1":"Atlantic/Azores","-60,0":"Atlantic/Cape_Verde","0,0":"UTC","0,1":"Europe/London","60,1":"Europe/Berlin","60,0":"Africa/Lagos","60,1,s":"Africa/Windhoek","120,1":"Asia/Beirut","120,0":"Africa/Johannesburg","180,0":"Asia/Baghdad","180,1":"Europe/Moscow","210,1":"Asia/Tehran","240,0":"Asia/Dubai","240,1":"Asia/Baku","270,0":"Asia/Kabul","300,1":"Asia/Yekaterinburg","300,0":"Asia/Karachi","330,0":"Asia/Kolkata","345,0":"Asia/Kathmandu","360,0":"Asia/Dhaka","360,1":"Asia/Omsk","390,0":"Asia/Rangoon","420,1":"Asia/Krasnoyarsk","420,0":"Asia/Jakarta","480,0":"Asia/Shanghai","480,1":"Asia/Irkutsk","525,0":"Australia/Eucla","525,1,s":"Australia/Eucla","540,1":"Asia/Yakutsk","540,0":"Asia/Tokyo","570,0":"Australia/Darwin","570,1,s":"Australia/Adelaide","600,0":"Australia/Brisbane","600,1":"Asia/Vladivostok","600,1,s":"Australia/Sydney","630,1,s":"Australia/Lord_Howe","660,1":"Asia/Kamchatka","660,0":"Pacific/Noumea","690,0":"Pacific/Norfolk","720,1,s":"Pacific/Auckland","720,0":"Pacific/Tarawa","765,1,s":"Pacific/Chatham","780,0":"Pacific/Tongatapu","780,1,s":"Pacific/Apia","840,0":"Pacific/Kiritimati"},"undefined"!=typeof exports?exports.jstz=t:e.jstz=t}(this),LazyLoad=function(e){function t(t,n){var r,a=e.createElement(t);for(r in n)n.hasOwnProperty(r)&&a.setAttribute(r,n[r]);return a}function n(e){var t,n,r=u[e];r&&(t=r.callback,(n=r.urls).shift(),c=0,n.length||(t&&t.call(r.context,r.obj),u[e]=null,d[e].length&&a(e)))}function r(){var t=navigator.userAgent;((s={async:!0===e.createElement("script").async}).webkit=/AppleWebKit\//.test(t))||(s.ie=/MSIE|Trident/.test(t))||(s.opera=/Opera/.test(t))||(s.gecko=/Gecko\//.test(t))||(s.unknown=!0)}function a(a,c,f,p,h){var g,m,v,y,b,x,w=function(){n(a)},$="css"===a,C=[];if(s||r(),c)if(c="string"==typeof c?[c]:c.concat(),$||s.async||s.gecko||s.opera)d[a].push({urls:c,callback:f,obj:p,context:h});else for(g=0,m=c.length;g<m;++g)d[a].push({urls:[c[g]],callback:g===m-1?f:null,obj:p,context:h});if(!u[a]&&(y=u[a]=d[a].shift())){for(l||(l=e.head||e.getElementsByTagName("head")[0]),g=0,m=(b=y.urls.concat()).length;g<m;++g)x=b[g],$?v=s.gecko?t("style"):t("link",{href:x,rel:"stylesheet"}):(v=t("script",{src:x})).async=!1,v.className="lazyload",v.setAttribute("charset","utf-8"),s.ie&&!$&&"onreadystatechange"in v&&!("draggable"in v)?v.onreadystatechange=function(){/loaded|complete/.test(v.readyState)&&(v.onreadystatechange=null,w())}:$&&(s.gecko||s.webkit)?s.webkit?(y.urls[g]=v.href,o()):(v.innerHTML='@import "'+x+'";',i(v)):v.onload=v.onerror=w,C.push(v);for(g=0,m=C.length;g<m;++g)l.appendChild(C[g])}}function i(e){var t;try{t=!!e.sheet.cssRules}catch(r){return c+=1,void(c<200?setTimeout(function(){i(e)},50):t&&n("css"))}n("css")}function o(){var e,t=u.css;if(t){for(e=f.length;--e>=0;)if(f[e].href===t.urls[0]){n("css");break}c+=1,t&&(c<200?setTimeout(o,50):n("css"))}}var s,l,u={},c=0,d={css:[],js:[]},f=e.styleSheets;return{css:function(e,t,n,r){a("css",e,t,n,r)},js:function(e,t,n,r){a("js",e,t,n,r)}}}(this.document),window.Modernizr=function(e,t,n){function r(e){c.cssText=e}function a(e,t){return typeof e===t}var i,o,s={},l=t.documentElement,u=t.createElement("modernizr"),c=u.style,d={svg:"http://www.w3.org/2000/svg"},f={},p=[],h=p.slice,g={}.hasOwnProperty;o=a(g,"undefined")||a(g.call,"undefined")?function(e,t){return t in e&&a(e.constructor.prototype[t],"undefined")}:function(e,t){return g.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var n=h.call(arguments,1),r=function(){if(this instanceof r){var a=function(){};a.prototype=t.prototype;var i=new a,o=t.apply(i,n.concat(h.call(arguments)));return Object(o)===o?o:i}return t.apply(e,n.concat(h.call(arguments)))};return r}),f.geolocation=function(){return"geolocation"in navigator},f.svg=function(){return!!t.createElementNS&&!!t.createElementNS(d.svg,"svg").createSVGRect},f.inlinesvg=function(){var e=t.createElement("div");return e.innerHTML="<svg/>",(e.firstChild&&e.firstChild.namespaceURI)==d.svg};for(var m in f)o(f,m)&&(i=m.toLowerCase(),s[i]=f[m](),p.push((s[i]?"":"no-")+i));return s.addTest=function(e,t){if("object"==typeof e)for(var r in e)o(e,r)&&s.addTest(r,e[r]);else{if(e=e.toLowerCase(),s[e]!==n)return s;t="function"==typeof t?t():t,l.className+=" "+(t?"":"no-")+e,s[e]=t}return s},r(""),u=null,function(e,t){function n(e,t){var n=e.createElement("p"),r=e.getElementsByTagName("head")[0]||e.documentElement;return n.innerHTML="x<style>"+t+"</style>",r.insertBefore(n.lastChild,r.firstChild)}function r(){var e=v.elements;return"string"==typeof e?e.split(" "):e}function a(e){var t=m[e[h]];return t||(t={},g++,e[h]=g,m[g]=t),t}function i(e,n,r){if(n||(n=t),c)return n.createElement(e);r||(r=a(n));var i;return i=r.cache[e]?r.cache[e].cloneNode():p.test(e)?(r.cache[e]=r.createElem(e)).cloneNode():r.createElem(e),!i.canHaveChildren||f.test(e)||i.tagUrn?i:r.frag.appendChild(i)}function o(e,n){if(e||(e=t),c)return e.createDocumentFragment();for(var i=(n=n||a(e)).frag.cloneNode(),o=0,s=r(),l=s.length;o<l;o++)i.createElement(s[o]);return i}function s(e,t){t.cache||(t.cache={},t.createElem=e.createElement,t.createFrag=e.createDocumentFragment,t.frag=t.createFrag()),e.createElement=function(n){return v.shivMethods?i(n,e,t):t.createElem(n)},e.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+r().join().replace(/[\w\-]+/g,function(e){return t.createElem(e),t.frag.createElement(e),'c("'+e+'")'})+");return n}")(v,t.frag)}function l(e){e||(e=t);var r=a(e);return!v.shivCSS||u||r.hasCSS||(r.hasCSS=!!n(e,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),c||s(e,r),e}var u,c,d=e.html5||{},f=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,p=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,h="_html5shiv",g=0,m={};!function(){try{var e=t.createElement("a");e.innerHTML="<xyz></xyz>",u="hidden"in e,c=1==e.childNodes.length||function(){t.createElement("a");var e=t.createDocumentFragment();return void 0===e.cloneNode||void 0===e.createDocumentFragment||void 0===e.createElement}()}catch(e){u=!0,c=!0}}();var v={elements:d.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:"3.7.0",shivCSS:!1!==d.shivCSS,supportsUnknownElements:c,shivMethods:!1!==d.shivMethods,type:"default",shivDocument:l,createElement:i,createDocumentFragment:o};e.html5=v,l(t)}(this,t),s._version="2.8.3",l.className=l.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+" js "+p.join(" "),s}(0,this.document),function(e,t,n){function r(e){return"[object Function]"==m.call(e)}function a(e){return"string"==typeof e}function i(){}function o(e){return!e||"loaded"==e||"complete"==e||"uninitialized"==e}function s(){var e=v.shift();y=1,e?e.t?h(function(){("c"==e.t?f.injectCss:f.injectJs)(e.s,0,e.a,e.x,e.e,1)},0):(e(),s()):y=0}function l(e,n,r,a,i,l,u){function c(t){if(!p&&o(d.readyState)&&(b.r=p=1,!y&&s(),d.onload=d.onreadystatechange=null,t)){"img"!=e&&h(function(){w.removeChild(d)},50);for(var r in A[n])A[n].hasOwnProperty(r)&&A[n][r].onload()}}var u=u||f.errorTimeout,d=t.createElement(e),p=0,m=0,b={t:r,s:n,e:i,a:l,x:u};1===A[n]&&(m=1,A[n]=[]),"object"==e?d.data=n:(d.src=n,d.type=e),d.width=d.height="0",d.onerror=d.onload=d.onreadystatechange=function(){c.call(this,m)},v.splice(a,0,b),"img"!=e&&(m||2===A[n]?(w.insertBefore(d,x?null:g),h(c,u)):A[n].push(d))}function u(e,t,n,r,i){return y=0,t=t||"j",a(e)?l("c"==t?C:$,e,t,this.i++,n,r,i):(v.splice(this.i++,0,e),1==v.length&&s()),this}function c(){var e=f;return e.loader={load:u,i:0},e}var d,f,p=t.documentElement,h=e.setTimeout,g=t.getElementsByTagName("script")[0],m={}.toString,v=[],y=0,b="MozAppearance"in p.style,x=b&&!!t.createRange().compareNode,w=x?p:g.parentNode,p=e.opera&&"[object Opera]"==m.call(e.opera),p=!!t.attachEvent&&!p,$=b?"object":p?"script":"img",C=p?"script":$,_=Array.isArray||function(e){return"[object Array]"==m.call(e)},E=[],A={},k={timeout:function(e,t){return t.length&&(e.timeout=t[0]),e}};(f=function(e){function t(e){var t,n,r,e=e.split("!"),a=E.length,i=e.pop(),o=e.length,i={url:i,origUrl:i,prefixes:e};for(n=0;n<o;n++)r=e[n].split("="),(t=k[r.shift()])&&(i=t(i,r));for(n=0;n<a;n++)i=E[n](i);return i}function o(e,a,i,o,s){var l=t(e),u=l.autoCallback;l.url.split(".").pop().split("?").shift(),l.bypass||(a&&(a=r(a)?a:a[e]||a[o]||a[e.split("/").pop().split("?")[0]]),l.instead?l.instead(e,a,i,o,s):(A[l.url]?l.noexec=!0:A[l.url]=1,i.load(l.url,l.forceCSS||!l.forceJS&&"css"==l.url.split(".").pop().split("?").shift()?"c":n,l.noexec,l.attrs,l.timeout),(r(a)||r(u))&&i.load(function(){c(),a&&a(l.origUrl,s,o),u&&u(l.origUrl,s,o),A[l.url]=2})))}function s(e,t){function n(e,n){if(e){if(a(e))n||(d=function(){var e=[].slice.call(arguments);f.apply(this,e),p()}),o(e,d,t,0,u);else if(Object(e)===e)for(l in s=function(){var t,n=0;for(t in e)e.hasOwnProperty(t)&&n++;return n}(),e)e.hasOwnProperty(l)&&(!n&&!--s&&(r(d)?d=function(){var e=[].slice.call(arguments);f.apply(this,e),p()}:d[l]=function(e){return function(){var t=[].slice.call(arguments);e&&e.apply(this,t),p()}}(f[l])),o(e[l],d,t,l,u))}else!n&&p()}var s,l,u=!!e.test,c=e.load||e.both,d=e.callback||i,f=d,p=e.complete||i;n(u?e.yep:e.nope,!!c),c&&n(c)}var l,u,d=this.yepnope.loader;if(a(e))o(e,0,d,0);else if(_(e))for(l=0;l<e.length;l++)u=e[l],a(u)?o(u,0,d,0):_(u)?f(u):Object(u)===u&&s(u,d);else Object(e)===e&&s(e,d)}).addPrefix=function(e,t){k[e]=t},f.addFilter=function(e){E.push(e)},f.errorTimeout=1e4,null==t.readyState&&t.addEventListener&&(t.readyState="loading",t.addEventListener("DOMContentLoaded",d=function(){t.removeEventListener("DOMContentLoaded",d,0),t.readyState="complete"},0)),e.yepnope=c(),e.yepnope.executeStack=s,e.yepnope.injectJs=function(e,n,r,a,l,u){var c,d,p=t.createElement("script"),a=a||f.errorTimeout;p.src=e;for(d in r)p.setAttribute(d,r[d]);n=u?s:n||i,p.onreadystatechange=p.onload=function(){!c&&o(p.readyState)&&(c=1,n(),p.onload=p.onreadystatechange=null)},h(function(){c||(c=1,n(1))},a),l?p.onload():g.parentNode.insertBefore(p,g)},e.yepnope.injectCss=function(e,n,r,a,o,l){var u,a=t.createElement("link"),n=l?s:n||i;a.href=e,a.rel="stylesheet",a.type="text/css";for(u in r)a.setAttribute(u,r[u]);o||(g.parentNode.insertBefore(a,g),h(n,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))},Modernizr.addTest("cors",!!(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest)),function(e){function t(e,t,n){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:n;default:throw new Error("Implement me")}}function n(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function r(e,t){function n(){!1===fe.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}var r=!0;return l(function(){return r&&(n(),r=!1),t.apply(this,arguments)},t)}function a(e,t){return function(n){return d(e.call(this,n),t)}}function i(){}function o(e){E(e),l(this,e)}function s(e){var t=b(e),n=t.year||0,r=t.quarter||0,a=t.month||0,i=t.week||0,o=t.day||0,s=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._milliseconds=+c+1e3*u+6e4*l+36e5*s,this._days=+o+7*i,this._months=+a+3*r+12*n,this._data={},this._bubble()}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function u(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&Ee.hasOwnProperty(t)&&(n[t]=e[t]);return n}function c(e){return e<0?Math.ceil(e):Math.floor(e)}function d(e,t,n){for(var r=""+Math.abs(e),a=e>=0;r.length<t;)r="0"+r;return(a?n?"+":"":"-")+r}function f(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function p(e,t){var n;return t=S(t,e),e.isBefore(t)?n=f(e,t):((n=f(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n}function h(e,t,n,r){var a=t._milliseconds,i=t._days,o=t._months;r=null==r||r,a&&e._d.setTime(+e._d+a*n),i&&se(e,"Date",oe(e,"Date")+i*n),o&&ie(e,oe(e,"Month")+o*n),r&&fe.updateOffset(e,i||o)}function g(e){return"[object Array]"===Object.prototype.toString.call(e)}function m(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function v(e,t,n){var r,a=Math.min(e.length,t.length),i=Math.abs(e.length-t.length),o=0;for(r=0;r<a;r++)(n&&e[r]!==t[r]||!n&&x(e[r])!==x(t[r]))&&o++;return o+i}function y(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=Ke[e]||et[t]||t}return e}function b(e){var t,n,r={};for(n in e)e.hasOwnProperty(n)&&(t=y(n))&&(r[t]=e[n]);return r}function x(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=t>=0?Math.floor(t):Math.ceil(t)),n}function w(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function $(e,t,n){return te(fe([e,11,31+t-n]),t,n).week}function C(e){return _(e)?366:365}function _(e){return e%4==0&&e%100!=0||e%400==0}function E(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[ye]<0||e._a[ye]>11?ye:e._a[be]<1||e._a[be]>w(e._a[ve],e._a[ye])?be:e._a[xe]<0||e._a[xe]>23?xe:e._a[we]<0||e._a[we]>59?we:e._a[$e]<0||e._a[$e]>59?$e:e._a[Ce]<0||e._a[Ce]>999?Ce:-1,e._pf._overflowDayOfYear&&(t<ve||t>be)&&(t=be),e._pf.overflow=t)}function A(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function k(e){return e?e.toLowerCase().replace("_","-"):e}function S(e,t){return t._isUTC?fe(e).zone(t._offset||0):fe(e).local()}function D(e,t){return t.abbr=e,_e[e]||(_e[e]=new i),_e[e].set(t),_e[e]}function T(e){delete _e[e]}function F(e){var t,n,r,a,i=0,o=function(e){if(!_e[e]&&Ae)try{require("./lang/"+e)}catch(e){}return _e[e]};if(!e)return fe.fn._lang;if(!g(e)){if(n=o(e))return n;e=[e]}for(;i<e.length;){for(t=(a=k(e[i]).split("-")).length,r=(r=k(e[i+1]))?r.split("-"):null;t>0;){if(n=o(a.slice(0,t).join("-")))return n;if(r&&r.length>=t&&v(a,r,!0)>=t-1)break;t--}i++}return fe.fn._lang}function M(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function L(e){var t,n,r=e.match(Te);for(t=0,n=r.length;t<n;t++)it[r[t]]?r[t]=it[r[t]]:r[t]=M(r[t]);return function(a){var i="";for(t=0;t<n;t++)i+=r[t]instanceof Function?r[t].call(a,e):r[t];return i}}function O(e,t){return e.isValid()?(t=N(t,e.lang()),tt[t]||(tt[t]=L(t)),tt[t](e)):e.lang().invalidDate()}function N(e,t){function n(e){return t.longDateFormat(e)||e}var r=5;for(Fe.lastIndex=0;r>=0&&Fe.test(e);)e=e.replace(Fe,n),Fe.lastIndex=0,r-=1;return e}function j(e,t){var n=t._strict;switch(e){case"Q":return Ue;case"DDDD":return Ve;case"YYYY":case"GGGG":case"gggg":return n?He:Oe;case"Y":case"G":case"g":return Ge;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return n?Ye:Ne;case"S":if(n)return Ue;case"SS":if(n)return ze;case"SSS":if(n)return Ve;case"DDD":return Le;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Pe;case"a":case"A":return F(t._l)._meridiemParse;case"X":return Re;case"Z":case"ZZ":return Be;case"T":return qe;case"SSSS":return je;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return n?ze:Me;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return Me;case"Do":return Ie;default:return new RegExp(H(V(e.replace("\\",""))))}}function P(e){var t=(e=e||"").match(Be)||[],n=((t[t.length-1]||[])+"").match(Xe)||["-",0,0],r=60*n[1]+x(n[2]);return"+"===n[0]?-r:r}function B(e,t,n){var r,a=n._a;switch(e){case"Q":null!=t&&(a[ye]=3*(x(t)-1));break;case"M":case"MM":null!=t&&(a[ye]=x(t)-1);break;case"MMM":case"MMMM":null!=(r=F(n._l).monthsParse(t))?a[ye]=r:n._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(a[be]=x(t));break;case"Do":null!=t&&(a[be]=x(parseInt(t,10)));break;case"DDD":case"DDDD":null!=t&&(n._dayOfYear=x(t));break;case"YY":a[ve]=fe.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":a[ve]=x(t);break;case"a":case"A":n._isPm=F(n._l).isPM(t);break;case"H":case"HH":case"h":case"hh":a[xe]=x(t);break;case"m":case"mm":a[we]=x(t);break;case"s":case"ss":a[$e]=x(t);break;case"S":case"SS":case"SSS":case"SSSS":a[Ce]=x(1e3*("0."+t));break;case"X":n._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":n._useUTC=!0,n._tzm=P(t);break;case"dd":case"ddd":case"dddd":null!=(r=F(n._l).weekdaysParse(t))?(n._w=n._w||{},n._w.d=r):n._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(n._w=n._w||{},n._w[e]=x(t));break;case"gg":case"GG":n._w=n._w||{},n._w[e]=fe.parseTwoDigitYear(t)}}function q(e){var n,r,a,i,o,s,l,u;null!=(n=e._w).GG||null!=n.W||null!=n.E?(o=1,s=4,r=t(n.GG,e._a[ve],te(fe(),1,4).year),a=t(n.W,1),i=t(n.E,1)):(o=(u=F(e._l))._week.dow,s=u._week.doy,r=t(n.gg,e._a[ve],te(fe(),o,s).year),a=t(n.w,1),null!=n.d?(i=n.d)<o&&++a:i=null!=n.e?n.e+o:o),l=ne(r,a,i,s,o),e._a[ve]=l.year,e._dayOfYear=l.dayOfYear}function R(e){var n,r,a,i,o=[];if(!e._d){for(a=U(e),e._w&&null==e._a[be]&&null==e._a[ye]&&q(e),e._dayOfYear&&(i=t(e._a[ve],a[ve]),e._dayOfYear>C(i)&&(e._pf._overflowDayOfYear=!0),r=X(i,0,e._dayOfYear),e._a[ye]=r.getUTCMonth(),e._a[be]=r.getUTCDate()),n=0;n<3&&null==e._a[n];++n)e._a[n]=o[n]=a[n];for(;n<7;n++)e._a[n]=o[n]=null==e._a[n]?2===n?1:0:e._a[n];e._d=(e._useUTC?X:J).apply(null,o),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm)}}function I(e){var t;e._d||(t=b(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],R(e))}function U(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function z(e){if(e._f!==fe.ISO_8601){e._a=[],e._pf.empty=!0;var t,n,r,a,i,o=F(e._l),s=""+e._i,l=s.length,u=0;for(r=N(e._f,o).match(Te)||[],t=0;t<r.length;t++)a=r[t],(n=(s.match(j(a,e))||[])[0])&&((i=s.substr(0,s.indexOf(n))).length>0&&e._pf.unusedInput.push(i),s=s.slice(s.indexOf(n)+n.length),u+=n.length),it[a]?(n?e._pf.empty=!1:e._pf.unusedTokens.push(a),B(a,n,e)):e._strict&&!n&&e._pf.unusedTokens.push(a);e._pf.charsLeftOver=l-u,s.length>0&&e._pf.unusedInput.push(s),e._isPm&&e._a[xe]<12&&(e._a[xe]+=12),!1===e._isPm&&12===e._a[xe]&&(e._a[xe]=0),R(e),E(e)}else G(e)}function V(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,r,a){return t||n||r||a})}function H(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Y(e){var t,r,a,i,o;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)o=0,(t=l({},e))._pf=n(),t._f=e._f[i],z(t),A(t)&&(o+=t._pf.charsLeftOver,o+=10*t._pf.unusedTokens.length,t._pf.score=o,(null==a||o<a)&&(a=o,r=t));l(e,r||t)}function G(e){var t,n,r=e._i,a=We.exec(r);if(a){for(e._pf.iso=!0,t=0,n=Ze.length;t<n;t++)if(Ze[t][1].exec(r)){e._f=Ze[t][0]+(a[6]||" ");break}for(t=0,n=Je.length;t<n;t++)if(Je[t][1].exec(r)){e._f+=Je[t][0];break}r.match(Be)&&(e._f+="Z"),z(e)}else e._isValid=!1}function W(e){G(e),!1===e._isValid&&(delete e._isValid,fe.createFromInputFallback(e))}function Z(t){var n,r=t._i;r===e?t._d=new Date:m(r)?t._d=new Date(+r):null!==(n=ke.exec(r))?t._d=new Date(+n[1]):"string"==typeof r?W(t):g(r)?(t._a=r.slice(0),R(t)):"object"==typeof r?I(t):"number"==typeof r?t._d=new Date(r):fe.createFromInputFallback(t)}function J(e,t,n,r,a,i,o){var s=new Date(e,t,n,r,a,i,o);return e<1970&&s.setFullYear(e),s}function X(e){var t=new Date(Date.UTC.apply(null,arguments));return e<1970&&t.setUTCFullYear(e),t}function Q(e,t){if("string"==typeof e)if(isNaN(e)){if("number"!=typeof(e=t.weekdaysParse(e)))return null}else e=parseInt(e,10);return e}function K(e,t,n,r,a){return a.relativeTime(t||1,!!n,e,r)}function ee(e,t,n){var r=fe.duration(e).abs(),a=me(r.as("s")),i=me(r.as("m")),o=me(r.as("h")),s=me(r.as("d")),l=me(r.as("M")),u=me(r.as("y")),c=a<nt.s&&["s",a]||1===i&&["m"]||i<nt.m&&["mm",i]||1===o&&["h"]||o<nt.h&&["hh",o]||1===s&&["d"]||s<nt.d&&["dd",s]||1===l&&["M"]||l<nt.M&&["MM",l]||1===u&&["y"]||["yy",u];return c[2]=t,c[3]=+e>0,c[4]=n,K.apply({},c)}function te(e,t,n){var r,a=n-t,i=n-e.day();return i>a&&(i-=7),i<a-7&&(i+=7),r=fe(e).add("d",i),{week:Math.ceil(r.dayOfYear()/7),year:r.year()}}function ne(e,t,n,r,a){var i,o,s=X(e,0,1).getUTCDay();return s=0===s?7:s,n=null!=n?n:a,i=a-s+(s>r?7:0)-(s<a?7:0),o=7*(t-1)+(n-a)+i+1,{year:o>0?e:e-1,dayOfYear:o>0?o:C(e-1)+o}}function re(t){var n=t._i,r=t._f;return null===n||r===e&&""===n?fe.invalid({nullInput:!0}):("string"==typeof n&&(t._i=n=F().preparse(n)),fe.isMoment(n)?(t=u(n))._d=new Date(+n._d):r?g(r)?Y(t):z(t):Z(t),new o(t))}function ae(e,t){var n,r;if(1===t.length&&g(t[0])&&(t=t[0]),!t.length)return fe();for(n=t[0],r=1;r<t.length;++r)t[r][e](n)&&(n=t[r]);return n}function ie(e,t){var n;return"string"==typeof t&&"number"!=typeof(t=e.lang().monthsParse(t))?e:(n=Math.min(e.date(),w(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e)}function oe(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function se(e,t,n){return"Month"===t?ie(e,n):e._d["set"+(e._isUTC?"UTC":"")+t](n)}function le(e,t){return function(n){return null!=n?(se(this,e,n),fe.updateOffset(this,t),this):oe(this,e)}}function ue(e){return 400*e/146097}function ce(e){return 146097*e/400}function de(e){"undefined"==typeof ender&&(pe=ge.moment,ge.moment=e?r("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",fe):fe)}for(var fe,pe,he,ge="undefined"!=typeof global?global:this,me=Math.round,ve=0,ye=1,be=2,xe=3,we=4,$e=5,Ce=6,_e={},Ee={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_tzm:null,_isUTC:null,_offset:null,_pf:null,_lang:null},Ae="undefined"!=typeof module&&module.exports,ke=/^\/?Date\((\-?\d+)/i,Se=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,De=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Te=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Fe=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,Me=/\d\d?/,Le=/\d{1,3}/,Oe=/\d{1,4}/,Ne=/[+\-]?\d{1,6}/,je=/\d+/,Pe=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Be=/Z|[\+\-]\d\d:?\d\d/gi,qe=/T/i,Re=/[\+\-]?\d+(\.\d{1,3})?/,Ie=/\d{1,2}/,Ue=/\d/,ze=/\d\d/,Ve=/\d{3}/,He=/\d{4}/,Ye=/[+-]?\d{6}/,Ge=/[+-]?\d+/,We=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ze=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Je=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Xe=/([\+\-]|\d\d)/gi,Qe=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),Ke={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},et={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},tt={},nt={s:45,m:45,h:22,d:26,M:11},rt="DDD w W M D d".split(" "),at="M D H h m s w W".split(" "),it={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return d(this.year()%100,2)},YYYY:function(){return d(this.year(),4)},YYYYY:function(){return d(this.year(),5)},YYYYYY:function(){var e=this.year();return(e>=0?"+":"-")+d(Math.abs(e),6)},gg:function(){return d(this.weekYear()%100,2)},gggg:function(){return d(this.weekYear(),4)},ggggg:function(){return d(this.weekYear(),5)},GG:function(){return d(this.isoWeekYear()%100,2)},GGGG:function(){return d(this.isoWeekYear(),4)},GGGGG:function(){return d(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return x(this.milliseconds()/100)},SS:function(){return d(x(this.milliseconds()/10),2)},SSS:function(){return d(this.milliseconds(),3)},SSSS:function(){return d(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+d(x(e/60),2)+":"+d(x(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return e<0&&(e=-e,t="-"),t+d(x(e/60),2)+d(x(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},ot=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];rt.length;)he=rt.pop(),it[he+"o"]=function(e,t){return function(n){return this.lang().ordinal(e.call(this,n),t)}}(it[he],he);for(;at.length;)he=at.pop(),it[he+he]=a(it[he],2);it.DDDD=a(it.DDD,3),l(i.prototype,{set:function(e){var t,n;for(n in e)"function"==typeof(t=e[n])?this[n]=t:this["_"+n]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,n,r;for(this._monthsParse||(this._monthsParse=[]),t=0;t<12;t++)if(this._monthsParse[t]||(n=fe.utc([2e3,t]),r="^"+this.months(n,"")+"|^"+this.monthsShort(n,""),this._monthsParse[t]=new RegExp(r.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,n,r;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;t<7;t++)if(this._weekdaysParse[t]||(n=fe([2e3,1]).day(t),r="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var n=this._calendar[e];return"function"==typeof n?n.apply(t):n},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,n,r){var a=this._relativeTime[n];return"function"==typeof a?a(e,t,n,r):a.replace(/%d/i,e)},pastFuture:function(e,t){var n=this._relativeTime[e>0?"future":"past"];return"function"==typeof n?n(t):n.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return te(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),(fe=function(t,r,a,i){var o;return"boolean"==typeof a&&(i=a,a=e),o={},o._isAMomentObject=!0,o._i=t,o._f=r,o._l=a,o._strict=i,o._isUTC=!1,o._pf=n(),re(o)}).suppressDeprecationWarnings=!1,fe.createFromInputFallback=r("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i)}),fe.min=function(){return ae("isBefore",[].slice.call(arguments,0))},fe.max=function(){return ae("isAfter",[].slice.call(arguments,0))},fe.utc=function(t,r,a,i){var o;return"boolean"==typeof a&&(i=a,a=e),o={},o._isAMomentObject=!0,o._useUTC=!0,o._isUTC=!0,o._l=a,o._i=t,o._f=r,o._strict=i,o._pf=n(),re(o).utc()},fe.unix=function(e){return fe(1e3*e)},fe.duration=function(e,t){var n,r,a,i,o=e,l=null;return fe.isDuration(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(l=Se.exec(e))?(n="-"===l[1]?-1:1,o={y:0,d:x(l[be])*n,h:x(l[xe])*n,m:x(l[we])*n,s:x(l[$e])*n,ms:x(l[Ce])*n}):(l=De.exec(e))?(n="-"===l[1]?-1:1,o={y:(a=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*n})(l[2]),M:a(l[3]),d:a(l[4]),h:a(l[5]),m:a(l[6]),s:a(l[7]),w:a(l[8])}):"object"==typeof o&&("from"in o||"to"in o)&&(i=p(fe(o.from),fe(o.to)),(o={}).ms=i.milliseconds,o.M=i.months),r=new s(o),fe.isDuration(e)&&e.hasOwnProperty("_lang")&&(r._lang=e._lang),r},fe.version="2.7.0",fe.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",fe.ISO_8601=function(){},fe.momentProperties=Ee,fe.updateOffset=function(){},fe.relativeTimeThreshold=function(t,n){return nt[t]!==e&&(n===e?nt[t]:(nt[t]=n,!0))},fe.lang=function(e,t){return e?(t?D(k(e),t):null===t?(T(e),e="en"):_e[e]||F(e),(fe.duration.fn._lang=fe.fn._lang=F(e))._abbr):fe.fn._lang._abbr},fe.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),F(e)},fe.isMoment=function(e){return e instanceof o||null!=e&&e.hasOwnProperty("_isAMomentObject")},fe.isDuration=function(e){return e instanceof s};for(he=ot.length-1;he>=0;--he)!function(t){var n,r;if(0===t.indexOf("week"))n=7,r="day";else{if(0!==t.indexOf("month"))return;n=12,r="month"}fe[t]=function(a,i){var o,s,l=fe.fn._lang[t],u=[];if("number"==typeof a&&(i=a,a=e),s=function(e){var t=fe().utc().set(r,e);return l.call(fe.fn._lang,t,a||"")},null!=i)return s(i);for(o=0;o<n;o++)u.push(s(o));return u}}(ot[he]);fe.normalizeUnits=function(e){return y(e)},fe.invalid=function(e){var t=fe.utc(NaN);return null!=e?l(t._pf,e):t._pf.userInvalidated=!0,t},fe.parseZone=function(){return fe.apply(null,arguments).parseZone()},fe.parseTwoDigitYear=function(e){return x(e)+(x(e)>68?1900:2e3)},l(fe.fn=o.prototype,{clone:function(){return fe(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=fe(this).utc();return 0<e.year()&&e.year()<=9999?O(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):O(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return A(this)},isDSTShifted:function(){return!!this._a&&(this.isValid()&&v(this._a,(this._isUTC?fe.utc(this._a):fe(this._a)).toArray())>0)},parsingFlags:function(){return l({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(e){return this.zone(0,e)},local:function(e){return this._isUTC&&(this.zone(0,e),this._isUTC=!1,e&&this.add(this._d.getTimezoneOffset(),"m")),this},format:function(e){var t=O(this,e||fe.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var n;return n="string"==typeof e&&"string"==typeof t?fe.duration(isNaN(+t)?+e:+t,isNaN(+t)?t:e):"string"==typeof e?fe.duration(+t,e):fe.duration(e,t),h(this,n,1),this},subtract:function(e,t){var n;return n="string"==typeof e&&"string"==typeof t?fe.duration(isNaN(+t)?+e:+t,isNaN(+t)?t:e):"string"==typeof e?fe.duration(+t,e):fe.duration(e,t),h(this,n,-1),this},diff:function(e,t,n){var r,a,i=S(e,this),o=6e4*(this.zone()-i.zone());return t=y(t),"year"===t||"month"===t?(r=432e5*(this.daysInMonth()+i.daysInMonth()),a=12*(this.year()-i.year())+(this.month()-i.month()),a+=(this-fe(this).startOf("month")-(i-fe(i).startOf("month")))/r,a-=6e4*(this.zone()-fe(this).startOf("month").zone()-(i.zone()-fe(i).startOf("month").zone()))/r,"year"===t&&(a/=12)):(r=this-i,a="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-o)/864e5:"week"===t?(r-o)/6048e5:r),n?a:c(a)},from:function(e,t){return fe.duration({to:this,from:e}).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(fe(),e)},calendar:function(e){var t=S(e||fe(),this).startOf("day"),n=this.diff(t,"days",!0),r=n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(r,this))},isLeapYear:function(){return _(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Q(e,this.lang()),this.add(e-t,"days")):t},month:le("Month",!0),startOf:function(e){switch(e=y(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=y(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)>+fe(e).startOf(t)},isBefore:function(e,t){return t=void 0!==t?t:"millisecond",+this.clone().startOf(t)<+fe(e).startOf(t)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)==+S(e,this).startOf(t)},min:r("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=fe.apply(null,arguments),e<this?this:e}),max:r("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=fe.apply(null,arguments),e>this?this:e}),zone:function(e,t){var n,r=this._offset||0;return null==e?this._isUTC?r:this._d.getTimezoneOffset():("string"==typeof e&&(e=P(e)),Math.abs(e)<16&&(e*=60),!this._isUTC&&t&&(n=this._d.getTimezoneOffset()),this._offset=e,this._isUTC=!0,null!=n&&this.subtract(n,"m"),r!==e&&(!t||this._changeInProgress?h(this,fe.duration(r-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,fe.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?fe(e).zone():0,(this.zone()-e)%60==0},daysInMonth:function(){return w(this.year(),this.month())},dayOfYear:function(e){var t=me((fe(this).startOf("day")-fe(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=te(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=te(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=te(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return $(this.year(),1,4)},weeksInYear:function(){var e=this._lang._week;return $(this.year(),e.dow,e.doy)},get:function(e){return e=y(e),this[e]()},set:function(e,t){return e=y(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=F(t),this)}}),fe.fn.millisecond=fe.fn.milliseconds=le("Milliseconds",!1),fe.fn.second=fe.fn.seconds=le("Seconds",!1),fe.fn.minute=fe.fn.minutes=le("Minutes",!1),fe.fn.hour=fe.fn.hours=le("Hours",!0),fe.fn.date=le("Date",!0),fe.fn.dates=r("dates accessor is deprecated. Use date instead.",le("Date",!0)),fe.fn.year=le("FullYear",!0),fe.fn.years=r("years accessor is deprecated. Use year instead.",le("FullYear",!0)),fe.fn.days=fe.fn.day,fe.fn.months=fe.fn.month,fe.fn.weeks=fe.fn.week,fe.fn.isoWeeks=fe.fn.isoWeek,fe.fn.quarters=fe.fn.quarter,fe.fn.toJSON=fe.fn.toISOString,l(fe.duration.fn=s.prototype,{_bubble:function(){var e,t,n,r=this._milliseconds,a=this._days,i=this._months,o=this._data,s=0;o.milliseconds=r%1e3,e=c(r/1e3),o.seconds=e%60,t=c(e/60),o.minutes=t%60,n=c(t/60),o.hours=n%24,a+=c(n/24),i+=c((a-=c(ce(s=c(ue(a)))))/30),a%=30,s+=c(i/12),i%=12,o.days=a,o.months=i,o.years=s},abs:function(){return this._milliseconds=Math.abs(this._milliseconds),this._days=Math.abs(this._days),this._months=Math.abs(this._months),this._data.milliseconds=Math.abs(this._data.milliseconds),this._data.seconds=Math.abs(this._data.seconds),this._data.minutes=Math.abs(this._data.minutes),this._data.hours=Math.abs(this._data.hours),this._data.months=Math.abs(this._data.months),this._data.years=Math.abs(this._data.years),this},weeks:function(){return c(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*x(this._months/12)},humanize:function(e){var t=ee(this,!e,this.lang());return e&&(t=this.lang().pastFuture(+this,t)),this.lang().postformat(t)},add:function(e,t){var n=fe.duration(e,t);return this._milliseconds+=n._milliseconds,this._days+=n._days,this._months+=n._months,this._bubble(),this},subtract:function(e,t){var n=fe.duration(e,t);return this._milliseconds-=n._milliseconds,this._days-=n._days,this._months-=n._months,this._bubble(),this},get:function(e){return e=y(e),this[e.toLowerCase()+"s"]()},as:function(e){var t,n;if(e=y(e),t=this._days+this._milliseconds/864e5,"month"===e||"year"===e)return n=this._months+12*ue(t),"month"===e?n:n/12;switch(t+=ce(this._months/12),e){case"week":return t/7;case"day":return t;case"hour":return 24*t;case"minute":return 24*t*60;case"second":return 24*t*60*60;case"millisecond":return 24*t*60*60*1e3;default:throw new Error("Unknown unit "+e)}},lang:fe.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),n=Math.abs(this.days()),r=Math.abs(this.hours()),a=Math.abs(this.minutes()),i=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(n?n+"D":"")+(r||a||i?"T":"")+(r?r+"H":"")+(a?a+"M":"")+(i?i+"S":""):"P0D"}});for(he in Qe)Qe.hasOwnProperty(he)&&function(e){fe.duration.fn[e]=function(){return this._data[e]}}(he.toLowerCase());fe.duration.fn.asMilliseconds=function(){return this.as("ms")},fe.duration.fn.asSeconds=function(){return this.as("s")},fe.duration.fn.asMinutes=function(){return this.as("m")},fe.duration.fn.asHours=function(){return this.as("h")},fe.duration.fn.asDays=function(){return this.as("d")},fe.duration.fn.asWeeks=function(){return this.as("weeks")},fe.duration.fn.asMonths=function(){return this.as("M")},fe.duration.fn.asYears=function(){return this.as("y")},fe.lang("en",{ordinal:function(e){var t=e%10;return e+(1===x(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),Ae?module.exports=fe:"function"==typeof define&&define.amd?(define("moment",function(e,t,n){return n.config&&n.config()&&!0===n.config().noGlobal&&(ge.moment=pe),fe}),de(!0)):de()}.call(this);var mod=angular.module("infinite-scroll",[]);mod.directive("infiniteScroll",["$rootScope","$window","$timeout",function(e,t,n){return{link:function(r,a,i){n(function(){t=angular.element(t);var o,s,l,u,c,d,f;return 0===(o=a.parents().filter(function(){return/(auto|scroll)/.test($.css(this,"overflow")+$.css(this,"overflow-y"))}).eq(0)).length&&(o=t),null!=i.infiniteScrollSelf&&(o=a),c=0,null!=i.infiniteScrollDistance&&r.$watch(i.infiniteScrollDistance,function(e){return c=parseFloat(e,10)}),d=!0,s=!1,null!=i.infiniteScrollDisabled&&r.$watch(i.infiniteScrollDisabled,function(e){if((d=!e)&&s)return s=!1,u()}),f=o!==t?o.position().top:0,l=a.position().top-f,u=function(){var t;return t=a==o?a[0].scrollHeight-a.scrollTop()-a.height()<=a[0].scrollHeight*c:l+a.height()-(o.height()+o.scrollTop())<=o.height()*c,t&&d?e.$$phase?r.$eval(i.infiniteScroll):r.$apply(i.infiniteScroll):t?s=!0:void 0},o.on("scroll",u),r.$on("$destroy",function(){return o.off("scroll",u)}),n(function(){return i.infiniteScrollImmediateCheck?r.$eval(i.infiniteScrollImmediateCheck)?u():void 0:u()},0)},0)}}}]),function(e){"use strict";function t(e){return e.replace(n,function(e,t,n,r){return r?n.toUpperCase():n}).replace(r,"Moz$1")}var n=/([\:\-\_]+(.))/g,r=/^moz([A-Z])/;e.module("translate",[],["$provide",function(t){t.factory("translate",["$log",function(t){var n={},r=!1,a=function(e,a){return e?(e=$.trim(e),e=e.replace(/<!--IE fix-->/g,""),e=e.replace(/ class="ng-binding"/g,""),n[a||"default"][e]?n[a||"default"][e]:(r&&t.warn('Missing localisation for "'+e+'"'),e)):""};return a.add=function(t,r){e.isUndefined(n[r||"default"])&&(n[r||"default"]={}),e.extend(n[r||"default"],t)},a.remove=function(e,t){return!!n[t||"default"][e]&&(delete n[t||"default"][e],!0)},a.set=function(e,t){n[t||"default"]=e},a.logMissedHits=function(e){r=e},a}])}]),e.module("translate.directives",["translate"],["$compileProvider",function(n){n.directive("translate",["$compile","translate",function(n,r){return{priority:10,restrict:"ECMA",compile:function(a,i){var o=!1;if(i.translate){var s=i.translate.split(" ");e.forEach(s,function(e){a.attr(e,r(i[t(e)]))}),o=s.indexOf("innerHTML")>=0}else o=!0;return function(e,t,a){if(o){var i=r(t.html());t.empty().append(i)}try{n(t.contents())(e)}catch(e){}}}}}])}]),e.module("translate.filters",["translate"]).filter("translate",["translate",function(e){return function(t){return e(t)}}])}(angular),function(){"use strict";Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for((n=n<0?Math.ceil(n):Math.floor(n))<0&&(n+=t);n<t;n++)if(n in this&&this[n]===e)return n;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=[],a=arguments.length>=2?arguments[1]:void 0,i=0;i<n;i++)if(i in t){var o=t[i];e.call(a,o,i,t)&&r.push(o)}return r}),Array.prototype.map||(Array.prototype.map=function(e,t){var n,r,a;if(null===this)throw new TypeError(" this is null or not defined");var i=Object(this),o=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),r=new Array(o),a=0;a<o;){var s,l;a in i&&(s=i[a],l=e.call(n,s,a,i),r[a]=l),a++}return r}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],r=n.length;return function(a){if("object"!=typeof a&&("function"!=typeof a||null===a))throw new TypeError("Object.keys called on non-object");var i,o,s=[];for(i in a)e.call(a,i)&&s.push(i);if(t)for(o=0;o<r;o++)e.call(a,n[o])&&s.push(n[o]);return s}}()),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.lastIndexOf(e,t)===t}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){var n=this.toString();(void 0===t||t>n.length)&&(t=n.length),t-=e.length;var r=n.indexOf(e,t);return-1!==r&&r===t}),window.hasOwnProperty||(window.hasOwnProperty=function(e){return Object.prototype.hasOwnProperty.call(window,e)}),window.selectText=function(e){var t,n;document.body.createTextRange?((t=document.body.createTextRange()).moveToElementText(e),t.select()):window.getSelection&&(n=window.getSelection(),(t=document.createRange()).selectNodeContents(e),n.removeAllRanges(),n.addRange(t))},window.isObjectEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},window.utf8_to_b64=function(e){return window.btoa(jsesc(e,{json:!0}))},window.b64_to_utf8=function(e){return window.atob(e)}}(),function(){"use strict";var e=angular.module("ods-widgets",["infinite-scroll","ngSanitize","translate","translate.directives","translate.filters"]);e.provider("ODSWidgetsConfig",function(){this.defaultConfig={ODSWidgetsVersion:"0.1.7-dev",defaultDomain:"",language:null,disqusShortname:null,customAPIHeaders:null,basemaps:[{provider:"mapquest",label:"MapQuest"}],mapGeobox:!1,chartColors:null,mapPrependAttribution:null,basePath:null,websiteName:null,themes:{},defaultMapLocation:"12,48.85218,2.36996"},this.customConfig={},this.setConfig=function(e){angular.extend(this.customConfig,e)},this.$get=function(){return angular.extend({},this.defaultConfig,this.customConfig)}}),e.run(["translate","ODSWidgetsConfig",function(e,t){if(e.add({}),!t.basePath){var n,r,a,i=document.getElementsByTagName("script"),o=/[\/^]ods-widgets(\.min)?\.js\??/;for(n=0;n<i.length;n++)(r=i[n].src).match(o)&&((a=r.split(o)[0])?".js"===a.substring(a.length-3)?t.basePath="":t.basePath=a+"/":t.basePath="/")}}])}(),function(){"use strict";angular.module("ods-widgets").service("ODSAPI",["$http","ODSWidgetsConfig","odsErrorService",function(e,t,n){var r=function(r,a,i,o){var s=r?r.domainUrl:"";s+=a,(i=ODS.URLUtils.cleanupAPIParams(i)||{}).timezone=jstz.determine().name(),r&&r.apikey&&(i.apikey=r.apikey);var l={params:i};return o&&(l.timeout=o),s.startsWith("http://")||(t.customAPIHeaders?l.headers=t.customAPIHeaders:l.headers={},l.headers["ODS-Widgets-Version"]=t.ODSWidgetsVersion),!r.domainUrl||Modernizr.cors?e.get(s,l).error(function(e){e&&n.sendErrorNotification(e)}):(s+=s.indexOf("?")>-1?"&":"?",s+="callback=JSON_CALLBACK",e.jsonp(s,l))};return{getDomainURL:function(e){var n=null;return angular.isUndefined(e)||null===e||""===e?n=t.defaultDomain:"/"!==(n="/"!==e.substr(0,1)&&-1===e.indexOf(".")?e+".opendatasoft.com":e).substr(0,1)&&-1===n.indexOf("http://")&&-1===n.indexOf("https://")&&(n="https://"+n),"/"===n.substr(-1)&&(n=n.substr(0,n.length-1)),n},datasets:{get:function(e,t,n){return r(e,"/api/datasets/1.0/"+t+"/",n)},search:function(e,t){var n=angular.extend({},e.parameters,t);return r(e,"/api/datasets/1.0/search/",n)},facets:function(e,t){return this.search(e,{rows:0,facet:t})}},records:{analyze:function(e,t,n){return r(e,"/api/records/1.0/analyze/",angular.extend({},t,{dataset:e.dataset.datasetid}),n)},search:function(e,t,n){return r(e,"/api/records/1.0/search/",angular.extend({},t,{dataset:e.dataset.datasetid}),n)},download:function(e,t,n){return r(e,"/api/records/1.0/download/",angular.extend({},t,{dataset:e.dataset.datasetid}),n)},geo:function(e,t,n){return r(e,"/api/records/1.0/geocluster/",angular.extend({},t,{dataset:e.dataset.datasetid}),n)},geopreview:function(e,t,n){return r(e,"/api/records/1.0/geopreview/",angular.extend({},t,{dataset:e.dataset.datasetid}),n)},boundingbox:function(e,t,n){return r(e,"/api/records/1.0/boundingbox/",angular.extend({},t,{dataset:e.dataset.datasetid}),n)},geopolygon:function(e,t,n){return r(e,"/api/records/1.0/geopolygon/",angular.extend({},t,{dataset:e.dataset.datasetid}),n)}},reuses:function(e,t){return r(e,"/api/reuses/",t)}}}])}(),function(){"use strict";var e=angular.module("ods-widgets");e.factory("AggregationHelper",["translate",function(e){var t=[{label:e("Count"),func:"COUNT"},{label:e("Average"),func:"AVG"},{label:e("Minimum"),func:"MIN"},{label:e("Maximum"),func:"MAX"},{label:e("Standard deviation"),func:"STDDEV"},{label:e("Sum"),func:"SUM"},{label:e("Percentile"),func:"QUANTILES"},{label:e("Constant value"),func:"CONSTANT"}];return{getAvailableFunctions:function(e){return 0===e?[t[0],t[t.length-1]]:t},getAvailableFunction:function(e){return t[e]},getFunctionLabel:function(e){return e=e.toUpperCase(),$.grep(t,function(t){return e===t.func})[0].label}}}]),e.factory("ChartHelper",["translate","AggregationHelper","ODSWidgetsConfig","colorScale",function(e,t,n,r){var a={},i={},o={year:e("Year"),month:e("Month"),day:e("Day"),hour:e("Hour"),minute:e("Minute"),"month month":e("Month of year"),"day day":e("Day of month"),"day weekday":e("Day of week"),"hour weekday":e("Hour per weekday"),"day month":e("Day of year"),"hour hour":e("Hour of day")},s={},l=[],u={"top left":{center:["15%","20%"],size:"25%"},"top right":{center:["85%","20%"],size:"25%"},"bottom left":{center:["15%","80%"],size:"25%"},"bottom right":{center:["85%","80%"],size:"25%"},center:{}},c=n.chartColors||chroma.brewer.Set2,d=[{label:e("Line"),type:"line",group:e("line charts")},{label:e("Spline"),type:"spline",group:e("line charts")},{label:e("Range"),type:"arearange",group:e("Area charts"),filter:"hasNumericField"},{label:e("Range spline"),type:"areasplinerange",group:e("Area charts"),filter:"hasNumericField"},{label:e("Column range"),type:"columnrange",group:e("Area charts"),filter:"hasNumericField"},{label:e("Treemap"),type:"treemap",group:e("Special")},{label:e("Area"),type:"area",group:e("Area charts")},{label:e("Area spline"),type:"areaspline",group:e("Area charts")},{label:e("Column chart"),type:"column",group:e("Bar charts")},{label:e("Bar chart"),type:"bar",group:e("Bar charts")},{label:e("Pie chart"),type:"pie",group:e("Pie charts")},{label:e("Scatter plot"),type:"scatter",group:e("line charts")}],f=["year","month","day","hour","minute"],p=["month month","day day","day weekday","hour weekday","day month","hour hour"],h={},g={},m=function(e,t,n){var r=!1;e?r=!0:e="date"==t?"day":"hour";for(var a=[],i=0;i<=f.indexOf(e)&&(a.push({name:f[i],label:o[f[i]]}),"date"!==t||"day"!=f[i])&&("datetime"!==t||r||"hour"!=f[i])&&("datetime"!==t||!r||"minute"!=f[i]);i++);if(n)for(var s=0;s<p.length&&(a.push({name:p[s],label:o[p[s]]}),"date"!==t||"day month"!=f[s]);s++);return a};return{getDatasetUniqueId:function(e){var t;if(angular.forEach(g,function(n,r){return r.endsWith(e)&&(t=n),!1}),t)return t.getUniqueId();throw"dataset "+e+" not loaded yet."},getDataset:function(e){var t;return angular.forEach(g,function(n,r){return e===r&&(t=n),!1}),t},isChartSortable:function(e){return!this.isRangeChart(e)},isRangeChart:function(e){return["arearange","areasplinerange","columnrange"].indexOf(e)>-1},getAllTimescales:function(){return m("minute","datetime",!0)},getAvailableX:function(e,t,n){n=!!n;var r=this;return void 0===t?n?$.grep(a[e],function(t){return-1!==["date","datetime"].indexOf(r.getFieldType(e,t.name))}):a[e]:a[e][t]},getAvailableBreakDowns:function(e,t){if(!t)return[];for(var n=-1!==["date","datetime"].indexOf(this.getFieldType(e,t)),r=[],i=0;i<a[e].length;i++)a[e][i].name!==t&&(n&&-1!==["date","datetime"].indexOf(this.getFieldType(e,a[e][i].name))||r.push({label:a[e][i].label,name:a[e][i].name}));return r},getAvailableY:function(e,t){return void 0===t?i[e]:i[e][t]},getTimescales:function(e,t,n){for(var r,a,i=0;i<h[e].length;i++)if(h[e][i].name===t){a=h[e][i];break}if(a){if(a.annotations)for(var o=0;o<a.annotations.length;o++)if("timeserie_precision"==a.annotations[o].name){r=a.annotations[o].args[0];break}return m(r,a.type,n)}},getDatasetId:function(e){return(e.domain||"")+"."+e.dataset.datasetid},init:function(e,t,n){void 0===n&&(n=!1);var r=[],a=[],i=this.getDatasetId(e);if(n||!(i in l)){h[i]=e.dataset.fields;for(var o=0;o<h[i].length;o++){var s=h[i][o];if("int"!=s.type&&"double"!=s.type||a.push(s),"datetime"==s.type||"date"==s.type)r.unshift(s);else if(s.annotations)for(var u=0;u<s.annotations.length;u++)"facet"==s.annotations[u].name&&r.push(s)}this.setAvailableX(i,r),this.setAvailableY(i,a),l[i]=!0,g[i]=e.dataset,this.load(i)}},isInitialized:function(e){return""===e?!!l.length:!!(e in l)},load:function(e){if(s[e])for(t=0;t<s[e].length;t++)s[e][t]();if(s[e]=[],s[""])for(var t=0;t<s[""].length;t++)s[""][t]();s[""]=[]},onLoad:function(e,t){"function"==typeof e&&(t=e,e=""),this.isInitialized(e)?t():(e in s||(s[e]=[]),s[e].indexOf(t)<0&&s[e].push(t))},setAvailableX:function(e,t){a[e]=t},setAvailableY:function(e,t){i[e]=t},resolvePosition:function(e){return void 0==typeof e&&(e="center"),e in u||(e="center"),u[e]},getPieChartPositions:function(){return $.map(u,function(e,t){return t})},getDefaultColors:function(){return c},getDefaultColor:function(e,t,n,a){return r.getDefaultColor(e,this.getAllowedColors(t,n),a)},getAllowedColors:function(e,t){var n=[];return(t||-1!==["pie"].indexOf(e))&&n.push("range"),t||-1!==["pie"].indexOf(e)||n.push("single"),n},getAvailableChartTypes:function(e,t){var n=[];if(g[e])for(var r=0;r<d.length;r++)(t&&-1!==["column","area","areaspline","line","spline","bar"].indexOf(d[r].type)||!t)&&(void 0===d[r].filter?n.push(d[r]):g[e][d[r].filter]()&&n.push(d[r]));return n},getSerieTemplate:function(){return angular.copy({})},setChartDefaultValues:function(e,t,n){var r,a="";if(void 0===n&&(n=!1),t.timescale){for(i=0;i<t.queries.length;i++)r=this.getFieldType(e,t.queries[i].xAxis),!t.queries[i].timescale||"date"!==r&&"datetime"!==r||(a=t.queries[i].timescale);a||(t.timescale="")}else{for(i=0;i<t.queries.length;i++)r=this.getFieldType(e,t.queries[i].xAxis),!t.queries[i].timescale||"date"!==r&&"datetime"!==r||(a=t.queries[i].timescale);a&&(t.timescale=t.queries[0].timescale)}if(t.timescale)for(var i=0;i<t.queries.length;i++)t.queries[i].timescale||(t.queries[i].timescale=t.timescale);t.singleAxis||(delete t.singleAxisLabel,delete t.singleAxisScale,delete t.yRangeMin,delete t.yRangeMax),n||delete t.xLabel},setDefaultQueryValues:function(e,t,n,r,a,i){t||(t={});var o={},s=o.x||this.getAvailableX(e,0).name,l=50;"date"!=this.getFieldType(e,s)&&"datetime"!=this.getFieldType(e,s)||(l=""),t.xAxis||(t.xAxis=s),void 0===t.maxpoints&&(t.maxpoints=l),t.charts||(t.charts=[]);var u=t.xAxis,c=this.getFieldType(e,u);"date"==c||"datetime"==c?t.timescale&&-1!==this.getTimescales(e,u,n).map(function(e){return e.name}).indexOf(t.timescale)||(t.timescale="year",t.timescale=n&&a?a:"year"):t.timescale&&(t.timescale=""),t.seriesBreakdown===u&&(t.seriesBreakdown="",t.seriesBreakdownTimescale="");for(var d=!1,f=0;f<t.charts.length;f++)-1!==["treemap","pie"].indexOf(t.charts[f].type)&&(d=!0);d&&(t.seriesBreakdown="",t.seriesBreakdownTimescale=""),!t.seriesBreakdown&&t.charts.length<2&&delete t.stacked,t.sort&&!t.seriesBreakdown||(t.sort="")},setSerieDefaultValues:function(e,t,n,r){if(void 0!==n){var a=this.getAvailableY(e);t.type||(t.type="column",!n||"date"!=this.getFieldType(e,n)&&"datetime"!=this.getFieldType(e,n)||(t.type="line")),t.func||(t.func=a.length>0?"AVG":"COUNT"),void 0!==t.expr&&void 0===t.yAxis&&(t.yAxis=t.expr,delete t.expr),void 0===t.yAxis||""===t.yAxis?(0===a.length&&-1===["COUNT","CONSTANT","CUSTOM"].indexOf(t.func)&&(t.func="COUNT"),r||-1!==["COUNT","CONSTANT","CUSTOM"].indexOf(t.func)||(t.yAxis=a[0].name)):r||-1!==["COUNT","CONSTANT","CUSTOM"].indexOf(t.func)||0===$.grep(a,function(e){return e.name===t.yAxis}).length&&(t.yAxis=a[0].name),t.type&&this.isRangeChart(t.type)?(t.func="COUNT",t.charts||(t.charts=[{func:"MIN",yAxis:t.yAxis},{func:"MAX",yAxis:t.yAxis}]),void 0!==t.charts[0].yAxis&&""!==t.charts[0].yAxis||(t.charts[0].yAxis=t.charts[0].expr||t.yAxis,delete t.charts[0].expr),void 0!==t.charts[1].yAxis&&""!==t.charts[1].yAxis||(t.charts[1].yAxis=t.charts[1].expr||t.yAxis,delete t.charts[1].expr),"QUANTILES"!==t.charts[0].func||""!==t.charts[0].subsets&&void 0!==t.charts[0].subsets||(t.charts[0].subsets=5),"QUANTILES"!==t.charts[1].func||""!==t.charts[1].subsets&&void 0!==t.charts[1].subsets||(t.charts[1].subsets=95),"QUANTILES"!==t.charts[0].func&&t.charts[0].subsets&&delete t.charts[0].subsets,"QUANTILES"!==t.charts[1].func&&t.charts[1].subsets&&delete t.charts[1].subsets):(t.charts&&delete t.charts,"QUANTILES"===t.func?t.subsets||(t.subsets=50):t.subsets&&delete t.subsets),"pie"!==t.type||t.position||(t.position="center"),delete t.yLabel,delete t.extras}},setSerieDefaultColors:function(e,t,n){e.color=this.getDefaultColor(e.color,e.type,t,n)},getXLabel:function(e,t,n,r){var a=this.getFieldType(e,t),i=this.getFieldLabel(e,t);return"date"!==a&&"datetime"!==a||!n?i:i+" ("+o[n]+")"},getYLabel:function(e,n){if(n.yLabelOverride)return n.yLabelOverride;if(this.isRangeChart(n.type))return this.getYLabel(e,n.charts[0])+" / "+this.getYLabel(e,n.charts[1]);var r=t.getFunctionLabel(n.func),a=n.yAxis||n.expr,i=$.grep(this.getAvailableY(e),function(e){return e.name==a});return i.length>0&&"COUNT"!==n.func&&"CONSTANT"!==n.func&&"CUSTOM"!==n.func?r+" "+i[0].label:r},getField:function(e,t){if(!h[e])return null;for(var n=0;n<h[e].length;n++){var r=h[e][n];if(r.name==t)return r}},getFieldLabel:function(e,t){var n=this.getField(e,t);return n?n.label:n},getFieldType:function(e,t){var n=this.getField(e,t);return n?n.type:n},getFieldUnit:function(e,t){var n=this.getField(e,t);if(n.annotations){for(var r=0;r<n.annotations.length;r++)if("unit"===n.annotations[r].name)return n.annotations[r].args[0];return n.annotations.unit}return!1},getAvailableFunctions:function(e){return t.getAvailableFunctions(this.getAvailableY(e).length)},allowThresholds:function(e){return-1!==["column","bar","scatter"].indexOf(e)}}}])}(),function(){"use strict";angular.module("ods-widgets").factory("colorScale",["ODSWidgetsConfig",function(e){function t(e){var t;return e?(e.startsWith("custom-")&&(e=e.replace("custom-","")),e.startsWith("range-")?e=e.replace("range-",""):e.startsWith("single-")&&(e=e.replace("single-","")),chroma.brewer[e]&&(t=e)):t=i||a,t}function n(e){var n,r=t(e);return r?n=chroma.scale(r):(e=(e=e.replace("custom-","")).replace("single-",""),n=chroma.scale().range([e,e])),n}var r=[{label:"Accent",colors:chroma.brewer.Accent},{label:"Dark2",colors:chroma.brewer.Dark2},{label:"Pastel2",colors:chroma.brewer.Pastel2},{label:"Pastel1",colors:chroma.brewer.Pastel1},{label:"Set2",colors:chroma.brewer.Set2},{label:"Set1",colors:chroma.brewer.Set1},{label:"Paired",colors:chroma.brewer.Paired},{label:"Set3",colors:chroma.brewer.Set3},{label:"OrRd",colors:chroma.brewer.OrRd.slice(1)},{label:"PuBu",colors:chroma.brewer.PuBu.slice(1)},{label:"BuPu",colors:chroma.brewer.BuPu.slice(1)},{label:"Oranges",colors:chroma.brewer.Oranges.slice(1)},{label:"YlOrBr",colors:chroma.brewer.YlOrBr.slice(1)},{label:"YlGn",colors:chroma.brewer.YlGn.slice(1)},{label:"Reds",colors:chroma.brewer.Reds.slice(1)},{label:"RdPu",colors:chroma.brewer.RdPu.slice(1)},{label:"Greens",colors:chroma.brewer.Greens.slice(1)},{label:"YlGnBu",colors:chroma.brewer.YlGnBu.slice(1)},{label:"Purples",colors:chroma.brewer.Purples.slice(1)},{label:"GnBu",colors:chroma.brewer.GnBu.slice(1)},{label:"Greys",colors:chroma.brewer.Greys.slice(1)},{label:"YlOrRd",colors:chroma.brewer.YlOrRd.slice(1)},{label:"PuRd",colors:chroma.brewer.PuRd.slice(1)},{label:"Blues",colors:chroma.brewer.Blues.slice(1)},{label:"PuBuGn",colors:chroma.brewer.PuBuGn.slice(1)},{label:"Spectral",colors:chroma.brewer.Spectral},{label:"RdYlGn",colors:chroma.brewer.RdYlGn},{label:"RdBu",colors:chroma.brewer.RdBu},{label:"PiYG",colors:chroma.brewer.PiYG},{label:"PRGn",colors:chroma.brewer.PRGn},{label:"RdYlBu",colors:chroma.brewer.RdYlBu},{label:"BrBG",colors:chroma.brewer.BrBG},{label:"RdGy",colors:chroma.brewer.RdGy},{label:"PuOr",colors:chroma.brewer.PuOr}],a="Set2",i="",o=0;return e.chartColors&&e.chartColors.length>0&&(i="custom",r.unshift({label:"custom",colors:e.chartColors}),chroma.brewer.custom=e.chartColors),{getScale:function(e,t,r){return t=void 0!==t?t:0,r=void 0!==r?r:1,n(e).domain([t,r])},getUniqueColor:function(e){return n(e)(1).hex()},getColorAtIndex:function(e,n){var r,a=t(e);return a?(r=chroma.brewer[a])[n%r.length]:e},getColors:function(e){var n=t(e);return n?chroma.brewer[n]:[e,e]},getColorSets:function(){return chroma.brewer},getOrderedColorSets:function(){return r},getDefaultColorSet:function(){return i||a},getDefaultColor:function(e,t,n){var r,a=this.getColorList(t);return void 0!==e&&""!==e?e:"undefined"!=typeof backupColor&&""!==backupColor?backupColor:(a[o].label.startsWith("custom-")&&(o=(o+1)%a.length),void 0!==n?r=a[n%a.length].label:(r=a[o].label,o=(o+1)%a.length),r)},getColorList:function(e,t){var n=[];if(-1!==e.indexOf("single")){var r=this.getColors(this.getDefaultColorSet());angular.forEach(r,function(e){n.push({label:e,color:e})})}return-1!==e.indexOf("range")&&angular.forEach(this.getOrderedColorSets(),function(e){n.push({label:"range-"+e.label,color:e.colors})}),n},isColorAllowed:function(e,t,n){var r=!1;return!!e&&(-1===n.indexOf("range")?!e.startsWith("range-")&&!e.startsWith("custom-range-"):-1!==n.indexOf("range")?!e.startsWith("custom-single-")&&(angular.forEach(t,function(t){t.label===e&&(r=!0)}),r):void 0)}}}])}(),function(){"use strict";var e=angular.module("ods-widgets");e.factory("MapHelper",["ODSWidgetsConfig","ODSAPI","$q",function(e,t,n){return{WORLD_BOUNDS:[[-60,-180],[80,180]],retrieveBounds:function(e){var r=this,a=n.defer();if(0===e.length)a.resolve(null);else{var i=[];angular.forEach(e,function(e){var n={};jQuery.extend(n,e.parameters),i.push(t.records.boundingbox(e,n))}),n.all(i).then(function(e){var t;angular.forEach(e,function(e){var n=e.data,r=[[n.bbox[1],n.bbox[0]],[n.bbox[3],n.bbox[2]]];n.count>0&&(t?t.extend(r):t=L.latLngBounds(r))}),t&&t.isValid()?a.resolve(t):a.resolve(r.WORLD_BOUNDS)})}return a.promise},getLocationStructure:function(e){var t=e.split(",");return{center:[t[1],t[2]],zoom:t[0]}},getLocationParameter:function(e,t){return angular.isArray(e)&&(e=L.latLng(e)),t+","+L.Util.formatNum(e.lat,5)+","+L.Util.formatNum(e.lng,5)},MapConfiguration:{getActiveContextList:function(e,t){var n=[];return angular.forEach(e.layers,function(e){e.displayed&&angular.forEach(e.activeDatasets,function(e){t?e.context.dataset.hasGeoField()&&n.push(e.context):n.push(e.context)})}),n},createLayerGroupConfiguration:function(){return{color:"#369",title:"Calque #1",displayed:!0,picto:"icon-circle",activeDatasets:[]}},createLayerConfiguration:function(e,t){angular.isUndefined(t)&&(t={});var n=t.display||"auto";return"clusters"===n&&(n="polygon"),"clustersforced"===n&&(n="polygonforced"),"raw"===n&&(n="none"),{context:null,color:t.color,picto:t.picto,clusterMode:n,func:t.function||(t.expression?"AVG":"COUNT"),expr:t.expression||null,marker:null,tooltipTemplate:e,localKey:t.localKey||null,remoteKey:t.remoteKey||null,tooltipSort:t.tooltipSort,hoverField:t.hoverField||null,opacity:t.opacity,borderColor:t.borderColor}}}}}]),e.factory("MapLayerRenderer",["ODSAPI","AggregationHelper","SVGInliner","PictoHelper","$q","$filter","$rootScope","$compile","$timeout",function(e,t,n,r,a,i,o,s,l){return{updateDataLayer:function(t,n){var r=this,i=t.rendered;t.currentRequestTimeout&&t.currentRequestTimeout.resolve();var s=a.defer();t.currentRequestTimeout=s;var u=a.defer();if("tiles"===t.clusterMode){t.rendered||(t.rendered=new L.BundleTileLayer("",{tileSize:512,minZoom:n.getMinZoom(),maxZoom:n.getMaxZoom(),gridLayer:{options:{resolution:4}}}),n.addLayer(t.rendered),l(function(){t.rendered.on("loading",function(){t.loading=!0,o.$apply()}),t.rendered.on("load",function(){t.loading=!1,o.$apply()})},0),r.bindTooltip(n,t.rendered,t));var c={color:t.color,icon:t.picto,showmarker:t.marker};angular.extend(c,t.context.parameters);var d="/api/datasets/1.0/"+t.context.dataset.datasetid+"/tiles/simple/{z}/{x}/{y}.bundle",f="";angular.forEach(c,function(e,t){null!==e&&(f+=f?"&":"?",f+=t+"="+encodeURIComponent(e))}),d+=f,t.rendered._url!==d&&t.rendered.setUrl(d),u.resolve()}else if("none"===t.clusterMode||n.getZoom()===n.getMaxZoom()&&"polygon"===t.clusterMode)t.loading=!0,this.buildRawLayer(t,n,s).then(function(e){r.swapLayers(n,i,e),t.rendered=e,t.currentRequestTimeout=null,t.loading=!1,u.resolve()});else if("polygon"===t.clusterMode||"polygonforced"===t.clusterMode)t.loading=!0,this.buildClusteredLayer(t,n,s,!0).then(function(e){r.swapLayers(n,i,e),t.rendered=e,t.currentRequestTimeout=null,t.loading=!1,u.resolve()});else if("heatmap"===t.clusterMode)t.loading=!0,this.buildHeatmapLayer(t,n,s).then(function(e){r.swapLayers(n,i,e),t.rendered=e,t.currentRequestTimeout=null,t.loading=!1,u.resolve()});else if("shape"===t.clusterMode||"aggregation"===t.clusterMode)t.loading=!0,this.buildAggregationLayer(t,n,s).then(function(e){r.swapLayers(n,i,e),t.rendered=e,t.currentRequestTimeout=null,t.loading=!1,u.resolve()});else if("auto"===t.clusterMode){t.loading=!0;var p=angular.extend({},t.context.parameters,{"geofilter.bbox":ODS.GeoFilter.getBoundsAsBboxParameter(n.getBounds())});e.records.boundingbox(t.context,p).success(function(e){var a=e.count<5e5;e.count<200||n.getZoom()===n.getMaxZoom()?r.buildRawLayer(t,n,s).then(function(e){r.swapLayers(n,i,e),t.rendered=e,t.currentRequestTimeout=null,t.loading=!1,u.resolve()}):e.count<5e5?e.geometries.Point&&e.geometries.Point>e.count/2?r.buildClusteredLayer(t,n,s,a).then(function(e){r.swapLayers(n,i,e),t.rendered=e,t.currentRequestTimeout=null,t.loading=!1,u.resolve()}):r.buildShapePreviewLayer(t,n,s).then(function(e){r.swapLayers(n,i,e),t.rendered=e,t.currentRequestTimeout=null,t.loading=!1,u.resolve()}):r.buildClusteredLayer(t,n,s,a).then(function(e){r.swapLayers(n,i,e),t.rendered=e,t.currentRequestTimeout=null,t.loading=!1,u.resolve()})})}return u.promise},swapLayers:function(e,t,n){t&&e.removeLayer(t),e.addLayer(n)},buildRawLayer:function(t,i,o){var s=this,l=a.defer(),u=new L.LayerGroup,c=angular.extend({},t.context.parameters,{rows:1e4,format:"json","geofilter.bbox":ODS.GeoFilter.getBoundsAsBboxParameter(i.getBounds())}),d=t.context.dataset.getFieldsForType("geo_shape"),f=d.length?d[0].name:null;return e.records.download(t.context,c,o.promise).success(function(e){for(var a=0;a<e.length;a++){var o,c=e[a];if(f){if(!c.fields[f])return;"Point"===(o=c.fields[f]).type&&angular.isDefined(c.geometry)&&(o=c.geometry)}else{if(!c.geometry)return;o=c.geometry}if("Point"===o.type)!function(e,a){n.getPromise(r.mapPictoToURL(t.picto,t.context),t.marker?"white":s.getRecordColor(a,t)).then(function(n){var r=new L.VectorMarker([e.coordinates[1],e.coordinates[0]],{color:s.getRecordColor(a,t),icon:n,marker:t.marker});s.bindTooltip(i,r,t,e,a.recordid),u.addLayer(r)})}(o,c);else{var d=new L.GeoJSON(o,{style:function(e){var n={radius:3,weight:1,opacity:.9,fillOpacity:.5,color:s.getRecordColor(c,t)};return n.fillColor=s.getRecordColor(c,t),"LineString"===e.geometry.type||"MultiLineString"===e.geometry.type?(n.weight=5,n.color=s.getRecordColor(c,t)):n.color="#fff",n}});s.bindTooltip(i,d,t,o,c.recordid),u.addLayer(d)}}l.resolve(u)}),l.promise},buildClusteredLayer:function(t,i,o,s){var l=this,u=a.defer(),c=new L.LayerGroup,d=angular.extend({},t.context.parameters,{clusterdistance:50,clusterprecision:i.getZoom(),"geofilter.bbox":ODS.GeoFilter.getBoundsAsBboxParameter(i.getBounds()),return_polygons:s});return"COUNT"!==t.func&&l.isAnalyzeEnabledClustering(t)&&(d["y.serie1.expr"]=t.expr,d["y.serie1.func"]=t.func),e.records.geo(t.context,d,o.promise).success(function(e){for(var a=e.clusters,o=0;o<a.length;o++){var s=a[o];if(1===s.count&&"polygonforced"!==t.clusterMode)!function(e){n.getPromise(r.mapPictoToURL(t.picto,t.context),t.marker?"white":t.color).then(function(n){var r=new L.VectorMarker(e.cluster_center,{color:t.color,icon:n,marker:t.marker});l.bindTooltip(i,r,t,e.cluster),c.addLayer(r)})}(s);else if(null!==l.getClusterValue(s,t)){var d=new L.ClusterMarker(s.cluster_center,{geojson:s.cluster,value:l.getClusterValue(s,t),total:l.getClusterMax(e,t),color:t.color,numberFormattingFunction:l.formatNumber});l.bindZoomable(i,d,t),c.addLayer(d)}}u.resolve(c)}),u.promise},buildHeatmapLayer:function(t,n,r){var i=this,o=a.defer(),s=L.TileLayer.heatMap({zIndex:10,radius:{absolute:!1,value:20},opacity:.8,gradient:{.45:"rgb(0,0,255)",.55:"rgb(0,255,255)",.65:"rgb(0,255,0)",.95:"yellow",1:"rgb(255,0,0)"}}),l=angular.extend({},t.context.parameters,{clustermode:"heatmap",clusterdistance:15,clusterprecision:n.getZoom(),"geofilter.bbox":ODS.GeoFilter.getBoundsAsBboxParameter(n.getBounds())});return"COUNT"!==t.func&&i.isAnalyzeEnabledClustering(t)&&(l["y.serie1.expr"]=t.expr,l["y.serie1.func"]=t.func),e.records.geo(t.context,l,r.promise).success(function(e){var n=e.clusters;s.options.radius.value=Math.min(1/e.clusters.length*4e3+20,50);for(var r=[],a=0;a<n.length;a++){var l=n[a];null!==i.getClusterValue(l,t)&&r.push({lat:l.cluster_center[0],lon:l.cluster_center[1],value:i.getClusterValue(l,t)-i.getClusterMin(e,t)+1})}r.length>0&&s.setData(r),o.resolve(s)}),o.promise},buildAggregationLayer:function(n,r,i){function o(e){var a=l(e);if(0!==a.length){var i=c.getClusterMin(e,n),o=c.getClusterMax(e,n),u=c.getClusterValues(e,n),p=function(e){return c.getColor(e,n,i,o,u.length)},h={radius:3,color:"#fff",weight:1,opacity:.9,fillOpacity:.5};if((!angular.isObject(n.color)||"range"!==n.color.type)&&("COUNT"!==n.func&&c.isAnalyzeEnabledClustering(n)||i!==o)){L.Legend=L.Control.extend({initialize:function(e){L.Control.prototype.initialize.call(this,e)},onAdd:function(e){var r=chroma.scale().domain([i,o],Math.min(10,u.length)).domain(),a="",s=L.DomUtil.create("div","odswidget-map__legend"),l=n.context.dataset.datasetid,d=n.expr;if(d&&(d=n.context.dataset.getFieldLabel(n.expr)),l=n.context.dataset.metas.title,a+='<div class="odswidget-map__legend-title">'+l+"<br/>"+t.getFunctionLabel(n.func),"COUNT"!==n.func&&(a+=" "+d),a+="</div>",a+='<div class="odswidget-map__legend-colors">',1===u.length)a+='<i class="color_0" style="width: 90%; background-color:'+p((r[0]+r[1])/2)+'; opacity: 1;"></i>',a+='</div><div class="odswidget-map__legend-counts">',a+='<span class="odswidget-map__legend-value">',a+=c.formatNumber(r[0]),a+="</span>";else{for(var f=90/(r.length-1),h=0;h<r.length-1;h++)a+='<i class="odswidget-map__legend-color" style="width:'+f+"%; background-color:"+p((r[h]+r[h+1])/2)+'; opacity: 1;"></i>';a+="</div><div>",a+='<span class="odswidget-map__legend-value">',a+=c.formatNumber(r[0]),a+="</span>",a+='<span class="odswidget-map__legend-value">',a+=c.formatNumber(r[r.length-1]),a+="</span>"}return a+="</div>",s.innerHTML=a,s}});var g=new L.Legend({position:"bottomleft"}),m=function(e){e.layer===f&&(r.addControl(g),r.off("layeradd",m))};r.on("layeradd",m);var v=function(e){e.layer===f&&(r.removeControl(g),r.off("layerremove",v))};r.on("layerremove",v)}for(var y=0;y<a.length;y++){var b,x,w=a[y],$=c.getClusterValue(w,n),C=function(e,t){return L.circleMarker(t,h)};null!==$&&(x=s(w))&&(b=new L.GeoJSON(x,{pointToLayer:C,highlight:c.getColor($,n,i,o,u.length),style:function(e){var t=angular.copy(h);return t.fillColor=p($),angular.isDefined(n.opacity)&&(t.fillOpacity=n.opacity),"LineString"===e.geometry.type||"MultiLineString"===e.geometry.type?(t.weight=5,t.color=p($)):angular.isDefined(n.borderColor)&&(t.color=n.borderColor),t}}),"LineString"!==x.type&&"MultiLineString"!==x.type&&function(e,t,n,r){t.on("mouseover",function(e){e.target.setStyle({weight:2})}),t.on("mouseout",function(e){e.target.setStyle({weight:1})})}(0,b),n.joinContext&&n.hoverField?w.x[0].fields[n.hoverField]?(b.bindLabel(w.x[0].fields[n.hoverField]),n.refineOnClick&&c.bindTooltip(r,b,n,x,null,w.geo_digest,w.x[0].fields[n.hoverField])):n.refineOnClick&&c.bindTooltip(r,b,n,x,null,w.geo_digest):(("COUNT"!==n.func&&c.isAnalyzeEnabledClustering(n)||i!==o)&&b.bindLabel(c.formatNumber($)),n.refineOnClick&&c.bindTooltip(r,b,n,x,null,w.geo_digest)),f.addLayer(b))}d.resolve(f)}else d.resolve(f)}var s,l,u,c=this,d=a.defer(),f=new L.LayerGroup;if(n.joinContext){var p=n.localKey,h=n.remoteKey;p&&h||console.error("An aggregation layer with a remote dataset requires a local-key and a remote-key");var g=n.joinContext.dataset.getFieldsForType("geo_shape");g.length||console.error("You can only join an aggregation layer with a dataset that contains a geo_shape field.");var m=g[0].name;s=function(e){return e.x[0].fields?e.x[0].fields[m]:null},l=function(e){return e.results};var v=m;n.hoverField&&(v+=","+n.hoverField),u=angular.extend({},n.context.parameters,{clusterprecision:r.getZoom(),"geofilter.bbox":ODS.GeoFilter.getBoundsAsBboxParameter(r.getBounds()),"join.agg1.fields":v,"join.agg1.remotedataset":n.joinContext.dataset.datasetid,"join.agg1.remotekey":h,"join.agg1.localkey":p,"agg.agg1.func":"MIN,MAX","agg.agg1.expr":"serie1","y.serie1.expr":n.expr,"y.serie1.func":n.func}),e.records.analyze(n.context,u,i.promise).success(o)}else s=function(e){return e.cluster},l=function(e){return e.clusters},u=angular.extend({},n.context.parameters,{clusterprecision:r.getZoom(),"geofilter.bbox":ODS.GeoFilter.getBoundsAsBboxParameter(r.getBounds())}),"COUNT"!==n.func&&c.isAnalyzeEnabledClustering(n)&&(u["y.serie1.expr"]=n.expr,u["y.serie1.func"]=n.func),e.records.geopolygon(n.context,u,i.promise).success(o);return d.promise},buildShapePreviewLayer:function(t,n,r){var i=this,o=a.defer(),s=angular.extend({},t.context.parameters,{rows:1e3,clusterprecision:n.getZoom(),"geofilter.bbox":ODS.GeoFilter.getBoundsAsBboxParameter(n.getBounds())}),l=new L.LayerGroup;return e.records.geopreview(t.context,s,r.promise).success(function(e){for(var r,a=0;a<e.length;a++){r=e[a];var s={radius:3,color:"#fff",weight:1,opacity:.9,fillOpacity:.5,fillColor:t.color},u=new L.GeoJSON(r.geometry,{pointToLayer:function(e,t){return L.circleMarker(t,s)},style:function(e){var n=angular.copy(s);return"LineString"!==e.geometry.type&&"MultiLineString"!==e.geometry.type||(n.weight=5,n.color=t.color),n}});l.addLayer(u),i.bindTooltip(n,u,t,r.geometry,null,r.geo_digest)}o.resolve(l)}),o.promise},getRecordColor:function(e,t){if(angular.isString(t.color))return t.color;if("range"===t.color.type){if(t.color.field){var n=e.fields[t.color.field];return angular.isUndefined(n)?t.color.colors[0]:this.getColor(n,t)}return console.error("Range coloring requires a field"),t.color.colors[0]}return console.error("Scale coloring is not supported for simple records"),chroma.scale(t.color.scale).out("hex").scale(0)},getColor:function(e,t,n,r,a){if(a=a||10,angular.isString(t.color))return angular.isDefined(n)&&angular.isDefined(r)?chroma.scale([chroma(t.color).brighten(50),t.color]).domain([n,r],Math.min(10,a)).out("hex")(e):t.color;if("scale"===t.color.type)return chroma.scale(t.color.scale).domain([n,r],Math.min(10,a)).out("hex")(e);if("range"===t.color.type){var i;for(i=0;i<t.color.ranges.length;i++)if(e<t.color.ranges[i])return t.color.colors[i];return t.color.colors[t.color.colors.length-1]}},bindTooltip:function(e,t,n,r,a,i,o){var s=this;n.refineOnClick?t.on("click",function(t){e.isDrawing||s.refineContextOnClick(n,r,i,o)}):t.on("click",function(t){if(!e.isDrawing&&(r||a||i||t.data)){var o,l;angular.isDefined(t.target.getLatLng)?o=t.target.getLatLng():(o=t.latlng,l=0),s.showPopup(e,n,o,r,a,i,l,t.data||null)}})},refineContextOnClick:function(t,n,r,a){var i=function(i){var s=i.contextField,l=i.mapField,u=i.context,c=i.replaceRefine;if(l||s)if(angular.isDefined(a)&&l==t.hoverField)o.$apply(function(){u.toggleRefine(s,a,c)});else{var d={format:"json"};r?d.geo_digest=r:ODS.GeoFilter.addGeoFilterFromSpatialObject(d,n),angular.extend(d,t.context.parameters,{rows:1}),e.records.download(t.context,d).success(function(e){angular.isDefined(e[0].fields[l])&&u.toggleRefine(s,e[0].fields[l],c)})}else o.$apply(function(){ODS.GeoFilter.addGeoFilterFromSpatialObject(u.parameters,n)})};angular.forEach(t.refineOnClick,i)},bindZoomable:function(e,t,n){t.on("click",function(t){e.isDrawing||(e.getZoom()===e.getMaxZoom()?this.showPopup(e,n,t.target.getLatLng(),t.target.getClusterShape()):e.setView(t.latlng,e.getZoom()+2))})},showPopup:function(e,t,n,r,a,i,l,u){var c=o.$new(!0);a&&(c.recordid=a),r&&(c.shape=r),u&&(c.gridData=u);var d=t.context.dataset;c.map=e,c.template=t.tooltipTemplate||d.extra_metas&&d.extra_metas.visualization&&d.extra_metas.visualization.map_tooltip_html||"";var f={offset:[0,angular.isDefined(l)?l:-30],maxWidth:250,minWidth:250};c.context=t.context,new L.Popup(f).setLatLng(n).setContent(s('<ods-map-tooltip tooltip-sort="'+(t.tooltipSort||"")+'" shape="shape" recordid="recordid" context="context" map="map" template="{{ template }}" grid-data="gridData" geo-digest="'+(i||"")+'"></ods-map-tooltip>')(c)[0]).openOn(e)},formatNumber:function(e){return e=Math.round(100*e)/100,e=i("number")(e)},getClusterValue:function(e,t){return"aggregation"===t.clusterMode&&t.joinContext?e.serie1:"COUNT"!==t.func&&this.isAnalyzeEnabledClustering(t)?e.series?e.series.serie1:null:e.count},getClusterMin:function(e,t){return"aggregation"===t.clusterMode&&t.joinContext?e.aggregations.agg1.min:"COUNT"!==t.func&&this.isAnalyzeEnabledClustering(t)?e.series.serie1.min:e.count.min},getClusterMax:function(e,t){return"aggregation"===t.clusterMode&&t.joinContext?e.aggregations.agg1.max:"COUNT"!==t.func&&this.isAnalyzeEnabledClustering(t)?e.series.serie1.max:e.count.max},getClusterValues:function(e,t){var n,r=[];if("aggregation"===t.clusterMode&&t.joinContext)for(n=0;n<e.results.length;n++)r.push(e.results[n].serie1);else if("COUNT"!==t.func&&this.isAnalyzeEnabledClustering(t))for(n=0;n<e.clusters.length;n++)e.clusters[n].series&&r.push(e.clusters[n].series.serie1);else for(n=0;n<e.clusters.length;n++)r.push(e.clusters[n].count);return r},isAnalyzeEnabledClustering:function(e){return"heatmap"===e.clusterMode||"polygonforced"===e.clusterMode||"shape"===e.clusterMode||"aggregation"===e.clusterMode},doesLayerRefreshOnLocationChange:function(e){return"tiles"!==e.clusterMode&&("shape"!==e.clusterMode&&"aggregation"!==e.clusterMode||!e.joinContext)}}}])}(),function(){"use strict";var e=angular.module("ods-widgets"),t={},n=[];e.provider("ModuleLazyLoader",function(){var e={highcharts:{css:[],js:[["https://code.highcharts.com/3.0.10/highcharts.js"],["https://code.highcharts.com/3.0.10/modules/no-data-to-display.js"],["https://code.highcharts.com/3.0.10/highcharts-more.js"],["https://code.highcharts.com/modules/treemap.js"]]},leaflet:{css:["https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css","https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v0.0.3/leaflet.fullscreen.css","https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.24.0/L.Control.Locate.css","libs/leaflet-control-geocoder/Control.Geocoder.css","libs/ods-vectormarker/vectormarker.css","libs/ods-clustermarker/clustermarker.css","libs/leaflet-label/leaflet.label.css","libs/leaflet-draw/leaflet.draw.css"],js:[["L@https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.js"],["L.Control.FullScreen@https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v0.0.3/Leaflet.fullscreen.min.js","L.Control.Locate@https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-locatecontrol/v0.24.0/L.Control.Locate.js","L.Label@libs/leaflet-label/leaflet.label.js","L.ODSMap@libs/ods-map/ods-map.js","L.ODSTileLayer@libs/ods-map/ods-tilelayer.js","L.Control.Geocoder@libs/leaflet-control-geocoder/Control.Geocoder.js","L.VectorMarker@libs/ods-vectormarker/vectormarker.js","L.ClusterMarker@libs/ods-clustermarker/clustermarker.js","L.Draw@libs/leaflet-draw/leaflet.draw.js","QuadTree@libs/leaflet-heatmap/QuadTree.js","h337@libs/leaflet-heatmap/heatmap.js","L.TileLayer.HeatMap@libs/leaflet-heatmap/heatmap-leaflet.js"]]},rome:{css:["libs/rome/rome.css"],js:["libs/rome/rome.standalone.js"]},fullcalendar:{css:["libs/fullcalendar/fullcalendar.min.css"],js:["libs/fullcalendar/fullcalendar.min.js"],language_specific:{ar:{js:["libs/fullcalendar/lang/ar.js"]},fr:{js:["libs/fullcalendar/lang/fr.js"]},nl:{js:["libs/fullcalendar/lang/nl.js"]}}},qtip:{css:["libs/qtip/jquery.qtip.min.css"],js:["libs/qtip/jquery.qtip.min.js"]}};this.getConfig=function(){return e};var r=function(e,t){var n=t.split(".");if(e.hasOwnProperty(n[0])&&angular.isDefined(e[n[0]])){if(1===n.length)return!0;var a=e[n[0]];return n.shift(),r(a,n.join("."))}return!1},a=function(e){return r(window,e)};this.$get=["$q","ODSWidgetsConfig",function(r,i){var o=function(e,a){if(angular.isUndefined(t[a])){var o=r.defer();t[a]=o;var s="/"===a.substring(0,1)||"http://"===a.substring(0,7)||"https://"===a.substring(0,8)?a:i.basePath+a;LazyLoad[e](s,function(){o.resolve(),n.push(a)}),t[a]=o}return t[a]},s=function(e,i,l,u){var c,d=[];if(angular.isUndefined(u)&&(u=0),u>=i.length)l.resolve();else{c=i[u],angular.isArray(c)||(c=[c]);for(var f=0;f<c.length;f++){var p,h=c[f].split("@");if(h.length>1){if(a(h[0]))continue;p=h[1]}else p=h[0];-1===n.indexOf(p)?d.push(o(e,p).promise):d.push(t[p].promise)}r.all(d).then(function(){s(e,i,l,u+1)})}return l.promise};return function(){for(var t=[],n=0;n<arguments.length;n++){var a=e[arguments[n]];a.language_specific&&a.language_specific[i.language]&&angular.forEach(a.language_specific[i.language],function(e,t){a[t]?a[t]=a[t].concat(e):a[t]=e}),a.css&&t.push(s("css",a.css,r.defer())),a.js&&t.push(s("js",a.js,r.defer()))}return r.all(t)}}]}),e.factory("DebugLogger",["$window",function(e){return{log:function(){("#debug"==e.location.hash||e.location.hash.indexOf("debug=")>=0||$(document.body).hasClass("showDebug"))&&console.log.apply(console,arguments)}}}]),e.factory("odsErrorService",function(){var e=[];return{registerForErrorNotification:function(t){e.push(t)},sendErrorNotification:function(t){angular.isString(t)&&(t={title:"Error",error:t}),angular.forEach(e,function(e){e(t)})},markErrorAsHandled:function(e){e.handled=!0}}}),e.provider("SVGInliner",function(){var e={},t='<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg id="dot-icon" width="19px" height="19px" viewBox="0 0 19 19" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">    <path d="M13,9.50004202 C13,11.4330618 11.4329777,13.000084 9.49995798,13.000084 C7.56693813,13.000084 5.99991595,11.4330618 5.99991595,9.50004202 C5.99991595,7.56702218 7.56693813,6 9.49995798,6 C11.4329777,6 13,7.56702218 13,9.50004202 L13,9.50004202 Z" id="path8568" fill="#000000"></path>    <rect style="opacity: 0" x="0" y="0" width="19" height="19"></rect></svg>',n=function(e,t,n){var r=angular.element(t);n&&(r.css("fill",n),r.find("path, polygon, circle, rect, text").css("fill",n)),e.append(r)};this.$get=["$http","$q",function(r,a){var i=function(i,o,s){var l;s&&(l=a.defer());var u=angular.element("<div></div>");if(i)if(-1===i.indexOf(".svg"))u.append(angular.element('<img src="'+i+'"/>')),s&&l.resolve(u);else if(e[i])e[i].code?(n(u,e[i].code,o),s&&l.resolve(u)):e[i].promise.success(function(e){n(u,e,o),s&&l.resolve(u)}).error(function(){n(u,t,o),s&&l.resolve(u)});else{var c=r.get(i);e[i]={promise:c},c.success(function(t){e[i].code=t,n(u,t,o),s&&l.resolve(u)}).error(function(r,a){console.log("WARNING: Unable to fetch SVG image",i,"HTTP status:",a),e[i].code=t,n(u,t,o),s&&l.resolve(u)})}else n(u,t,o),s&&l.resolve(u);return s?l.promise:u};return{getElement:function(e,t){return i(e,t)},getPromise:function(e,t){return i(e,t,!0)}}}]}),e.service("PictoHelper",function(){var e={"ban-circle":"ban","bar-chart":"bar-chart-o",beaker:"flask",bell:"bell-o","bell-alt":"bell","bitbucket-sign":"bitbucket-square","bookmark-empty":"bookmark-o",building:"building-o (4.0.2)","calendar-empty":"calendar-o","check-empty":"square-o","check-minus":"minus-square-o","check-sign":"check-square",check:"check-square-o","chevron-sign-down":"chevron-down","chevron-sign-left":"chevron-left","chevron-sign-right":"chevron-right","chevron-sign-up":"chevron-up","circle-arrow-down":"arrow-circle-down","circle-arrow-left":"arrow-circle-left","circle-arrow-right":"arrow-circle-right","circle-arrow-up":"arrow-circle-up","circle-blank":"circle-o",cny:"rub","collapse-alt":"minus-square-o","collapse-top":"caret-square-o-up",collapse:"caret-square-o-down","comment-alt":"comment-o","comments-alt":"comments-o",copy:"files-o",cut:"scissors",dashboard:"tachometer","double-angle-down":"angle-double-down","double-angle-left":"angle-double-left","double-angle-right":"angle-double-right","double-angle-up":"angle-double-up",download:"arrow-circle-o-down","download-alt":"download","edit-sign":"pencil-square",edit:"pencil-square-o","ellipsis-horizontal":"ellipsis-h (4.0.2)","ellipsis-vertical":"ellipsis-v (4.0.2)","envelope-alt":"envelope-o","exclamation-sign":"exclamation-circle","expand-alt":"plus-square-o (4.0.2)",expand:"caret-square-o-right","external-link-sign":"external-link-square","eye-close":"eye-slash","eye-open":"eye","facebook-sign":"facebook-square","facetime-video":"video-camera","file-alt":"file-o","file-text-alt":"file-text-o","flag-alt":"flag-o","folder-close-alt":"folder-o","folder-close":"folder","folder-open-alt":"folder-open-o",food:"cutlery",frown:"frown-o",fullscreen:"arrows-alt (4.0.2)","github-sign":"github-square","google-plus-sign":"google-plus-square",group:"users (4.0.2)","h-sign":"h-square","hand-down":"hand-o-down","hand-left":"hand-o-left","hand-right":"hand-o-right","hand-up":"hand-o-up",hdd:"hdd-o (4.0.1)","heart-empty":"heart-o",hospital:"hospital-o (4.0.2)","indent-left":"outdent","indent-right":"indent","info-sign":"info-circle",keyboard:"keyboard-o",legal:"gavel",lemon:"lemon-o",lightbulb:"lightbulb-o","linkedin-sign":"linkedin-square",meh:"meh-o","microphone-off":"microphone-slash","minus-sign-alt":"minus-square","minus-sign":"minus-circle","mobile-phone":"mobile",moon:"moon-o",move:"arrows (4.0.2)",off:"power-off","ok-circle":"check-circle-o","ok-sign":"check-circle",ok:"check","paper-clip":"paperclip",paste:"clipboard","phone-sign":"phone-square",picture:"picture-o","pinterest-sign":"pinterest-square","play-circle":"play-circle-o","play-sign":"play-circle","plus-sign-alt":"plus-square","plus-sign":"plus-circle",pushpin:"thumb-tack","question-sign":"question-circle","remove-circle":"times-circle-o","remove-sign":"times-circle",remove:"times",reorder:"bars (4.0.2)","resize-full":"expand (4.0.2)","resize-horizontal":"arrows-h (4.0.2)","resize-small":"compress (4.0.2)","resize-vertical":"arrows-v (4.0.2)","rss-sign":"rss-square",save:"floppy-o",screenshot:"crosshairs","share-alt":"share","share-sign":"share-square",share:"share-square-o","sign-blank":"square",signin:"sign-in",signout:"sign-out",smile:"smile-o","sort-by-alphabet-alt":"sort-alpha-desc","sort-by-alphabet":"sort-alpha-asc","sort-by-attributes-alt":"sort-amount-desc","sort-by-attributes":"sort-amount-asc","sort-by-order-alt":"sort-numeric-desc","sort-by-order":"sort-numeric-asc","sort-down":"sort-desc","sort-up":"sort-asc",stackexchange:"stack-overflow","star-empty":"star-o","star-half-empty":"star-half-o",sun:"sun-o","thumbs-down-alt":"thumbs-o-down","thumbs-up-alt":"thumbs-o-up",time:"clock-o",trash:"trash-o","tumblr-sign":"tumblr-square","twitter-sign":"twitter-square",unlink:"chain-broken",upload:"arrow-circle-o-up","upload-alt":"upload","warning-sign":"exclamation-triangle","xing-sign":"xing-square","youtube-sign":"youtube-square","zoom-in":"search-plus","zoom-out":"search-minus"};return{mapPictoToURL:function(t,n){if(!t)return null;var r=n&&n.domainUrl||"";if(t.startsWith("icon-")){var a=t.replace("icon-","");e[a]&&(a=e[a]),r+="/static/pictos/img/set-v1/fa/"+a+".svg"}else t.startsWith("pdpicto-")||t.startsWith("odspicto-")?r+="/static/pictos/img/set-v1/"+(t=t.replace("pdpicto-","pdpicto/").replace("odspicto-","odspicto/"))+".svg":r+="/static/pictos/img/set-v2/"+t+".svg";return r}}}),e.factory("URLSynchronizer",["$location","$document",function(e,t){var n=!1,r=[];t.bind("webkitfullscreenchange mozfullscreenchange ofullscreenchange msfullscreenchange khtmlfullscreenchange",function(){if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)n=!0;else{n=!1;for(var e=0;e<r.length;e++)r[e]()}});var a=[];return{addSynchronizedValue:function(t,i,o,s){a.push(i),o&&a.push(o);var l=e.search()[o||i];t.$eval(i+"=newObj",{newObj:l});var u=function(){var n=t.$eval(i);s&&e.replace(),e.search(o||i,n)},c=t.$watch(i,function(e,t){n||u()},!0);r.push(u);var d=t.$watch(function(){return e.search()[o||i]},function(e,n){e&&t.$eval(i+"=newObj",{newObj:e})},!0);return function(){c(),d()}},addJSONSynchronizedObject:function(t,i,o){a.push(o||i);var s=e.search()[o||i];s&&("{"===s[0]?t.$eval(i+"=newObj",{newObj:JSON.parse(s)}):t.$eval(i+"=newObj",{newObj:JSON.parse(b64_to_utf8(s))}));var l,u=function(){var n=t.$eval(i);void 0===n&&(n=""),l=utf8_to_b64(angular.toJson(n)),e.search(o||i,l)};return r.push(u),t.$watch(function(){return[t.$eval(i),e.search()[o||i]]},function(e,r){void 0===e[0]&&(e[0]=""),l===utf8_to_b64(angular.toJson(e[0]))||n?l!==e[1]&&e[1]&&t.$eval(function(t){t[i]=JSON.parse(b64_to_utf8(e[1]))}):u()},!0)},addSynchronizedObject:function(t,i,o){o=o||[];var s=function(){var n=angular.copy(e.search());if(angular.forEach(n,function(e,t){a.indexOf(t)>=0&&delete n[t]}),o.length>0){var r=t.$eval(i);angular.forEach(o,function(e){angular.isDefined(r[e])&&(n[e]=r[e])})}t.$eval(i+"=newVal",{newVal:n})},l=function(){var n=angular.copy(t.$eval(i));angular.forEach(o,function(e){angular.isDefined(n[e])&&delete n[e]}),angular.forEach(e.search(),function(e,t){(a.indexOf(t)>=0||o.indexOf(t)>=0)&&(n[t]=e)}),e.search(n)};s();var u=t.$watch(i,function(e,t){n||l()},!0);r.push(l);var c=t.$watch(function(){return e.search()},s,!0);return function(){u(),c()}}}}])}(),function(){"use strict";angular.module("ods-widgets").service("ValueDisplay",["$filter",function(e){var t={language:function(t){return e("isocode_to_language")(t)},visualization:function(e){switch(e){case"analyze":return'<i class="fa fa-bar-chart"></i> <span translate>Analyze</span>';case"calendar":return'<i class="fa fa-calendar"></i> <span translate>Calendar</span>';case"geo":return'<i class="fa fa-globe"></i> <span translate>Map</span>';case"image":return'<i class="fa fa-picture-o"></i> <span translate>Image</span>';case"api":return'<i class="fa fa-cogs"></i> <span translate>API</span>';default:return e}}};return{format:function(e,n){return angular.isDefined(t)?t[n](e):(console.log('Warning (ValueDisplay): unknown value formatter "'+n+'"'),e)}}}])}(),function(){"use strict";var e=angular.module("ods-widgets");e.filter("nofollow",function(){return function(e){return angular.isString(e)?e.replace(/<a href="/g,'<a target="_blank" rel="nofollow" href="'):e}}),e.filter("prettyText",["$filter",function(e){function t(e){return e.replace(/&/g,"&amp;").replace(r,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}var n=/[<>]+/,r=/([^\#-~| |!])/g;return function(r){return r&&angular.isString(r)?n.test(r)?t(r):e("linky")(r,"_blank"):r}}]),e.filter("safenewlines",function(){return function(e){return e?e.replace(/\n/g,"<br/>").replace(/&#10;/g,"<br/>"):e}}),e.filter("imagify",["$sce",function(e){var t=/^(http(?:s?):\/\/[^;,]*(?:jpg|jpeg|png|gif)(?:\?[^,;]*)?)(?:$|;|,|&)/i;return function(n){if(angular.isString(n)){n=n.trim();var r=t.exec(n);if(null!==r)return e.trustAsHtml('<img class="odswidget odswidget-imagified" src="'+r[1]+'" />')}return n}}]),e.filter("videoify",["$sce",function(e){var t=/^https?:\/\/(?:(?:youtu.be\/)|(?:(?:www.)?youtube.com\/watch\?v=))([0-9a-z_-]+)$/i,n=/^https?:\/\/(?:(?:dai.ly)|(?:www.dailymotion.com))\/(?:video\/)?([0-9a-z]+)(?:[0-9a-z_-]*)$/i,r=/^https?:\/\/vimeo.com\/([0-9]+)$/i;return function(a){if(angular.isString(a)){var i=t.exec(a.trim());if(null!==i)return e.trustAsHtml('<iframe width="200" height="113" src="//www.youtube.com/embed/'+i[1]+'" frameborder="0" allowfullscreen></iframe>');if(null!==(i=n.exec(a.trim())))return e.trustAsHtml('<iframe frameborder="0" width="200" height="113" src="//www.dailymotion.com/embed/video/'+i[1]+'" allowfullscreen></iframe>');if(null!==(i=r.exec(a.trim())))return e.trustAsHtml('<iframe src="https://player.vimeo.com/video/'+i[1]+'" width="200" height="113" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>')}return a}}]),e.filter("isDefined",function(){return function(e){return angular.isDefined(e)}}),e.filter("displayImageValue",function(e){return function(t,n){if(!t)return t;var r="/explore/dataset/"+n+"/files/"+t.id+"/300/";return e.trustAsHtml('<img class="odswidget odswidget-imagified" src="'+r+'" />')}}),e.filter("fieldsForVisualization",function(){var e={table:[],map:["geo_point_2d","geo_shape"],images:["file"],calendar:[]};return function(t,n){if(angular.isUndefined(t))return t;if(angular.isUndefined(e[n]))throw'Unknown visualization type "'+n+"'";return t.filter(function(t){return-1===e[n].indexOf(t.type)})}}),e.filter("formatFieldValue",["$filter","$sce",function(e,t){var n=function(e){if(e.annotations){var t=e.annotations.filter(function(e){return"timeserie_precision"===e.name});if(t.length>0)return t[0].args[0]}return null};return function(r,a){var i=r[a.name];if(null===i||void 0===i)return"";if("int"===a.type||"double"===a.type){var o="";if(a.annotations)for(var s=0;s<a.annotations.length;s++)"unit"===a.annotations[s].name&&(o=a.annotations[s].args[0]);var l=e("number")(i);return o&&(l="$"===o?o+l:l+" "+o),l}if("geo_point_2d"===a.type)return i[0]+", "+i[1];if("geo_shape"===a.type)return e("limitTo")(angular.toJson(i),200);if("date"===a.type){var u=n(a);if("year"===u)return i;if("month"===u){var c=moment(i,"YYYY-MM");return e("capitalize")(e("moment")(c,"MMMM YYYY"))}return e("moment")(i,"LL")}return"datetime"===a.type?(19===i.length&&(i+="Z"),e("moment")(i,"LLL")):"file"===a.type?angular.isObject(i)?t.trustAsHtml('<a target="_self" href="files/'+i.id+'/download/">'+(i.filename||r.filename)+"</a>"):""+i:e("limitTo")(""+i,1e3)}}]),e.filter("capitalize",[function(){return function(e){return ODS.StringUtils.capitalize(e)}}]),e.filter("truncate",function(){return function(e,t){return e&&angular.isString(e)?(t||(t=200),e.substring(0,t)):e}}),e.filter("fieldsFilter",function(){return function(e,t){if(!e)return e;if(angular.isArray(t)&&t.length){var n=[];return angular.forEach(t,function(t){var r=$.grep(e,function(e){return e.name===t})[0];angular.isDefined(r)&&n.push(r)}),n}return e}}),e.filter("moment",[function(){return function(e,t){if(e)return moment(e).format(t)}}]),e.filter("momentadd",[function(){return function(e,t,n){if(e)return moment(e).add(t,parseInt(n,10)).toISOString().replace(".000Z","Z")}}]),e.filter("timesince",[function(){return function(e){if(e)return moment(e).fromNow()}}]),e.filter("themeSlug",["$filter",function(e){return function(t){return!t||angular.isArray(t)&&0===t.length?t:(angular.isArray(t)&&(t=t[0]),e("slugify")(e("normalize")(t)))}}]),e.filter("slugify",function(){return function(e){return e?ODS.StringUtils.slugify(e):e}}),e.filter("normalize",[function(){var e=[{base:"A",letters:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g},{base:"AA",letters:/[\uA732]/g},{base:"AE",letters:/[\u00C6\u01FC\u01E2]/g},{base:"AO",letters:/[\uA734]/g},{base:"AU",letters:/[\uA736]/g},{base:"AV",letters:/[\uA738\uA73A]/g},{base:"AY",letters:/[\uA73C]/g},{base:"B",letters:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g},{base:"C",letters:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g},{base:"D",letters:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g},{base:"DZ",letters:/[\u01F1\u01C4]/g},{base:"Dz",letters:/[\u01F2\u01C5]/g},{base:"E",letters:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g},{base:"F",letters:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g},{base:"G",letters:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g},{base:"H",letters:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g},{base:"I",letters:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g},{base:"J",letters:/[\u004A\u24BF\uFF2A\u0134\u0248]/g},{base:"K",letters:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g},{base:"L",letters:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g},{base:"LJ",letters:/[\u01C7]/g},{base:"Lj",letters:/[\u01C8]/g},{base:"M",letters:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g},{base:"N",letters:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g},{base:"NJ",letters:/[\u01CA]/g},{base:"Nj",letters:/[\u01CB]/g},{base:"O",letters:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g},{base:"OI",letters:/[\u01A2]/g},{base:"OO",letters:/[\uA74E]/g},{base:"OU",letters:/[\u0222]/g},{base:"P",letters:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g},{base:"Q",letters:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g},{base:"R",letters:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g},{base:"S",letters:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g},{base:"T",letters:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g},{base:"TZ",letters:/[\uA728]/g},{base:"U",letters:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g},{base:"V",letters:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g},{base:"VY",letters:/[\uA760]/g},{base:"W",letters:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g},{base:"X",letters:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g},{base:"Y",letters:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g},{base:"Z",letters:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g},{base:"a",letters:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g},{base:"aa",letters:/[\uA733]/g},{base:"ae",letters:/[\u00E6\u01FD\u01E3]/g},{base:"ao",letters:/[\uA735]/g},{base:"au",letters:/[\uA737]/g},{base:"av",letters:/[\uA739\uA73B]/g},{base:"ay",letters:/[\uA73D]/g},{base:"b",letters:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g},{base:"c",letters:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g},{base:"d",letters:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g},{base:"dz",letters:/[\u01F3\u01C6]/g},{base:"e",letters:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g},{base:"f",letters:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g},{base:"g",letters:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g},{base:"h",letters:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g},{base:"hv",letters:/[\u0195]/g},{base:"i",letters:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g},{base:"j",letters:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g},{base:"k",letters:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g},{base:"l",letters:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g},{base:"lj",letters:/[\u01C9]/g},{base:"m",letters:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g},{base:"n",letters:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g},{base:"nj",letters:/[\u01CC]/g},{base:"o",letters:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g},{base:"oi",letters:/[\u01A3]/g},{base:"ou",letters:/[\u0223]/g},{base:"oo",letters:/[\uA74F]/g},{base:"p",letters:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g},{base:"q",letters:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g},{base:"r",letters:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g},{base:"s",letters:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g},{base:"t",letters:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g},{base:"tz",letters:/[\uA729]/g},{base:"u",letters:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g},{base:"v",letters:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g},{base:"vy",letters:/[\uA761]/g},{base:"w",letters:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g},{base:"x",letters:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g},{base:"y",letters:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g},{base:"z",letters:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g}];return function(t){if(!t)return t;for(var n=0;n<e.length;n++)t=t.replace(e[n].letters,e[n].base);return t}}]),e.filter("shortSummary",[function(){return function(e,t){if(t=t||400,!e)return"";var n="",r=angular.element("<div>"+e+"</div>");if(0===r.children().length)n=e.indexOf("\n")>-1?e.substring(0,e.indexOf("\n")):e;else{var a=r.contents()[0];if(3==a.nodeType)n=a.textContent;else if(r.find("p").length>0){var i=r.find("p")[0];n=angular.isDefined(i.textContent)?i.textContent:i.innerText}else n=r.text()}return n.length>t&&(n=n.substring(0,t-3)+""),n}}]),e.filter("imageUrl",function(){return function(e,t){if(!e||angular.equals(e,{}))return null;if(t||console.log("ERROR : This filter requires a context as second parameter."),!t.dataset)return null;angular.isObject(e)||console.log("ERROR : This field is not an file field.");var n=t.domainUrl;return n+="/api/datasets/1.0/"+t.dataset.datasetid+"/files/"+e.id+"/"}}),e.filter("thumbnailUrl",["imageUrlFilter",function(e){return function(t,n){var r=e(t,n);return r?r+"300/":null}}]),e.filter("firstValue",function(){return function(e){return angular.isArray(e)?e.length>0?e[0]:null:e}}),e.filter("split",function(){return function(e,t){return e?(t||(t=";"),e.split(t)):e}}),e.filter("join",function(){return function(e,t){return e?(t||(t=", "),angular.isArray(e)?e.join(t):e):e}}),e.filter("stringify",function(){return function(e){return angular.isObject(e)?JSON.stringify(e):e}}),e.filter("themeColor",function(e){return function(t){return t&&e.themes[t]?e.themes[t].color:""}}),e.filter("isBefore",function(){return function(e,t){return moment(e).isBefore(t)}}),e.filter("isAfter",function(){return function(e,t){return moment(e).isAfter(t)}})}(),function(e){var t={Context:{toggleRefine:function(e,t,n,r){var a="refine."+t;if(angular.isDefined(e.parameters[a])){var i=angular.copy(e.parameters[a]);angular.isArray(i)||(i=[i]),i.indexOf(n)>-1?i.splice(i.indexOf(n),1):(angular.forEach(i,function(e,t){n.startsWith(e+"/")?i.splice(t,1):e.startsWith(n+"/")&&i.splice(t,1)}),angular.isUndefined(r)||!1===r?i.push(n):i=[n]),0===i.length?delete e.parameters[a]:e.parameters[a]=i}else e.parameters[a]=n}},GeoFilter:{getBboxParameterAsBounds:function(e){var t=e.split(",");return[[t[0],t[1]],[t[2],t[3]]]},getBoundsAsBboxParameter:function(e){return angular.isArray(e)?[e[0][0],e[0][1],e[1][0],e[1][1]].join(","):[e.getSouthWest().lat,e.getSouthWest().lng,e.getNorthEast().lat,e.getNorthEast().lng].join(",")},getBoundsAsPolygonParameter:function(e){for(var t,n=[[(t=angular.isArray(e)?new L.LatLngBounds(e):e).getNorthWest().lat,t.getNorthWest().lng],[t.getNorthEast().lat,t.getNorthEast().lng],[t.getSouthEast().lat,t.getSouthEast().lng],[t.getSouthWest().lat,t.getSouthWest().lng]],r=[],a=0;a<n.length;a++){var i=n[a];r.push(i.join(","))}return"("+r.join("),(")+")"},getPolygonParameterAsBounds:function(e){for(var t,n,r,a,i=e.replace(/[()]/g,"").split(","),o=0;o<i.length;o+=2){var s=parseFloat(i[o]),l=parseFloat(i[o+1]);(!t||t>s)&&(t=s),(!n||n>l)&&(n=l),(!r||r<s)&&(r=s),(!a||a<l)&&(a=l)}return[[t,n],[r,a]]},getPolygonParameterAsGeoJSON:function(e){for(var t={type:"Polygon",coordinates:[[]]},n=e.replace(/[()]/g,"").split(","),r=0;r<n.length;r+=2){var a=parseFloat(n[r]),i=parseFloat(n[r+1]);t.coordinates[0].push([i,a])}return t},getBboxParameterAsPolygonParameter:function(e){return this.getBoundsAsPolygonParameter(this.getBboxParameterAsBounds(e))},getGeoJSONPolygonAsPolygonParameter:function(e){var t,n=[];if("LineString"===e.type){t=e.coordinates;var r=null,a=null,i=null,o=null;angular.forEach(t,function(e){var t=e[0],n=e[1];r=null===r?t:Math.min(r,t),a=null===a?n:Math.min(a,n),i=null===i?t:Math.max(i,t),o=null===o?n:Math.max(o,n)}),n.push(a+","+r),n.push(a+","+i),n.push(o+","+i),n.push(o+","+r)}else{t=e.coordinates[0],"MultiPolygon"===e.type&&(t=t[0]);for(var s=0;s<t.length;s++){var l=angular.copy(t[s]);l.length>2&&l.splice(2,1),l.reverse(),n.push(l.join(","))}}return"("+n.join("),(")+")"},addGeoFilterFromSpatialObject:function(e,t){angular.isArray(t)?e["geofilter.distance"]=t[0]+","+t[1]:"Point"===t.type?e["geofilter.distance"]=t.coordinates[1]+","+t.coordinates[0]:e["geofilter.polygon"]=this.getGeoJSONPolygonAsPolygonParameter(t)}},StringUtils:{slugify:function(e){return e?e.toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/-+/g,"-"):e},capitalize:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},startsWith:function(e,t){return e&&0===e.indexOf(t)}},URLUtils:{cleanupAPIParams:function(e){function t(t,n,r){n.startsWith(t+".")&&(e[t]?angular.isArray(e[t])?e[t].push(r):e[t]=[e[t],r]:e[t]=r,delete e[n])}var e=angular.copy(e);return angular.forEach(e,function(e,n){angular.forEach(["q","rq"],function(r){t(r,n,e)})}),e},getAPIQueryString:function(e){var t=[];return e=this.cleanupAPIParams(e),angular.forEach(e,function(e,n){angular.isString(e)?t.push(n+"="+encodeURIComponent(e)):angular.forEach(e,function(e){t.push(n+"="+encodeURIComponent(e))})}),t.join("&")}},DatasetUtils:{isFieldSortable:function(e){if(["int","double","date","datetime"].indexOf(e.type)>=0)return!0;if("text"===e.type&&e.annotations)for(var t=0;t<e.annotations.length;t++)if("sortable"===e.annotations[t].name)return!0;return!1}},Dataset:function(e){var t,n,r,a=function(e,t){if(e.annotations)for(var n=0;n<e.annotations.length;n++)if(e.annotations[n].name===t)return!0;return!1},i=function(e){r={facets:[]},t=[],n=0;for(var i=0;i<e.length;i++){var o=e[i];a(o,"facet")&&(n++,r.facets.push(o)),t[o.type]?t[o.type]+=1:t[o.type]=1}};return{datasetid:e.datasetid||"preview",has_records:e.has_records,metas:e.metas||{domain:"preview"},features:e.features,attachments:e.attachments,fields:e.fields,extra_metas:e.extra_metas,interop_metas:e.interop_metas,setFields:function(e){this.fields=e,i(this.fields)},getUniqueId:function(){return this.metas.domain+"."+this.datasetid},getTypes:function(){return void 0===t&&i(this.fields),t},hasFeature:function(t){return e.features.indexOf(t)>-1},hasFieldType:function(e){for(var t=0;t<this.fields.length;t++)if(this.fields[t].type==e)return!0;return!1},countFieldType:function(e){for(var t=0,n=0;n<this.fields.length;n++)this.fields[n].type==e&&t++;return t},countFieldTypes:function(e){for(var t=0,n=0;n<e.length;n++)t+=this.countFieldType(e[n]);return t},getFacetsCount:function(){return void 0===n&&i(this.fields),n},hasFacet:function(){return void 0===n&&i(this.fields),n>0},getFilterDescription:function(){return void 0===r&&i(this.fields),r},getFacets:function(){return this.getFilterDescription().facets},setMetas:function(e){this.metas=e},getField:function(e){for(var t=0;t<this.fields.length;t++){var n=this.fields[t];if(n.name===e)return n}return null},getFieldLabel:function(e){var t=this.getField(e);return t?t.label:t},getFieldsForType:function(e){for(var t=[],n=0;n<this.fields.length;n++){var r=this.fields[n];r.type===e&&t.push(r)}return t},hasNumericField:function(){for(var e=0;e<this.fields.length;e++){var t=this.fields[e];if("int"===t.type||"double"===t.type)return!0}return!1},hasGeoField:function(){for(var e=0;e<this.fields.length;e++){var t=this.fields[e];if("geo_point_2d"===t.type||"geo_shape"===t.type)return!0}return!1},getExtraMeta:function(e,t){return this.extra_metas&&this.extra_metas[e]&&this.extra_metas[e][t]?this.extra_metas[e][t]:null},isFieldAnnotated:function(e,t){return a(e,t)}}}};void 0===e.ODS&&(e.ODS={}),e.ODS=angular.extend(e.ODS,t)}(window),function(){"use strict";angular.module("ods-widgets").directive("odsAggregation",["ODSAPI",function(e){return{restrict:"A",scope:!0,controller:["$scope","$attrs",function(t,n){var r=t.$eval(n.odsAggregationContext),a=n.odsAggregationFunction||"COUNT",i=n.odsAggregationExpression,o=n.odsAggregation||"aggregation";r.wait().then(function(){t.$watch(r.name+".parameters",function(n,s){var l=angular.extend({},n,{"y.serie1.expr":i,"y.serie1.func":a});e.records.analyze(r,l).success(function(e){t[o]=e[0].serie1})},!0)})}]}}])}(),function(){"use strict";var e=function(e,t,n){try{return!!e.$eval(t,{y:n})}catch(e){console.warn("Error while compiling condition with expr",t)}return!1},t=angular.module("ods-widgets");t.directive("odsAnalysis",["ODSAPI",function(e){var t=function(e,t){var n,r=/([A-Z_-]*?)\((.*?)\)/g,a=/([A-Z_-]*?)\(([a-zA-Z0-9\._]+),\s?([0-9\.]+)\)/g,i=t||e;e.compiled_expr=""+e.expr,i.aggregates=[];for(var o={};n=r.exec(e.expr);){var s=a.exec(n[0]);if(s&&4===s.length&&(n=s),n&&(3===n.length||4===n.length))if(0===n[2].indexOf("serie")){var l="operators."+n[1].toLowerCase()+".apply(null, accumulation['"+n[2]+"']";4===n.length&&(l+=", "+n[3]),l+=")",e.compiled_expr=e.compiled_expr.replace(n[0],l),i.aggregates.push(n[2])}else o.func=n[1],o.expr=n[2],n[3]&&(o.subsets=n[3]),e.compiled_expr+=e.compiled_expr.replace(n[0],"y")}return o};return{restrict:"A",priority:1001,controller:["$scope","$attrs",function(n,r){n[r.odsAnalysisContext].wait().then(function(){n.$watch(r.odsAnalysisContext,function(a){var i=r.odsAnalysis||"results",o=angular.extend({},a.parameters,{maxpoints:r.odsAnalysisMax||0}),s={},l={},u=[];r.odsAnalysisSort&&(o.sort=r.odsAnalysisSort),angular.forEach(r,function(e,n){var r,a;if(n.startsWith("odsAnalysisSerie"))if(r=n.replace("odsAnalysisSerie",""),a=!1,r.endsWith("Cumulative")&&r.replace("Cumulative","").length>0&&(r=r.replace("Cumulative",""),a=e),r=r.toLowerCase(),l[r]||(l[r]={}),a)l[r].cumulative=a;else{var i={expr:e};angular.extend(l[r],t(i))}else n.startsWith("odsAnalysisAggregation")?(r=(r=n.replace("odsAnalysisAggregation","")).toLowerCase(),s[r]||(s[r]={}),s[r].expr=r,s[r].func=e):n.startsWith("odsAnalysisX")&&u.push(e)}),u.length>0&&(o.x=u),angular.forEach(l,function(e,t){o["y."+t+".expr"]=e.expr,o["y."+t+".func"]=e.func,o["y."+t+".cumulative"]=e.cumulative||"false","QUANTILES"===e.func&&(o["y."+t+".subsets"]=e.subsets||"50"),s[t]&&(o["agg."+t+".expr"]=s[t].expr,o["agg."+t+".func"]=s[t].func)}),e.records.analyze(a,o).success(function(e){n[i]={},angular.isArray(e)?n[i]={results:e}:n[i]=e})},!0)})}]}}]),t.directive("odsAnalysisSerie",[function(){return{restrict:"A",scope:!0,controller:["$scope","$attrs",function(e,t){e.condition="",e.field="",e.$watch(t.odsAnalysisSerieCondition,function(n){t.odsAnalysisSerieCondition&&(e.condition=t.odsAnalysisSerieCondition)},!0),e.$watch(t.odsAnalysisSerieName,function(n){t.odsAnalysisSerieName&&(e.name=t.odsAnalysisSerieName)},!0),e.$watch(t.odsAnalysisSerieSeparateOnX,function(n){t.odsAnalysisSerieSeparateOnX&&(e.separateOnX=t.odsAnalysisSerieSeparateOnX)},!0),e.$watch(t.odsAnalysisSerieMode,function(n){t.odsAnalysisSerieMode&&(e.mode=t.odsAnalysisSerieMode)},!0)}],link:function(t,n,r){t.$watch(r.odsAnalysisSerie,function(n,r){var a,i,o,s,l=n,u={};if(t.separateOnX&&(u={}),t.results={},l){for(i={},a=0;a<l.length;a++)o=l[a][t.name],s=t.separateOnX?l[a].x[t.separateOnX]:"global",e(t,t.condition,o)?(u[s]||(u[s]=[]),u[s].push(l[a])):u[s]&&((!i[s]||i[s].length<u[s].length)&&(i[s]=u[s]),u[s]=!1);if(angular.forEach(u,function(e,t){(!i[t]||i[t].length<e.length)&&(i[t]=e)}),"reduce"==t.mode&&t.separateOnX){var c=Object.keys(i),d=[];for(a=0;a<c.length;a++)i[c[a]].length>d.length&&(d=i[c[a]]);angular.copy({global:d},t.results)}else angular.copy(i,t.results)}})}}}]),t.directive("odsSubaggregation",["ModuleLazyLoader",function(e){var t=function(e,t){var n,r=/([A-Z_-]*?)\((.*?)\)/g,a=/([A-Z_-]*?)\(([a-zA-Z0-9\._]+),\s?(.+)\)/g,i=t||e;e.compiled_expr=""+e.expr,i.aggregates=[];for(var o={};n=r.exec(e.expr);){var s=a.exec(n[0]);if(s&&4===s.length&&(n=s),n&&(3===n.length||4===n.length)){o.func=n[1],o.expr=n[2],n[3]&&(o.param=n[3]);var l="operators."+n[1].toLowerCase()+"(accumulation['"+n[2]+"']";4===n.length&&(l+=", "+n[3]),l+=")",o.compiled_expr=e.compiled_expr.replace(n[0],l),o.needed_aggregates=n[2]}}return o},n=function(e,t,n,r){var a;try{a=e.$eval(t,{operators:ss,accumulation:function(e,t){var n={};return angular.forEach(t,function(t){n[t]=e[t]}),n}(n,r),console:console})}catch(e){console.warn("Error while compiling aggregation value with expr",t)}return a};return{restrict:"A",scope:!0,controller:["$scope","$attrs",function(e,n){e.aggregations={};var r=e.$watch(n.odsSubaggregation,function(a){if(a){var i={};angular.forEach(n,function(e,n){var r;if(n.startsWith("odsSubaggregationSerie")){r=(r=n.replace("odsSubaggregationSerie","")).toLowerCase(),i[r]||(i[r]={});var a={expr:e};angular.extend(i[r],t(a))}}),angular.copy(i,e.aggregations),r()}},!0)}],link:function(t,r,a){e("simple-statistics").then(function(){t.$watch(a.odsSubaggregation,function(e,r){var a,i,o={},s=e;if(t.results=[],s){for(i={},angular.forEach(t.aggregations,function(e,t){o[e.needed_aggregates]=[]}),a=0;a<s.length;a++)angular.forEach(o,function(e,t){void 0!==s[a][t]&&o[t].push(s[a][t])});angular.forEach(t.aggregations,function(e,r){i[r]=n(t,e.compiled_expr,o,[e.needed_aggregates])}),t.results.push(i)}},!0)})}}}])}(),function(){"use strict";var e=angular.module("ods-widgets");e.directive("odsCalendar",["ODSAPI","ModuleLazyLoader","ODSWidgetsConfig","$compile",function(e,t,n,r){return{restrict:"E",scope:{context:"=",startField:"@?",endField:"@?",titleField:"@?",tooltipFields:"@?",eventColor:"@?"},replace:!0,template:'<div class="odswidget-calendar">    <div class="odswidget-calendar__fullcalendar"></div>    <div class="odswidget-calendar__tooltip"></div>    <div class="odswidget-calendar__loading-backdrop">        <ods-spinner class="odswidget-calendar__loading-wheel"></ods-spinner>    </div></div>',link:function(a,i){var o=function(){var e={};if(a.context.dataset&&a.context.dataset.extra_metas&&a.context.dataset.extra_metas.visualization&&(e=a.context.dataset.extra_metas.visualization),angular.isDefined(a.startField)||(a.startField=e.calendar_event_start),angular.isDefined(a.endField)||(a.endField=e.calendar_event_end),angular.isDefined(a.titleField)||(a.titleField=e.calendar_event_title),angular.isDefined(a.eventColor)||(e.calendar_event_color?a.eventColor=e.calendar_event_color:a.eventColor="#C32D1C"),angular.isDefined(a.tooltipFields)){var t=[];angular.forEach(a.tooltipFields.split(","),function(e){t.push(e.trim())}),a.tooltipFields=t}else e.calendar_tooltip_fields?a.tooltipFields=e.calendar_tooltip_fields:a.tooltipFields=[];a.tooltip=$(i).children(".odswidget-calendar__tooltip").first().qtip({id:"odswidget-calendar",content:{text:"",button:!0},position:{my:"bottom center",at:"top center",target:"mouse",viewport:$(".odswidget-calendar__fullcalendar"),adjust:{mouse:!1,scroll:!1}},show:!1,hide:!1}).qtip("api"),$(document).on("click",function(e){$(e.target).parents(".fc-event").length||$(e.target).parents("#qtip-odswidget-calendar").length||s()}),a.fullcalendar=$(i).children(".odswidget-calendar__fullcalendar").first(),a.fullcalendar.fullCalendar({lazyFetching:!1,header:{left:"prevYear,prev,next,nextYear, today",center:"title",right:"month,agendaWeek,agendaDay"},lang:n.language,loading:u,editable:!0,eventLimit:!0,events:c,eventDataTransform:d,eventColor:a.eventColor,eventClick:function(e,t){s(),a.tooltip.set({"content.text":e.buildTooltipContent(),"position.target":[t.pageX,t.pageY]}).reposition(t).show(t)}})},s=function(){$("#qtip-odswidget-calendar").hide()},l=function(){a.fullcalendar.fullCalendar("refetchEvents")},u=function(e){e?$(".odswidget-calendar__loading-backdrop").show():$(".odswidget-calendar__loading-backdrop").hide()},c=function(t,n,r,i){e.records.search(a.context,p(t,n)).success(function(e){i(e.records)})},d=function(e){return{title:e.fields[a.titleField],start:e.fields[a.startField],end:e.fields[a.endField],buildTooltipContent:f(e),editable:!1}},f=function(e){return function(){var t=a.$new(!0);t.record=e,t.titleField=a.titleField,t.tooltipFields=a.tooltipFields,t.dataset=a.context.dataset;var n=r("<ods-calendar-tooltip></ods-calendar-tooltip")(t);return t.$apply(),n}},p=function(e,t){var n={dataset:a.context.dataset.datasetid,rows:1e4};n=$.extend(n,a.context.parameters);var r=[a.startField+"<"+t.format("YYYY-MM-DD"),a.endField+">"+e.format("YYYY-MM-DD")].join(" AND ");return n=$.extend(n,{"q.calendar_bounds":r})};t("fullcalendar","qtip").then(function(){a.context.wait().then(function(){o(),a.$watch("context.parameters",function(e,t){e!==t&&l()},!0)})})}}}]),e.directive("odsCalendarTooltip",function(){return{restrict:"E",template:'<h2 class="odswidget-calendar__tooltip-title">{{ record.fields[titleField] }}</h2><dl class="odswidget-calendar__tooltip-fields">    <dt ng-repeat-start="field in dataset.fields|fieldsForVisualization:\'calendar\'|fieldsFilter:tooltipFields"        ng-show="record.fields[field.name]|isDefined"        class="odswidget-calendar__tooltip-field-name">        {{ field.label }}    </dt>    <dd ng-repeat-end ng-switch="field.type" ng-show="record.fields[field.name]|isDefined">        <debug data="record.fields[field.name]"></debug>        <span ng-switch-when="geo_point_2d">            <ods-geotooltip width="300" height="300" coords="record.fields[field.name]">                {{ record.fields|formatFieldValue:field }}            </ods-geotooltip>        </span>        <span ng-switch-when="geo_shape">            <ods-geotooltip width="300" height="300" geojson="record.fields[field.name]">                {{ record.fields|formatFieldValue:field }}            </ods-geotooltip>        </span>        <span ng-switch-when="file">            <div ng-if="!dataset.isFieldAnnotated(field, \'has_thumbnails\')"                 ng-bind-html="record.fields|formatFieldValue:field"></div>            <div ng-if="dataset.isFieldAnnotated(field, \'has_thumbnails\')"                 ng-bind-html="record.fields[field.name]|displayImageValue:dataset.datasetid"                 style="text-align: center;"></div>        </span>        <span ng-switch-default               title="{{record.fields|formatFieldValue:field}}"               ng-bind-html="record.fields|formatFieldValue:field|imagify|videoify|prettyText|nofollow">        </span>    </dd></dl>'}})}(),function(){"use strict";angular.module("ods-widgets").directive("odsCatalogContext",["ODSAPI","URLSynchronizer",function(e,t){return{restrict:"AE",scope:!0,replace:!0,link:function(n,r,a){for(var i=a.context.split(","),o=0;o<i.length;o++){var s=i[o].trim(),l=a[s+"Domain"],u=n.$eval(a[s+"Parameters"])||{};a[s+"Source"]&&(u.source=a[s+"Source"]),n[s]={name:s,type:"catalog",domain:l,domainUrl:e.getDomainURL(l),apikey:a[s+"Apikey"],parameters:u,toggleRefine:function(e,t,n){ODS.Context.toggleRefine(this,e,t,n)}},n.$eval(a[s+"Urlsync"])&&(angular.equals(u,{})||console.log("WARNING : Context "+s+" : There are specific parameters defined, but URL sync is enabled, so the parameters will be ignored."),t.addSynchronizedObject(n,s+".parameters"))}}}}])}(),function(){"use strict";var e=angular.module("ods-widgets"),t=function(e,t,n){var r=n.find(".dataset-item").first(),a=n.find(".card-container"),i=$(a).outerHeight();"bottom"==t.position?($(r).css("top",0),$(r).css("bottom",i)):($(r).css("top",i),$(r).css("bottom",0)),e(function(e){$(r).html(e)}),t.$apply()};e.directive("odsDatasetCard",function(){return{restrict:"E",scope:{context:"="},template:'<div class="odswidget odswidget-dataset-card"><div class="card-container" ng-class="{bottom: position == \'bottom\', expanded: expanded, expandable: isExpandable()}"><h2 class="dataset-title" ng-click="expanded = !expanded" ng-show="!expanded || (expanded && !context.dataset.metas.description)">{{context.dataset.metas.title}}</h2><div ng-click="expanded = !expanded" class="expand-control"><span translate>Details</span> <i class="fa fa-chevron-down" ng-show="!expanded"></i><i class="fa fa-chevron-up" ng-hide="!expanded"></i></div><div class="dataset-expanded" ng-click="expanded = !expanded""><h2 class="dataset-title" ng-show="expanded">{{context.dataset.metas.title}}</h2><p class="dataset-description" ng-if="expanded" ng-bind-html="safeHtml(context.dataset.metas.description)"></p></div><div class="dataset-infos"><span class="dataset-infos-text"><a ng-href="{{datasetUrl}}" target="_blank" ng-bind-html="websiteName"></a><span ng-show="context.dataset.metas.license"> - <span translate>License</span> {{context.dataset.metas.license}}</span></span></div></div><div class="dataset-item"></div></div>',replace:!0,transclude:!0,link:function(e,n,r){e.position=r.position||"top",e.renderContent=t},controller:["$scope","$element","ODSWidgetsConfig","$transclude","$sce",function(e,t,n,r,a){e.websiteName=n.websiteName,e.expanded=!1,e.safeHtml=function(e){return a.trustAsHtml(e)},e.isExpandable=function(){return!!(e.context&&e.context.dataset&&e.context.dataset.datasetid)&&!!e.context.dataset.metas.description};var i=e.$watch("context",function(n,a){n&&n.dataset&&(setTimeout(function(){e.renderContent(r,e,t)},0),e.expanded=!1,e.datasetUrl=e.context.domainUrl+"/explore/dataset/"+e.context.dataset.datasetid+"/",e.websiteName||(e.websiteName=e.context.domainUrl),i())},!0)}]}}),e.directive("odsMultidatasetsCard",["ODSWidgetsConfig",function(e){return{restrict:"E",scope:{title:"=",datasets:"=",context:"="},template:'<div class="odswidget-multidatasets-card">  <div class="card-container multidatasets" ng-class="{bottom: (position == \'bottom\'), expanded: expanded, expandable: isExpandable()}">      <h2 ng-show="!expanded" ng-click="tryToggleExpand()">{{ title }}</h2>      <div ng-click="tryToggleExpand()" class="expand-control" ng-class="{expanded: expanded}"><span translate>Details</span> <i class="icon-chevron-down"></i></div>      <h3 class="datasets-counter" ng-click="tryToggleExpand()" ng-show="!expanded">          <span class="count-text" ng-hide="!datasetObjectKeys || datasetObjectKeys.length <= 1">               <span ng-pluralize count="datasetObjectKeys.length" translate="when" when="{\'0\': \'no datasets to display\', \'1\': \'{} dataset\', \'other\': \'{} datasets\'}"></span>          </span>      </h3>      <div class="datasets-expanded">          <h2 ng-show="expanded" ng-click="tryToggleExpand()">{{ title }}</h2>          <h3 class="datasets-counter" ng-click="tryToggleExpand()" ng-show="expanded">              <span class="count-text">                   <span ng-pluralize count="datasetObjectKeys.length" translate="when" when="{\'0\': \'no datasets to display\', \'1\': \'{} dataset\', \'other\': \'{} datasets\'}"></span>              </span>          </h3>          <ul class="dataset-list"              ng-show="(datasetObjectKeys && datasetObjectKeys.length === 1) || (isExpandable() && expanded)"              ng-class="{\'single-dataset\': datasetObjectKeys.length === 1}">              <li ng-repeat="(key, dataset) in datasets"> <a                  ng-href="{{context.domainUrl}}/explore/dataset/{{dataset.datasetid}}/"                  target="_blank">{{ dataset.metas.title }}</a>                  <span ng-show="dataset.metas.license">- <span translate>License</span> {{ dataset.metas.license }}</span></li>          </ul>      </div>      <div class="dataset-infos"><span class="dataset-infos-text"><a ng-href="/" target="_blank" ng-bind-html="websiteName"></a></span></div>  </div>  \x3c!-- embedded content (chart, map etc.) --\x3e  <div class="dataset-item" ng-transclude></div></div>',replace:!0,transclude:!0,link:function(e,n,r){e.position=r.position||"top",e.renderContent=t},controller:["$scope","$element","ODSWidgetsConfig","$transclude","$sce",function(e,t,n,r,a){e.datasetObjectKeys=[],e.websiteName=n.websiteName,e.safeHtml=function(e){return a.trustAsHtml(e)},e.isExpandable=function(){return!(!e.datasetObjectKeys.length||1===e.datasetObjectKeys.length)},e.tryToggleExpand=function(){e.isExpandable()&&(e.expanded=!e.expanded)};var i=e.$watch("datasets",function(n,a){var o=Object.keys(n);0!==o.length&&(e.datasetObjectKeys=o,setTimeout(function(){e.renderContent(r,e,t)},0),e.expanded=!1,i())},!0)}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsDatasetContext",["ODSAPI","$q","$interpolate","URLSynchronizer",function(e,t,n,r){var a=function(n,a,i,o,s,l,u,c,d,f){var p;if(angular.equals(l,{}))if(u){var h=i.$watch(u,function(e,t){e&&(c&&(e.parameters.source=c),i[o].parameters=e.parameters,h())});p=null}else p=angular.equals(l,{})?l:{};else p=l,d&&console.log("WARNING : Context "+o+" : There are specific parameters defined, but URL sync is enabled, so the parameters will be ignored.");c&&p&&(p.source=c);var g=t.defer();i[o]={wait:function(){return g.promise},getDownloadURL:function(e,t){t=t||{},e=e||"csv";var n=this.domainUrl+"/explore/dataset/"+this.dataset.datasetid+"/download/?format="+e;return n+="&"+ODS.URLUtils.getAPIQueryString(angular.extend({},this.parameters,t))},toggleRefine:function(e,t,n){ODS.Context.toggleRefine(this,e,t,n)},name:o,type:"dataset",domain:n,domainUrl:e.getDomainURL(n),apikey:s,dataset:null,parameters:p},d&&r.addSynchronizedObject(i,o+".parameters",["basemap","location"]),f?(i[o].dataset=new ODS.Dataset(f),g.resolve(i[o].dataset)):e.datasets.get(i[o],a,{extrametas:!0,interopmetas:!0,source:p.source}).success(function(e){i[o].dataset=new ODS.Dataset(e),g.resolve(i[o].dataset)}).error(function(e){g.reject("Failed to fetch "+o+" context.")})};return{restrict:"AE",scope:!0,replace:!0,controller:["$scope","$attrs",function(e,t){for(var r=t.context.split(","),i=0;i<r.length;i++){var o=r[i].trim();t[o+"Dataset"]||t[o+"DatasetSchema"]||console.log("ERROR : Context "+o+" : Missing dataset parameter");var s,l,u,c,d,f;t[o+"Dataset"]&&(s=n(t[o+"Dataset"])(e)),t[o+"Domain"]&&(l=n(t[o+"Domain"])(e)),t[o+"Apikey"]&&(u=n(t[o+"Apikey"])(e)),t[o+"Sort"]&&(c=n(t[o+"Sort"])(e)),t[o+"Source"]&&(d=n(t[o+"Source"])(e)),t[o+"DatasetSchema"]&&(f=angular.fromJson(n(t[o+"DatasetSchema"])(e)));var p=e.$eval(t[o+"Parameters"])||{},h=t[o+"ParametersFromContext"];c&&(p.sort=c);var g=e.$eval(t[o+"Urlsync"]);a(l,s,e,o,u,p,h,d,g,f)}}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsDisqus",["ODSWidgetsConfig","$location","$window",function(e,t,n){return{restrict:"E",replace:!0,scope:{shortname:"@",identifier:"@"},template:'<div id="disqus_thread" class="odswidget"></div>',link:function(r){n.disqus_shortname=r.shortname||e.disqusShortname,r.identifier&&(n.disqus_identifier=r.identifier),n.disqus_url=t.absUrl(),n.disqus_config=function(){this.language=e.language};var a=document.createElement("script");a.type="text/javascript",a.async=!0,a.src="//"+n.disqus_shortname+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsDomainStatistics",["ODSAPI",function(e){return{restrict:"AE",scope:!0,controller:["$scope","$attrs",function(t,n){var r=function(e,t,n){return n.name===t&&(e.stats[t]=n.facets.length,!0)},a=t.$watch(n.context,function(t){t.stats={dataset:0,keyword:0,publisher:0,theme:0},e.datasets.search(t,{facet:["keyword","publisher","theme"]}).success(function(e){if(t.stats.dataset=e.nhits,e.facet_groups)for(var n=0;n<e.facet_groups.length;n++)r(t,"keyword",e.facet_groups[n])||r(t,"publisher",e.facet_groups[n])||r(t,"theme",e.facet_groups[n])}),a()},!0)}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsFacetResults",["ODSAPI",function(e){return{restrict:"A",scope:!0,priority:1001,controller:["$scope","$attrs",function(t,n){t.$watch(n.odsFacetResultsContext,function(r){var a,i=n.odsFacetResultsFacetName,o=angular.extend({},r.parameters,{rows:0,facet:i}),s=n.odsFacetResults||"results";if("dataset"===r.type&&r.dataset)a=e.records.search(r,o);else{if("catalog"!==r.type)return;a=e.datasets.search(r,o)}a.success(function(e){if(e.facet_groups){var n=e.facet_groups.filter(function(e){return e.name===i});0===n.length&&(t[s]=[]),t[s]=n[0].facets}else t[s]=[]})},!0)}]}}])}(),function(){"use strict";var e=angular.module("ods-widgets");e.directive("odsFacets",["$compile","translate",function(e,t){var n=function(t,n,r){var a="";angular.forEach(r,function(e){a+='<ods-facet name="'+e.name+'" title="'+(e.title&&e.title.replace(/"/g,"&quot;")||e.name)+'" sort="'+(e.sort||"")+'" disjunctive="'+(e.disjunctive||"")+'" hide-if-single-category="'+(e.hideIfSingleCategory?"true":"false")+'" hide-category-if="'+(e.hideCategoryIf||"")+'"value-formatter="'+(e.valueFormatter||"")+'">'+(e.template||"")+"</ods-facet>"});var i=angular.element(a);n.append(i),e(i)(t)};return{restrict:"E",replace:!0,scope:{context:"=",facetsConfig:"="},compile:function(e){var r=e.children().length;return function(e,a){if(e.facetsConfig)n(e,a,e.facetsConfig),e.init();else if(0===r)var i,o=e.$watch("context",function(){e.context&&(o(),"catalog"===e.context.type?(i=[{name:"modified",title:t("Modified")},{name:"publisher",title:t("Publisher")},{name:"keyword",title:t("Keyword")},{name:"theme",title:t("Theme")}],n(e,a,i),e.init()):e.context.wait().then(function(){i=angular.copy(e.context.dataset.getFacets()),angular.forEach(i,function(e){e.title=e.label,delete e.label,angular.forEach(e.annotations,function(t){"facetsort"===t.name&&t.args.length>0&&(e.sort=t.args[0]),"disjunctive"===t.name&&(e.disjunctive=!0)})}),n(e,a,i),e.init()}))},!0);else e.init()}},controller:["$scope","ODSAPI",function(e,t){e.facets=[],e.init=function(){e.$watch(function(){var t=angular.copy(e.context.parameters);return t.sort&&delete t.sort,t.start&&delete t.start,t.tab&&delete t.tab,t.dataChart&&delete t.dataChart,"dataset"===e.context.type?[t,e.context.dataset]:t},function(){("catalog"===e.context.type||e.context.dataset)&&(angular.isDefined(e.context.parameters.start)&&delete e.context.parameters.start,e.refreshData())},!0)},e.refreshData=function(){var n=angular.extend({},e.context.parameters,{rows:0,facet:e.facets.map(function(e){return e.name})});e.facets.map(function(e){e.sort&&e.sort.length&&"["!==e.sort[0]&&(n["facetsort."+e.name]=e.sort)});("dataset"===e.context.type?t.records.search(e.context,n):t.datasets.search(e.context,n)).success(function(t){e.context.nhits=t.nhits;var n,r,a;angular.forEach(e.facets,function(e){e.categories.splice(0,e.categories.length)}),t.facet_groups&&angular.forEach(t.facet_groups,function(t){if((r=e.facets.filter(function(e){return e.name===t.name})).length>0){if(n=r[0].categories,a=[],r[0].sort&&r[0].sort.length&&"["===r[0].sort[0]){var i=e.$eval(r[0].sort);angular.forEach(i,function(e){var n,r;for(n=0;n<t.facets.length;n++)if((r=t.facets[n]).path===e){a.push(r),t.facets.splice(n,1);break}}),Array.prototype.push.apply(a,t.facets)}else a=t.facets;Array.prototype.push.apply(n,a)}})})},this.registerFacet=function(t,n){var r=[];return e.facets.push({name:t,categories:r,sort:n}),r},this.setDisjunctive=function(t){e.context.parameters["disjunctive."+t]=!0},this.toggleRefinement=function(t,n){e.context.toggleRefine(t,n)}}]}}]),e.directive("odsFacet",function(){return{restrict:"E",replace:!0,scope:{name:"@",title:"@",visibleItems:"@",hideIfSingleCategory:"@",hideCategoryIf:"@",sort:"@",disjunctive:"@",valueSearch:"@",valueFormatter:"@"},template:function(e){return e.data("facet-template",e.html()),"<div ng-class=\"{'odswidget': true, 'odswidget-facet': true, 'odswidget-facet--disjunctive': isDisjunctive()}\">"+'<h3 class="odswidget-facet__facet-title" ng-if="title && categories.length && visible()">{{title}}</h3><ods-facet-category-list ng-if="visible()" facet-name="{{ name }}" value-search="{{ valueSearch }}" hide-category-if="{{ hideCategoryIf }}" categories="categories" template="{{ customTemplate }}" value-formatter="{{valueFormatter}}"></ods-facet-category-list></div>'},require:"^odsFacets",link:function(e,t,n,r){angular.isUndefined(r)&&console.log("ERROR : odsFacet must be used within an odsFacets tag."),e.categories=r.registerFacet(e.name,e.sort),e.facetsCtrl=r,e.isDisjunctive()&&r.setDisjunctive(e.name)},controller:["$scope","$element",function(e,t){e.isDisjunctive=function(){return angular.isString(e.disjunctive)&&"true"===e.disjunctive.toLowerCase()},e.visibleItemsNumber=e.visibleItems||6,this.toggleRefinement=function(t){e.facetsCtrl.toggleRefinement(e.name,t)},this.getVisibleItemsNumber=function(){return e.visibleItemsNumber},e.visible=function(){return!(angular.isString(e.hideIfSingleCategory)&&"true"===e.hideIfSingleCategory.toLowerCase()&&1===e.categories.length&&"refined"!==e.categories[0].state)},e.customTemplate=t.data("facet-template")}]}}),e.directive("odsFacetCategoryList",function(){return{restrict:"E",replace:!0,scope:{categories:"=",template:"@",facetName:"@",hideCategoryIf:"@",valueSearch:"@",valueFormatter:"@"},require:"^odsFacet",template:'<ul class="odswidget-facet__category-list">   <li class="odswidget-facet__value-search" ng-show="valueSearchEnabled">       <input class="odswidget-facet__value-search-input" ng-model="valueFilter">       <i ng-show="!!valueFilter" class="odswidget-facet__value-search-cancel icon-remove" ng-click="valueFilter=\'\'"></i>   </li>   <li ng-repeat="category in categories|filter:searchValue(valueFilter)" class="odswidget-facet__category-container">       <ods-facet-category ng-if="!categoryIsHidden(category)" facet-name="{{ facetName }}" category="category" template="{{template}}" value-formatter="{{valueFormatter}}" ng-show="visible($index)"></ods-facet-category>   </li>   <li ng-if="!suggestMode && visibleItems < (categories|filter:searchValue(valueFilter)).length" class="odswidget-facet__expansion-control">       <a ng-hide="expanded" href="#" ng-click="toggle($event)" translate>More</a>       <a ng-show="expanded" href="#" ng-click="toggle($event)" translate>Less</a>   </li></ul>',link:function(e,t,n,r){e.expanded=!1,e.visibleItems=r.getVisibleItemsNumber(),e.visible=function(t){return e.expanded||t<e.visibleItems},e.toggle=function(t){t.preventDefault(),e.expanded=!e.expanded},e.categoryIsHidden=function(t){if(e.suggestMode&&""===e.valueFilter)return!0;if(!e.hideCategoryIf)return!1;var n=e.$new(!1);return n.category=t,n.$eval(e.hideCategoryIf)}},controller:["$scope","$filter",function(e,t){e.valueFilter="",e.valueSearchEnabled=!1,e.suggestMode=!1,angular.isString(e.valueSearch)&&("true"===e.valueSearch.toLowerCase()?e.valueSearchEnabled=!0:"suggest"===e.valueSearch.toLowerCase()&&(e.valueSearchEnabled=!0,e.suggestMode=!0)),e.searchValue=function(e){return e?(e=t("normalize")(e).toLowerCase(),function(n){return t("normalize")(n.name).toLowerCase().indexOf(e)>-1}):function(){return!0}},this.emptySearch=function(){e.valueFilter=""}}]}}),e.directive("odsFacetCategory",["$compile",function(e){return{restrict:"E",replace:!0,require:["^odsFacet","^?odsFacetCategoryList"],scope:{category:"=",facetName:"@",template:"@",valueFormatter:"@"},template:'<div class="odswidget odswidget-facet-category">   <a class="odswidget-facet__category" href="#" ng-click="toggleRefinement($event, category.path)" ng-class="{\'odswidget-facet__category--refined\': category.state === \'refined\'}" title="{{ category.name }}">   </a></div>',link:function(t,n,r,a){var i=a[0],o=a[1];t.toggleRefinement=function(e,t){e.preventDefault(),i.toggleRefinement(t),o.emptySearch()};var s=t.template||'<span class="odswidget-facet__category-name" ng-bind-html="formatCategory(category.name)"></span> <span class="odswidget-facet__category-count">{{ category.count|number }}</span>';if(n.find("a").append(e("<div>"+s+"</div>")(t).children()),t.category.facets){var l=angular.element('<ods-facet-category-list categories="category.facets" template="{{template}}"></ods-facet-category-list>');n.find("a").after(l),e(l)(t)}},controller:["$scope","ValueDisplay",function(e,t){e.formatCategory=function(n){return e.valueFormatter?t.format(n,e.valueFormatter):n}}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsFilterSummary",function(){return{restrict:"E",replace:!0,template:'<ul class="odswidget odswidget-filter-summary">    <li class="odswidget-filter-summary__active-filter" ng-show="isParameterActive(\'q\')">        <a class="odswidget-filter-summary__active-filter-link" ng-click="removeParameter(\'q\')">            <span class="odswidget-filter-summary__active-filter-label" translate>Text</span> {{context.parameters.q}}        </a>    </li>    <li class="odswidget-filter-summary__active-filter" ng-show="isParameterActive(\'geofilter.polygon\') || isParameterActive(\'geofilter.distance\')">        <a class="odswidget-filter-summary__active-filter-link" ng-click="removeParameter(\'geofilter.polygon\'); removeParameter(\'geofilter.distance\');" translate>Drawn area on the map</a>    </li>    <li class="odswidget-filter-summary__active-filter" ng-repeat="refinement in refinements">        <a class="odswidget-filter-summary__active-filter-link" ng-click="removeParameter(\'refine.\'+refinement.groupName, refinement.path)">            <i class="fa fa-filter odswidget-filter-summary__active_filter_icon"></i> <span class="odswidget-filter-summary__active-filter-label">{{refinement.groupLabel}}</span> {{refinement.label}}        </a>    </li>    <li class="odswidget-filter-summary__clear-all" ng-show="clearAllButton && isAnyFilterActive">        <a class="odswidget-filter-summary__clear-all-link" ng-click="clearAll()">            <i class="fa fa-ban odswidget-filter-summary__clear-all-icon"></i> <span translate>Clear all</span>        </a>    </li></ul>',scope:{context:"=",exclude:"@",clearAllButton:"=?"},controller:["$scope","translate",function(e,t){Boolean(e.clearAllButton)!==e.clearAllButton&&(e.clearAllButton=!0),e.isAnyFilterActive=!1;var n=e.exclude?e.exclude.split(","):[];e.isParameterActive=function(t){return e.context&&e.context.parameters&&-1===n.indexOf(t)&&e.context.parameters[t]&&void 0!==e.context.parameters[t]};var r=function(n){if("catalog"===e.context.type)return"features"===n&&(n="view"),t(ODS.StringUtils.capitalize(n));for(var r=0;r<e.context.dataset.fields.length;r++){var a=e.context.dataset.fields[r];if(a.name==n)return a.label}},a=function(){return e.context&&e.context.parameters?Object.keys(e.context.parameters).filter(function(e){return"q"==e||"geofilter.polygon"==e||"geofilter.distance"==e||0===e.indexOf("refine.")}):[]};e.clearAll=function(){angular.forEach(a(),function(t){delete e.context.parameters[t]})},e.removeParameter=function(t,n){if(n){var r=e.context.parameters[t];angular.isArray(r)||(r=[r]);for(var a=0;a<r.length;a++)if(r[a]==n)return r.splice(a,1),void(0===r.length&&delete e.context.parameters[t])}else delete e.context.parameters[t]};var i=function(){var t=[];if(e.context&&e.context.parameters&&("catalog"===e.context.type||e.context.dataset))for(var i in e.context.parameters)if("refine."==i.substring(0,7)&&-1===n.indexOf(i)){var o=e.context.parameters[i],s=i.substring(7);angular.isArray(o)||(o=[o]);for(var l=0;l<o.length;l++){var u=o[l];t.push({groupLabel:r(s),groupName:s,path:u,label:u.replace(/\//g," > ")})}}e.refinements=t,e.isAnyFilterActive=a().length>0};e.$watch("context",function(e,t){i()},!0)}]}})}(),function(){"use strict";angular.module("ods-widgets").directive("odsGeotooltip",["$timeout","ModuleLazyLoader",function(e,t){var n=angular.element('<div id="odswidget-geotooltip" class="odswidget" style="opacity: 0; transition: opacity 200ms ease-out; position: fixed; z-index: 40000; visibility: hidden;"></div>'),r=null,a=null,i=function(e,t,i,o,s,l){var u=!1;t===n.css("width")&&i===n.css("height")||(u=!0),n.css("width",t),n.css("height",i);var c=jQuery(window).height()-(e.offset().top-jQuery(document).scrollTop());n.height()<c?n.css("top",e.height()+e.offset().top-jQuery(document).scrollTop()+5+"px"):n.css("top",e.offset().top-jQuery(document).scrollTop()-5-n.height()+"px");var d=jQuery(window).width()-(e.offset().left-jQuery(document).scrollLeft());if(n.width()<d?n.css("left",e.offset().left-jQuery(document).scrollLeft()+"px"):n.css("left",e.offset().left-jQuery(document).scrollLeft()-n.width()+"px"),e.after(n),null===r){r=new L.map(n[0],{zoomControl:!1});var f=new L.TileLayer("http://otile{s}.mqcdn.com/tiles/1.0.0/map/{z}/{x}/{y}.png",{minZoom:1,maxZoom:16,attribution:'Tiles <a href="http://www.mapquest.com/" target="_blank">MapQuest</a> <img src="http://developer.mapquest.com/content/osm/mq_logo.png"> - Map data  <a href="http://www.openstreetmap.org/" target="_blank">OpenStreetMap</a>',subdomains:"1234"});r.addLayer(f)}else u&&r.invalidateSize();null!==a&&r.removeLayer(a),a=L.layerGroup();var p=new L.LatLngBounds;if(o){angular.isString(o)&&(o=o.split(","));var h=new L.LatLng(o[0],o[1]),g=L.marker(h);a.addLayer(g),p.extend(h)}if(s){angular.isString(s)&&(s=angular.fromJson(s));m=L.geoJson(s);a.addLayer(m),p.extend(m.getBounds())}if(l&&angular.isDefined(l.geometry)){var m=L.geoJson(l.geometry);a.addLayer(m),p.extend(m.getBounds())}a.addTo(r),r.fitBounds(p,{reset:!0}),n.css("opacity","1"),n.css("visibility","visible")},o=function(){n.css("opacity","0"),e(function(){n.css("visibility","hidden")},200)};return{template:'<span ng-transclude style="border-bottom: 1px dotted #000000; cursor: help;" class="geotooltip"></span>',replace:!0,restrict:"E",transclude:!0,scope:{coords:"=",width:"@",height:"@",delay:"@",geojson:"=",record:"="},link:function(n,r,a){t("leaflet").then(function(){var t=(a.width||200)+"px",s=(a.height||200)+"px",l=null,u=a.delay||500;r.bind("mouseenter",function(){0===u?i(r,t,s,n.coords,n.geojson,n.record):l=e(function(){i(r,t,s,n.coords,n.geojson,n.record),l=null},u)}),r.bind("click",function(){i(r,t,s,n.coords,n.geojson,n.record),null!==l&&(e.cancel(l),l=null)}),r.bind("mouseleave",function(){o(),null!==l&&(e.cancel(l),l=null)})})}}}])}(),function(){"use strict";var e=angular.module("ods-widgets");e.factory("requestData",["ODSAPI","$q","ChartHelper","AggregationHelper",function(e,t,n,r){var a=function(e,t){var n=[];return"year"==t?n.push(e+".year"):"month"==t?(n.push(e+".year"),n.push(e+".month")):"day"==t?(n.push(e+".year"),n.push(e+".month"),n.push(e+".day")):"hour"==t?(n.push(e+".year"),n.push(e+".month"),n.push(e+".day"),n.push(e+".hour")):"minute"==t?(n.push(e+".year"),n.push(e+".month"),n.push(e+".day"),n.push(e+".hour"),n.push(e+".minute")):"month month"==t?n.push(e+".month"):"day day"==t?n.push(e+".day"):"day weekday"==t?n.push(e+".weekday"):"hour weekday"==t?(n.push(e+".weekday"),n.push(e+".hour")):"day month"==t?n.push(e+".yearday"):"hour hour"==t?n.push(e+".hour"):n.push(e),n},i=function(e,t,n,r){var i,o,s={dataset:e.config.dataset,x:[],sort:e.sort||"",maxpoints:e.maxpoints||""};o=a(e.xAxis,e.timescale);for(l=0;l<o.length;l++)s.x.push(o[l]);if(e.seriesBreakdown){i=e.seriesBreakdown,o=a(i,e.seriesBreakdownTimescale);for(var l=0;l<o.length;l++)s.x.push(o[l])}return(t||e.seriesBreakdown)&&(s.sort=s.x.map(function(e){return"x."+e}).join(",")),s},o=function(e,t,n){var r,a=/([A-Z_-]*?)\((.*?)\)/g,i=/([A-Z_-]*?)\(([a-zA-Z0-9\.]+),\s?([0-9\.]+)\)/g,o=n||e;e.compiled_expr=""+e.expr,o.aggregates=[];for(var s={};r=a.exec(e.expr);){var l=i.exec(r[0]);if(l&&4===l.length&&(r=l),r&&(3===r.length||4===r.length))if(0===r[2].indexOf("serie")){var u="operators."+r[1].toLowerCase()+".apply(null, accumulation['"+r[2]+"']";4===r.length&&(u+=", "+r[3]),u+=")",e.compiled_expr=e.compiled_expr.replace(r[0],u),o.aggregates.push(r[2])}else s[t+".func"]=r[1],s[t+".expr"]=r[2],e.compiled_expr+=e.compiled_expr.replace(r[0],"y")}return s},s=function(e,t,n,r){var a={};return"CUSTOM"===e.func?o(e,"y."+t,r):(a["y."+t+".expr"]=e.yAxis||e.expr,a["y."+t+".func"]=e.func,a["y."+t+".cumulative"]=e.cumulative||!1,"QUANTILES"===e.func&&(e.subsets||(e.subsets=50),a["y."+t+".subsets"]=e.subsets||50),"CONSTANT"===e.func&&(a["y."+t+".expr"]=e.yAxis||0,a["y."+t+".func"]="AVG"),angular.isDefined(e.multiplier)&&""!==e.multiplier&&null!==e.multiplier&&(a["y."+t+".expr"]+=" * "+e.multiplier),a)},l=function(e,t,r){if(t.type&&n.isRangeChart(t.type))if(e.sort==="y."+r&&(e.sort=""),"QUANTILES"===t.charts[0].func&&"QUANTILES"===t.charts[1].func&&t.charts[0].yAxis===t.charts[1].yAxis){var a=angular.copy(t.charts[0]);a.subsets=t.charts[0].subsets+","+t.charts[1].subsets,l(e,a,r)}else angular.isDefined(t.multiplier)&&(t.charts[0].multiplier=t.multiplier,t.charts[1].multiplier=t.multiplier),l(e,t.charts[0],r+"min"),l(e,t.charts[1],r+"max");else angular.extend(e,s(t,r))};return function(n,r,a,o,s,u,c,d){var f=[],p=[],h=u;return angular.forEach(n,function(t,n){var o={},s=i(t,a);angular.forEach(t.charts,function(e,t){var r="serie"+(n+1)+"-"+(t+1);l(s,e,r),o[r]=e}),u=t.config.domain||h,c=t.config.apikey||c;var g={domain:u,domainUrl:e.getDomainURL(u),dataset:{datasetid:s.dataset},apikey:c,parameters:{}};f.push(e.records.analyze(g,angular.extend({},r,t.config.options,s),d.promise)),p.push(o)}),{promise:t.all(f),charts:p}}}]),e.directive("odsHighchartsChart",["colorScale","requestData","translate","ModuleLazyLoader","AggregationHelper","ChartHelper","$rootScope","odsErrorService","$q",function(e,t,n,r,a,i,o,s,l){function u(e,t,r,a,i){var o=C(r,a);if(o&&i)return o.getTime();if(o)return e(t,o);if(void 0!==r)return angular.isObject(r)?r.week?n("Week")+" "+r.week:void 0:""+r}function c(e,t){return"QUANTILES"===t.func&&t.subsets?void 0===e[t.subsets+".0"]?null:e[t.subsets+".0"]:void 0===e?null:e}function d(e,t,n,r){var a;try{a=e.$eval(t,{operators:Math,accumulation:function(e,t){var n={};return angular.forEach(t,function(t){n[t]=e[t]}),n}(n,r),console:console})}catch(e){console.warn("Error while compiling aggregation value with expr",t)}return a}var f=function(e,t){return t?t+"."+e:i.getDatasetUniqueId(e)},p=function(e){var t,n,r;if(e.timescale&&0===$.grep(e.queries,function(e){return e.sort}).length){var a=(r=e.timescale).split(" ");t=a[0],n=2==a.length?a[1]:""}else r=!1,t=!1,n=!1;return{precision:t,periodic:n,timeSerieMode:r}},h=function(e,t,r,a,o){a.height(),a.width();if(0===e.queries.length)e.xLabel="";else if(!angular.isDefined(e.xLabel)){var s=f(e.queries[0].config.dataset,o);e.xLabel=i.getXLabel(s,e.queries[0].xAxis,e.timescale)}angular.isUndefined(e.displayLegend)&&(e.displayLegend=!0);var l={chart:{},title:{text:""},credits:{enabled:!1},series:[],xAxis:{title:{text:e.xLabel},labels:{step:1,rotation:-45,align:"right"},startOfWeek:1,minPadding:0,maxPadding:0,dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e %b %y",week:"%e. %b",month:"%b '%y",year:"%Y"}},legend:{enabled:!!e.displayLegend},yAxis:[],plotOptions:{series:{animation:!1},columnrange:{pointPadding:0,groupPadding:0,borderWidth:0,tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.low}</b> - <b>{point.high}</b>'}},arearange:{tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.low}</b> - <b>{point.high}</b>'}},areasplinerange:{tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.low}</b> - <b>{point.high}</b>'}},pie:{tooltip:{pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y} ({point.percentage:.1f}%)</b>'}},treemap:{tooltip:{headerFormat:"",pointFormat:'<span style="color:{series.color}">{point.name}</span>: {point.value}</b>'},layoutAlgorithm:"squarified"}},tooltip:{valueDecimals:2,headerFormat:"{point.key}<br>",pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b>',formatter:function(e){var t,n=this.points||angular.isArray(this)?this:[this],r=n[0].series;return t=[e.tooltipHeaderFormatter(n[0])],angular.forEach(n,function(e){var n=(r=e.series).tooltipFormatter&&r.tooltipFormatter(e)||e.point.tooltipFormatter(r.tooltipOptions.pointFormat);n=(n=n.replace(/(\.|,)00</,"<")).replace(/(\.|,)00 /," "),t.push(n)}),t.push(e.options.footerFormat||""),t.join("")}},noData:{style:{fontFamily:"Open Sans",fontWeight:"normal",fontSize:"1.4em",color:"#333",opacity:"0.5"}},lang:{noData:n("No data available yet")}};if(t?(l.xAxis.type="datetime",l.xAxis.maxZoom=36e5,l.chart.zoomType="xy"):l.xAxis.categories=[],"month"===r?l.xAxis.labels.format="{value: %B}":"weekday"===r?(l.xAxis.labels.format="{value: %A}","hour"===t&&(l.xAxis.labels.format="{value: %A %Hh}")):"day"===r?l.xAxis.labels.format="{value: %d}":"hour"===r&&(l.xAxis.labels.format="{value: %H}"),t||(l.xAxis.labels.formatter=function(){return this.value.length>11?this.value.substring(0,8)+"...":this.value}),e.singleAxis){var u={color:"#000000",scale:e.singleAxisScale,yRangeMin:e.yRangeMin,yRangeMax:e.yRangeMax};l.yAxis=[w(e.singleAxisLabel,u,!1)]}return l},g={},m=0,v=function(t,n,r,a,o,s,l){var u,c=i.getDatasetId({dataset:{datasetid:r.config.dataset},domain:s}),d=i.getYLabel(c,a);o||"pie"===a.type?"pie"===a.type?(a.extras||(a.extras={}),a.innersize&&(a.extras.innerSize=a.innersize),"inside"===a.labelsposition&&(a.extras.dataLabels={distance:-50}),a.extras.colors=e.getColors(a.color)):(g[o+a.color]||(g[o+a.color]=e.getColorAtIndex(a.color,m),m++),u=g[o+a.color]):u=e.getUniqueColor(a.color);var f=angular.extend({},{name:o||d,color:u,type:a.type,yAxis:t.singleAxis?0:n[c][d],marker:{enabled:"scatter"===a.type,radius:3},shadow:!1,tooltip:{},data:[],stacking:r.stacked?r.stacked:null},a.extras);if(f.dataLabels||(f.dataLabels={}),a.displayValues&&(f.dataLabels.enabled=!0,f.dataLabels.color="black","treemap"!==a.type&&(f.dataLabels.formatter=function(){return Highcharts.numberFormat(this.point.y,2).replace(/[,\.]00$/,"")})),a.displayUnits&&"COUNT"!==a.func){var p=i.getFieldUnit(c,a.yAxis);if(p&&(f.tooltip.valueSuffix=" "+p,a.displayValues&&"treemap"!==a.type)){var h=f.dataLabels.formatter;f.dataLabels.formatter=function(){return h.bind(this)(this.point.y)+" "+p}}}return a.refineOnClick&&(f.point={events:{click:function(e){var t=this.category||this.name;angular.forEach(a.refineOnClick,function(e){l[e["context-name"]].toggleRefine(e.field,t),l.$apply()})}}},f.cursor="pointer"),f=angular.extend(f,i.resolvePosition(a.position)),delete f.position,f},y=function(e){var t="";return angular.isObject(e)&&("year"in e||"month"in e||"day"in e||"hour"in e||"minute"in e||"weekday"in e)&&("year"in e?("day"in e&&(t+=" %e"),"month"in e&&(t+=" %B"),t+=" %Y","hour"in e&&(t+="minute"in e?" %Hh%M":" %Hh")):("month"in e&&(t="%B"),"day"in e&&(t="month"in e?"%e %B":"%e"),"weekday"in e?(t="%a","hour"in e&&(t+=" %Hh")):"hour"in e&&(t="%Hh"))),t},b=function(e,t){var n={};return t&&(n.xDateFormat=y(e)),n},x=function(e,t,n){n&&angular.isObject(e)&&("second"in e?t.minTickInterval=Date.UTC(2010,1,1,1,1,2)-Date.UTC(2010,1,1,1,1,1):"minute"in e?t.minTickInterval=Date.UTC(2010,1,1,1,2)-Date.UTC(2010,1,1,1,1):"hour"in e?t.minTickInterval=Date.UTC(2010,1,1,2)-Date.UTC(2010,1,1,1):"weekday"in e?t.minTickInterval=Date.UTC(2010,1,2)-Date.UTC(2010,1,1):"day"in e||"yearday"in e?t.minTickInterval=Date.UTC(2010,1,2)-Date.UTC(2010,1,1):"month"in e?t.minTickInterval=Date.UTC(2010,1,1)-Date.UTC(2010,0,1):"year"in e&&(t.minTickInterval=Date.UTC(2010,0,1)-Date.UTC(2009,0,1)))},w=function(e,t,n,r){var a=void 0!==t.yRangeMin&&""!==t.yRangeMin,i=void 0!==t.yRangeMax&&""!==t.yRangeMax,o={title:{text:e||"",style:{color:t.color}},labels:{style:{color:t.color}},type:t.scale||"linear",min:a?t.yRangeMin:null,max:i?t.yRangeMax:null,startOnTick:!a,endOnTick:!i,opposite:n};return r&&(o.stackLabels={enabled:!0}),o},C=function(e,t){var n=t?t.getFullYear():2e3,r=t?t.getMonth():0,a=t?t.getDate():1,i=t?t.getHours():0,o=t?t.getMinutes():0;if(angular.isObject(e)&&("year"in e||"month"in e||"day"in e||"hour"in e||"minute"in e||"weekday"in e||"yearday"in e)){var s=new Date(e.year||n,e.month-1||0,e.day||1,e.hour||0,e.minute||0);return s.setFullYear(e.year||n),!1 in e&&s.setUTCMonth(r),!1 in e&&s.setUTCDate(a),!1 in e&&s.setUTCHours(i),!1 in e&&s.setUTCMinutes(o),"year"in e||("weekday"in e&&s.setDate(s.getDate()+7-s.getDay()+e.weekday),"yearday"in e&&s.setDate(0+e.yearday)),"day"in e?29!=e.day||2!=e.month||e.year||(s.setDate(28),s.setMonth(1)):"month"in e&&s.setDate(16),s}};return{restrict:"A",replace:!0,require:["odsHighchartsChart"],scope:{parameters:"=parameters",domain:"=",apikey:"=",colors:"=",contexts:"=?"},template:'<div class="ods-chart">    <div class="ods-chart__loading" ng-show="loading">        <ods-spinner></ods-spinner>    </div>    <div class="chartplaceholder"></div>    <debug data="chartoptions"></debug></div>',controller:["$scope","$element","$attrs",function(r){var a,o,g,m,$=this;r.$watch("contexts",function(e,t){if(r.contexts&&r.contexts.length>0){var n=r.contexts.length-1;r[r.contexts[n].name]=r.contexts[n]}},!0),this.highchartsLoaded=function(C,_){function E(e){if(!g){if(angular.isObject(e)&&("day"in e||"month"in e||"year"in e)){var t=new Date(e.year,e.month-1||0,e.day||1,e.hour||0,e.minute||0);return C.dateFormat("%Y-%m-%d",t)}return""+e}switch(console.warn("formatRowX on periodic value should not be used anymore"),g){case"month":return[n("Jan"),n("Feb"),n("Mar"),n("Apr"),n("May"),n("Jun"),n("Jul"),n("Aug"),n("Sep"),n("Oct"),n("Nov"),n("Dec")][e.month-1];case"weekday":return[n("Monday"),n("Tuesday"),n("Wednesday"),n("Thursday"),n("Friday"),n("Saturday"),n("Sunday")][e.weekday];case"day":return e.day;default:return""+e}}var A=_.find(".chartplaceholder");C.setOptions({global:{useUTC:!1}});var k=l.defer();$.update=function(_){function S(e,t,n,r,a,i,o){if("datetime"===F.xAxis.type){if("object"==typeof a){var s=a[0],l=a[1];"logarithmic"===n&&(s<=0||l<=0)?e.data.push([r,null,null]):e.data.push([r,s,l])}else if("pie"==e.type)e.data.push({name:C.dateFormat(e.tooltip.xDateFormat,new Date(r)),y:a});else if("treemap"==e.type)e.data.push({name:C.dateFormat(e.tooltip.xDateFormat,new Date(r)),value:a});else if("logarithmic"===n&&a<=0?e.data.push([r,null]):e.data.push([r,a]),o.length>0)for(u=o.length-1;u>=0;u--)if(a>=o[u].value){e.data[e.data.length-1]={x:e.data[e.data.length-1][0],y:e.data[e.data.length-1][1],color:o[u].color};break}}else if("pie"==e.type)e.data[t]={name:E(r),y:a};else if("treemap"==e.type)e.data[t]={name:E(r),value:a};else{if("object"==typeof a){var s=a[0],l=a[1];e.data[t]="logarithmic"===n&&(s<=0||l<=0)?[null,null]:[s,l]}else e.data[t]="logarithmic"===n&&a<=0?null:a;if(o.length>0)for(var u=o.length-1;u>=0;u--)if(a>=o[u].value){e.data[t]={y:e.data[t],color:o[u].color};break}}}if(void 0===_&&(_=r.parameters),(_=angular.copy(_))&&_.queries&&0!==_.queries.length){a=void 0,o=void 0,g=void 0,m={};for(var D=0;D<_.queries.length;D++)try{f(_.queries[D].config.dataset,void 0)}catch(e){return void i.onLoad($.update)}var T=p(_);a=T.timeSerieMode,o=T.precision,g=T.periodic;var F=h(_,o,g,A,void 0);r.chartoptions=F,angular.forEach(_.queries,function(t){var n=i.getDatasetId({dataset:{datasetid:t.config.dataset},domain:t.config.domain});angular.isUndefined(m[n])&&(m[n]={}),angular.forEach(t.charts,function(t){var r=i.getYLabel(n,t);if(!_.singleAxis&&angular.isUndefined(m[n][r])){var a=w(r,t,!!(F.yAxis.length%2),t.stacked);m[n][r]=F.yAxis.push(a)-1}if("bar"==t.type&&(F.xAxis.labels.rotation=0),t.colorScale=e.getScale(t.color),i.allowThresholds(t.type)){if(t.thresholds){for(var o=0;o<t.thresholds.length;o++)angular.isNumber(t.thresholds[o].value)||t.thresholds.splice(o,1);t.thresholds=t.thresholds.sort(function(e,t){return e.value>t.value})}}else delete t.thresholds})}),k.resolve("new request coming, cancelling current one"),k=l.defer(),r.loading=!0;var M=t(_.queries,r.searchoptions,a,o,g,r.domain,r.apikey,k);M.promise.then(function(t){r.loading=!1;var i,l=M.charts;if(o)for(var f=0;f<t.length;f++)for(var p=t[f],h=0;h<p.data.length;h++){var g=p.data[h];if(g.x.year){var w=new Date(g.x.year,g.x.month-1||0,g.x.day||1,g.x.hour||0,g.x.minute||0);w.setFullYear(g.x.year),(void 0===i||w<i)&&(i=w)}}for(var $=[],h=0;h<_.queries.length;h++)if(!_.queries[h].seriesBreakdown)for(var E=0;E<_.queries[h].charts.length;E++)$.push("serie"+(h+1)+"-"+(E+1)),F.series.push(!1);var k=function(e,t,n,a,i,s,l,u,c){var d,f=$.indexOf(e);s.colorScale(u).hex();-1===f?(n.series.push(v(t,m,i,s,c,i.config.domain||void 0,r)),f=$.push(e)-1):n.series[f]||(n.series[f]=v(t,m,i,s,c,i.config.domain||void 0,r)),o||-1!==(d=n.xAxis.categories.indexOf(l))||(d=n.xAxis.categories.length,n.xAxis.categories.push(l)),angular.extend(n.series[f].tooltip,a),c||"pie"===s.type?S(n.series[f],d,t.singleAxisScale||s.scale,l,u,n.series[f].color,s.thresholds||[]):S(n.series[f],d,t.singleAxisScale||s.scale,l,u,s.colorScale(u).hex(),s.thresholds||[])};angular.forEach(t,function(t,n){var s,f;if(t.data&&0!==t.data.length&&(t.data.results?(s=t.data.results,f=t.data.aggregations):s=t.data,0!==s.length)){var p=_.queries[n],h=l[n],g=p.xAxis,m=!!p.seriesBreakdown,v=b(m?s[0].x[g]:s[0].x,F);x(m?s[0].x[g]:s[0].x,F.xAxis,a),p.defaultValues={},angular.forEach(h,function(e,t){p.defaultValues[t]=null}),f&&angular.forEach(f,function(t,n){var r,a;if(n.endsWith("min"))n=n.replace("min",""),r=t.min,a=f[n+"max"].max;else{if(n.endsWith("max"))return;h[n].charts&&"QUANTILES"===h[n].charts[0].func&&"QUANTILES"===h[n].charts[1].func?(r=t.min[h[n].charts[0].subset+".0"],r=t.max[h[n].charts[1].subset+".0"]):(r=t.min,a=t.max)}h[n].colorScale=e.getScale(h[n].color,r,a)});for(var w=!1,$=[],E=[],A={},S=_.queries[n].charts.length,D=0;D<S;D++){var T=_.queries[n].charts[D];if(T.aggregates)for(var M=0;M<T.aggregates.length;M++){var L=T.aggregates[M];L&&-1===$.indexOf(L)&&($.push(L),A[L]=[])}T.compiled_expr&&(w=!0)}for(j=0;j<s.length;j++){var O=s[j];angular.extend({},p.defaultValues,O);var N=u(C.dateFormat,v.xDateFormat,m?O.x[g]:O.x,i,o),D=0;angular.forEach(O,function(e,t){var n,r;if("x"!==t){if(t.endsWith("min"))return;r=t.endsWith("max")?t.replace("max",""):t;var a=h[r];n=t.endsWith("max")?[c(O[t.replace("max","min")],a.charts[0]),c(e,a.charts[1])]:a.charts?[c(e,a.charts[0]),c(e,a.charts[1])]:c(e,a),m?angular.forEach(O.x,function(e,t){t!==g&&(e=u(C.dateFormat,y(e),e,i,!1),k(""+r+t+e,_,F,v,p,a,N,n,e),$.indexOf(r)>=0&&A[r].push(n))}):(k(""+r,_,F,v,p,a,N,n),$.indexOf(r)>=0&&A[r].push(n)),w&&E.push(N),D++}})}if(w){E.sort(function(e,t){return e-t});for(j=E.length-1;j>0;j--)E[j]==E[j-1]&&E.splice(j,1)}for(var j=0;j<p.charts.length;j++)if(p.charts[j].aggregates)for(var P=p.charts[j],B=d(r,P.compiled_expr,A,P.aggregates),D=0;D<E.length;D++)k("aggr"+n+"-"+j,_,F,v,p,P,E[D],B)}});var D=F.xAxis.categories;if(D)for(h=0;h<F.series.length;h++)for(var T=0;T<D.length;T++)void 0===F.series[h].data[T]&&(F.series[h].data[T]=null);r.chart&&F.chart.renderTo&&(r.chart.destroy(),A=$element.find(".chartplaceholder")),F.chart.renderTo=A[0];try{F.series.length>500&&(s.sendErrorNotification(n("There are too many series to be displayed correctly, try to refine your query a bit.")),F.series=F.series.slice(0,10)),r.chart=new C.Chart(F,function(){})}catch(e){e.indexOf&&0===e.indexOf("Highcharts error #19")?(s.sendErrorNotification(n("There was too many points to display, the maximum number of points has been decreased.")),angular.forEach(r.parameters.queries,function(e){e.maxpoints=20})):angular.isString(e)?s.sendErrorNotification(e):s.sendErrorNotification(e.message)}},function(e){r.loading=!1})}else r.chart&&angular.element(r.chart.container).empty()}}}],link:function(e,t,n,a){var i=a[0];r("highcharts").then(function(){i.highchartsLoaded(Highcharts,t),e.$watch("parameters",function(e,t){i.update(e)},!0)})}}}]),e.directive("odsHighcharts",["colorScale",function(e){var t=e.getColors(e.getDefaultColorSet());return{restrict:"E",scope:{context:"=",fieldX:"@",expressionY:"@",functionY:"@",timescale:"@",chartType:"@",color:"@",chartConfig:"=",labelX:"@",labelY:"@",sort:"@",maxpoints:"@"},replace:!0,template:'<div class="odswidget odswidget-highcharts"><div ods-highcharts-chart parameters="chart" domain="context.domain" apikey="context.apikey"></div></div>',controller:["$scope","ODSWidgetsConfig","ChartHelper",function(e,n,r){var a=n.chartColors||t;e.color&&(a=e.color.split(",").map(function(e){return e.trim()}));var i=e.$watch("context.dataset",function(t){if(t){if("dataset"!==e.context.type&&console.error("ods-highcharts requires a Dataset Context"),r.init(e.context),angular.isUndefined(e.chartConfig)){var n={};"pie"===e.chartType&&(n={colors:a});var o="";o="y"===e.sort?"serie1-1":"-y"===e.sort?"-serie1-1":e.sort;var s=e.labelY||("COUNT"===e.functionY.toUpperCase()?"Count":e.expressionY);e.chart={timescale:e.timescale,xLabel:e.labelX,queries:[{config:{dataset:e.context.dataset.datasetid,options:e.context.parameters,domain:e.context.domain},xAxis:e.fieldX,sort:o,maxpoints:e.maxpoints||50,charts:[{yAxis:e.expressionY,yLabelOverride:s,func:e.functionY,color:a[0],type:e.chartType,extras:n}]}]}}else angular.isString(e.chartConfig)?e.chart=JSON.parse(b64_to_utf8(e.chartConfig)):e.chart=angular.copy(e.chartConfig);e.$broadcast("chartConfigReady",e.chart),e.$watch("chart",function(t){if(t){for(var n=r.getDatasetId(e.context),a=0;a<t.queries.length;a++){var i=t.queries[a];void 0===i.xAxis&&r.setDefaultQueryValues(n,i,!0);for(o=0;o<i.charts.length;o++)r.setSerieDefaultValues(n,i.charts[o],i.xAxis,!0);r.setDefaultQueryValues(n,i,!0),1===e.chart.queries.length&&r.setChartDefaultValues(n,t,!0);for(var o=0;o<i.charts.length;o++)r.setSerieDefaultColors(i.charts[o],i.seriesBreakdown)}e.$broadcast("chartConfigReady",e.chart)}},!0),i()}})}]}}]),e.directive("odsMultiHighcharts",["ODSAPI","ChartHelper","$q",function(e,t,n){return{restrict:"E",scope:{context:"=",chartConfig:"="},replace:!0,template:'<div class="odswidget odswidget-multihighcharts"><div ods-chart parameters="chart" domain="context.domain" apikey="context.apikey"></div></div>',controller:["$scope",function(r){var a=r.$watch("context",function(i){if(i){"catalog"!==i.type&&console.error("ods-multi-highcharts requires a Catalog Context");var o;o=angular.isString(r.chartConfig)?JSON.parse(b64_to_utf8(r.chartConfig)):r.chartConfig;for(var s=[],l=0;l<o.queries.length;l++){var u=o.queries[l].config.dataset;-1===s.indexOf(u)&&s.push(u)}for(var c=[],l=0;l<s.length;l++)c.push(e.datasets.get(r.context,s[l],{extrametas:!0}).success(function(e){var n=new ODS.Dataset(e);r.context.dataset=n,t.init(r.context)}));n.all(c).then(function(e){r.chart=o}),a()}})}]}}]),e.directive("odsChart",["ODSAPI","ChartHelper","ODSWidgetsConfig",function(e,t,n){return{restrict:"EA",scope:{timescale:"@",labelX:"@",singleYAxis:"@",singleYAxisLabel:"@",singleYAxisScale:"@",min:"@",max:"@",logarithmic:"@",displayLegend:"@",context:"=?",fieldX:"@",expressionY:"@",functionY:"@",chartType:"@",color:"@",chartConfig:"=?",labelY:"@",sort:"@",maxpoints:"@",chart:"=?parameters"},replace:!0,transclude:!0,template:'<div class="odswidget odswidget-charts"><debug data="chart"></debug><div ods-highcharts-chart parameters="chart" domain="context.domain" apikey="context.apikey" contexts="contexts"></div><div ng-transclude></div></div>',controller:["$scope","$element","$attrs","$transclude",function(e,r,a,i){e.contexts=[],e.chart||(e.chart={queries:[],xLabel:angular.isDefined(e.labelX)?e.labelX:void 0,timescale:e.timescale||"",singleAxis:!!e.singleYAxis,singleAxisLabel:angular.isDefined(e.singleYAxisLabel)?e.singleYAxisLabel:void 0,singleAxisScale:e.logarithmic?"logarithmic":"",yRangeMin:angular.isDefined(e.min)?parseInt(e.min,10):void 0,yRangeMax:angular.isDefined(e.max)?parseInt(e.max,10):void 0,displayLegend:!angular.isDefined(e.displayLegend)||"false"!==e.displayLegend}),angular.forEach(e.chart,function(t,n){void 0===t&&delete e.chart[n]}),a.context?(!function(){var r=n.chartColors||defaultColors;e.color&&(r=e.color.split(",").map(function(e){return e.trim()}));var a=e.$watch("context.dataset",function(n){if(n){if("dataset"!==e.context.type&&console.error("ods-chart requires a Dataset Context"),t.init(e.context),angular.isUndefined(e.chartConfig)){var i={};"pie"===e.chartType&&(i={colors:r});var o="";o="y"===e.sort?"serie1-1":"-y"===e.sort?"-serie1-1":e.sort;var s=e.labelY||("COUNT"===e.functionY.toUpperCase()?"Count":e.expressionY);e.chart={timescale:e.timescale,xLabel:e.labelX,queries:[{config:{dataset:e.context.dataset.datasetid,options:e.context.parameters},xAxis:e.fieldX,sort:o,maxpoints:e.maxpoints||50,charts:[{yAxis:e.expressionY,yLabelOverride:s,func:e.functionY,color:r[0],type:e.chartType,extras:i}]}]}}else angular.isString(e.chartConfig)?e.chart=JSON.parse(b64_to_utf8(e.chartConfig)):e.chart=e.chartConfig;a()}})}(),this.setQuery=function(e,t){console.error("cannot use ods-chart-query when context and chartConfig are declared on ods-chart")}):(this.setQuery=function(n,r){var a,i=e.chart.queries.indexOf(n);-1===i?(i=e.chart.queries.length,e.chart.queries.push(n)):e.chart.queries[i]=n,n.sort&&(a=n.sort.match(/^(-?)serie([0-9]+)$/))&&(e.chart.queries[i].sort=a[1]+"serie"+(i+1)+"-"+a[2]),e.contexts.push(r);var o=t.getDatasetId(r);void 0===n.xAxis&&t.setDefaultQueryValues(o,n,!0);for(s=0;s<n.charts.length;s++)t.setSerieDefaultValues(o,n.charts[s],n.xAxis,!0);t.setDefaultQueryValues(o,n,!0),1===e.chart.queries.length&&t.setChartDefaultValues(o,e.chart,!0);for(var s=0;s<n.charts.length;s++)t.setSerieDefaultColors(n.charts[s],n.seriesBreakdown)},e.$watch("labelX",function(t,n){e.chart.xLabel=t}))}]}}]),e.directive("odsChartQuery",["ODSAPI","ChartHelper",function(e,t){return{restrict:"E",require:["odsChartQuery","^odsChart"],controller:["$scope",function(e){}],compile:function(){return{pre:function(e,n,r,a){var i=a[0],o=a[1],s={config:{},charts:[],xAxis:r.fieldX,maxpoints:r.maxpoints?parseInt(r.maxpoints,10):void 0,timescale:r.timescale,stacked:r.stacked,seriesBreakdown:r.seriesBreakdown,seriesBreakdownTimescale:r.seriesBreakdownTimescale};s.sort="","y"===r.sort?s.sort="serie1":"-y"===r.sort?s.sort="-serie1":s.sort=r.sort;var l=r.options||{};angular.forEach(s,function(e,t){void 0===e&&delete s[t]}),i.setChart=function(e){-1===s.charts.indexOf(e)&&s.charts.push(e)};var u=function(e){e&&o.setQuery(s,e)},c=r.context;e[c].wait().then(function(n){t.init(e[c]),s.config.dataset=n.datasetid,s.config.domain=e[c].domain,s.config.apikey=e[c].apikey,s.config.options=angular.extend({},e[c].parameters,l),i.setChart=function(t){-1===s.charts.indexOf(t)&&s.charts.push(t),u(e[c])},u(e[c]),e.$watch(c+".parameters",function(t,n){t&&(s.config.options=angular.extend({},t,l),u(e[c]))},!0)})}}}}}]),e.directive("odsChartSerie",["ODSAPI","ChartHelper","$compile","$parse",function(e,t,n,r){return{restrict:"E",require:"^odsChartQuery",controller:["$scope","$transclude",function(e,t){}],link:function(e,t,n,r){var a,i=r,o={type:n.chartType||void 0,innersize:n.innersize||void 0,labelsposition:n.labelsposition||void 0,func:n.functionY||void 0,yAxis:n.expressionY||void 0,color:n.color||void 0,cumulative:!!n.cumulative||!1,yLabelOverride:angular.isDefined(n.labelY)?n.labelY:void 0,scale:n.logarithmic?"logarithmic":"",yRangeMin:angular.isDefined(n.min)?parseInt(n.min,10):void 0,yRangeMax:angular.isDefined(n.max)?parseInt(n.max,10):void 0,displayUnits:"true"===n.displayUnits,displayValues:"true"===n.displayValues,multiplier:angular.isDefined(n.multiplier)?parseInt(n.multiplier,10):void 0,thresholds:n.colorThresholds?e.$eval(n.colorThresholds):[],subsets:n.subsets,charts:n.subseries?JSON.parse(n.subseries):void 0};if(n.refineOnClickContext){a=angular.isArray(n.refineOnClickContext)?n.refineOnClickContext:[n.refineOnClickContext];for(var s=0;s<a.length;s++)n["refineOnClick"+ODS.StringUtils.capitalize(a[s])+"ContextField"]?(o.refineOnClick||(o.refineOnClick=[]),o.refineOnClick.push({context:e[a[s]],"context-name":a[s],field:n["refineOnClick"+ODS.StringUtils.capitalize(a[s])+"ContextField"],scopeApply:e.$apply})):console.warn("Field for context "+ODS.StringUtils.capitalize(a[s])+" is not set in chart.")}angular.forEach(o,function(e,t){void 0===e&&delete o[t]}),i.setChart(o),n.$observe("labelY",function(e){o.yLabelOverride=e,i.setChart(o)})}}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsInfiniteScrollResults",function(){return{template:'<div class="{{listClass}} odswidget-infinite-scroll-results" infinite-scroll="loadMore()" infinite-scroll-distance="1" infinite-scroll-disabled="fetching">   <div class="{{resultClass}}" ng-repeat="item in results" inject>   </div></div>',scope:{context:"=",resultClass:"@",listClass:"@",scrollTopWhenRefresh:"="},transclude:!0,controller:["$scope","$window","ODSAPI",function(e,t,n){var r=0;e.fetching=!1,e.results=[];var a=function(t){t?r=0:r+=1;var a=10*r;e.fetching=!0,"catalog"==e.context.type?n.datasets.search(e.context,{rows:10,start:a}).success(function(e){i(e.datasets,t)}):n.records.search(e.context,{rows:10,start:a}).success(function(e){i(e.records,t)})},i=function(n,r){r&&(e.results=[]),e.results=e.results.concat(n),e.fetching=!1,r&&e.scrollTopWhenRefresh&&t.scrollTo(t.scrollX,0)};e.loadMore=function(){a(!1)},e.$watch("context.parameters",function(e,t){angular.isDefined(e)&&e!==t&&a(!0)})}]}})}(),function(){"use strict";angular.module("ods-widgets").directive("odsLastDatasetsFeed",["ODSAPI",function(e){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-last-datasets-feed"><ul>   <li class="no-data" ng-hide="datasets" translate>No data available yet</li>   <li ng-repeat="dataset in datasets" ng-if="datasets">       <ods-theme-picto theme="{{dataset.metas.theme|firstValue}}"></ods-theme-picto>       <div class="dataset-details">           <div class="title"><a ng-href="{{context.domainUrl}}/explore/dataset/{{dataset.datasetid}}/" target="_self">{{ dataset.metas.title }}</a></div>           <div class="modified"><i class="icon-calendar"></i> <span title="{{ dataset.metas.modified|moment:\'LLL\' }}"><span translate>Modified</span> {{ dataset.metas.modified|timesince }}</span></div>       </div>   </li></ul></div>',scope:{context:"="},controller:["$scope",function(t){var n=function(){e.datasets.search(t.context,{rows:5,sort:"modified"}).success(function(e){t.datasets=e.datasets})};t.$watch("context",function(){n()})}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsLastReusesFeed",["ODSAPI",function(e){return{restrict:"E",replace:!0,transclude:!0,template:'<div class="odswidget odswidget-last-reuses-feed"><ul>   <li class="no-data" ng-hide="reuses" translate>No data available yet</li>   <li ng-repeat="reuse in reuses" ng-if="reuses" inject>       <div class="reuse-thumbnail">           <span style="display: inline-block; height: 100%; vertical-align: middle;"></span>           <a ng-href="{{reuse.url}}" target="_self"><img ng-if="reuse.thumbnail" ng-src="{{ reuse.thumbnail }}"></a>       </div>       <div class="reuse-details">           <div class="title"><a ng-href="{{reuse.url}}" target="_self">{{ reuse.title }}</a></div>           <div class="dataset"><a ng-href="{{reuse.url}}" target="_self">{{ reuse.dataset.title }}</a></div>           <div class="modified"><span title="{{ reuse.created_at|moment:\'LLL\' }}"><i class="icon-calendar"></i> {{ reuse.created_at|timesince }}</span></div>       </div>   </li></ul></div>',scope:{context:"=",max:"@"},controller:["$scope",function(t){t.max=t.max||5;var n=function(){e.reuses(t.context,{rows:t.max}).success(function(e){angular.forEach(e.reuses,function(e){e.url=t.context.domainUrl+"/explore/dataset/"+e.dataset.id+"/?tab=metas"}),t.reuses=e.reuses})};t.$watch("context",function(){n()})}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsMapLegacy",["ModuleLazyLoader",function(e){return{restrict:"E",scope:{context:"=",embedMode:"@",autoResize:"@",mapContext:"=?",location:"@",basemap:"@",isStatic:"@",showFilters:"@",itemClickContext:"=",colorBy:"@",colorByField:"@",colorByContext:"=",colorByAggregationKey:"@",colorByKey:"@",colorByExpression:"@",colorByFunction:"@",colorByRanges:"@",colorByRangesColors:"@"},replace:!0,template:function(e){return e.contents().wrapAll("<div>"),e.contents().length>0&&e.contents().html().trim().length>0&&(e.contents().wrapAll("<div>"),e.data("tooltip-template",e.children().html())),'<div class="odswidget odswidget-map"><div class="odswidget-map__map"></div><div class="odswidget-overlay map odswidget-overlay--opaque" ng-show="pendingRequests.length && initialLoading"><ods-spinner></ods-spinner></div></div>'},link:function(t,n){function r(){$(".odswidget-map__map").length>0&&$(".odswidget-map__map").height(Math.max(200,$(window).height()-$(".odswidget-map__map").offset().top))}angular.isUndefined(t.mapContext)&&(t.mapContext={},t.location&&(t.mapContext.location=t.location),t.basemap&&(t.mapContext.basemap=t.basemap)),"true"===t.autoResize&&($(window).on("resize",r),r()),e("leaflet").then(function(){L.Control.FilterByView=L.Control.extend({options:{position:"topright"},onAdd:function(e){var n="leaflet-control-filterview leaflet-bar leaflet-control",r=L.DomUtil.create("div",n),a=L.DomUtil.create("a","leaflet-bar-part",r);return a.href="#",t.mapViewFilter&&(r.className=n+" active"),L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,"click",function(){return t.$apply(function(e){e.mapViewFilter=!e.mapViewFilter}),t.mapViewFilter?r.className=n+" active":r.className=n,!1}).on(a,"dblclick",L.DomEvent.stopPropagation),t.$watch("mapViewFilter",function(e,t){e!==t&&(r.className=e?n+" active":n)}),r}}),t.initMap=function(e,r,a,i,o,s,l,u,c){var d={basemapsList:a,worldCopyJump:!0,minZoom:2,basemap:s,dragging:!l,zoomControl:!l,prependAttribution:u};l&&(d.doubleClickZoom=!1,d.scrollWheelZoom=!1);var f=new L.ODSMap(n.children()[0],d);if(f.addControl(new L.Control.Scale),o&&!l){var p=L.Control.geocoder({placeholder:i("Find a place..."),errorMessage:i("Nothing found."),geocoder:new L.Control.Geocoder.Nominatim({serviceUrl:"https://nominatim.openstreetmap.org/",geocodingQueryParams:{"accept-language":c||"en",polygon_geojson:!0}})});p.markGeocode=function(e){if(f.fitBounds(e.bbox),e.properties.geojson){var t=L.geoJson(e.properties.geojson,{style:function(){return{opacity:0,fillOpacity:.8,fillColor:"orange",className:"leaflet-geocoder-highlight"}}});f.addLayer(t),$timeout(function(){n.addClass("geocoder-highlight-on")},0),$timeout(function(){n.removeClass("geocoder-highlight-on"),f.removeLayer(t)},2500)}},f.addControl(p)}"true"!==r&&("true"===t.showFilters&&f.addControl(new L.Control.FilterByView),f.addControl(new L.Control.Fullscreen)),l||f.addControl(new L.Control.Locate({maxZoom:18})),f.on("popupclose",function(e){jQuery(e.popup.getContent()).trigger("popupclose")}),t.map=f}})},controller:["$scope","$http","$compile","$q","$filter","$element","translate","ODSAPI","DebugLogger","ODSWidgetsConfig","$attrs",function(e,t,n,r,a,i,o,s,l,u,c){l.log("init map"),e.pendingRequests=t.pendingRequests,e.initialLoading=!0,(e.itemClickMapField&&!e.itemClickContextField||!e.itemClickMapField&&e.itemClickContextField)&&console.log("ERROR: You need to configure both item-click-context-field and item-click-map-field.");var d,f=null,p=null,h={delimiter:",",accuracy:5,formatLatLng:function(e){var t=L.Util.formatNum(e.lat,this.accuracy),n=L.Util.formatNum(e.lng,this.accuracy);return new L.latLng(t,n)},getLocationParameterAsArray:function(e){return e.split(this.delimiter)},getLocationParameterFromMap:function(e){var t=this.formatLatLng(e.getCenter());return e.getZoom()+this.delimiter+t.lat+this.delimiter+t.lng},getCenterFromLocationParameter:function(e){var t=this.getLocationParameterAsArray(e);return new L.latLng(t[1],t[2])},getZoomFromLocationParameter:function(e){return this.getLocationParameterAsArray(e)[0]}},g=function(e,t){ODS.GeoFilter.addGeoFilterFromSpatialObject(e.parameters,t)},m=function(e,t,n,r){angular.isDefined(r.fields[t])&&(e.parameters["refine."+n]=r.fields[t])},v=function(t,n,r,a,i){if(n||r)if(i)e.$apply(function(){m(t,n,r,i)});else{var o={};ODS.GeoFilter.addGeoFilterFromSpatialObject(o,a),jQuery.extend(o,e.staticSearchOptions,e.context.parameters,{rows:1}),s.records.download(e.context,o).success(function(e){m(t,n,r,e[0])})}else e.$apply(function(){g(t,a)})},y=function(t,r,a,o){var s,l,u;if(e.itemClickContext)angular.isArray(e.itemClickContext)?angular.forEach(e.itemClickContext,function(e){l=c["itemClick"+ODS.StringUtils.capitalize(e.name)+"ContextField"],s=c["itemClick"+ODS.StringUtils.capitalize(e.name)+"MapField"],v(e,s,l,r,o)}):(u=e.itemClickContext,l=c["itemClick"+ODS.StringUtils.capitalize(u.name)+"ContextField"]||c.itemClickContextField,s=c["itemClick"+ODS.StringUtils.capitalize(u.name)+"MapField"]||c.itemClickMapField,v(u,s,l,r,o));else{var d=e.$new(!1);a?d.recordid=a:d.shape=r;var f={offset:[0,-30],maxWidth:250,minWidth:250,autoPanPaddingTopLeft:[50,305],autoPan:!e.mapViewFilter&&!e.staticMap},p=i.data("tooltip-template");!angular.isUndefined(p)&&angular.isString(p)&&""!==p.trim()||(p=e.context.dataset.extra_metas&&e.context.dataset.extra_metas.visualization&&e.context.dataset.extra_metas.visualization.map_tooltip_html?e.context.dataset.extra_metas.visualization.map_tooltip_html:""),d.template=p,new L.Popup(f).setLatLng(t).setContent(n('<ods-map-tooltip shape="shape" context="context" recordid="recordid" map="map" template="{{template}}"></ods-map-tooltip>')(d)[0]).openOn(e.map)}},b=function(e){return e=Math.round(100*e)/100,e=a("number")(e)},x=function(t){return function(n,r){if(n.count>1){var a=new L.ClusterMarker(n.cluster_center,{geojson:n.cluster,value:n.count,total:r,numberFormattingFunction:b,color:e.markerColor});e.staticMap||a.on("click",function(t){e.map.getZoom()===e.map.getMaxZoom()?y(marker.getLatLng(),n.cluster):e.$apply(function(){if(n.cluster)if("Point"===n.cluster.type)e.map.fitBounds([[n.cluster.coordinates[1],n.cluster.coordinates[0]],[n.cluster.coordinates[1],n.cluster.coordinates[0]]]);else{var r={},a=ODS.GeoFilter.getBoundsAsPolygonParameter(L.geoJson(n.cluster).getBounds());jQuery.extend(r,e.staticSearchOptions,e.context.parameters,{"geofilter.polygon":a}),s.records.boundingbox(e.context,r).success(function(t){e.map.fitBounds([[t.bbox[1],t.bbox[0]],[t.bbox[3],t.bbox[2]]])})}else e.map.setView(t.latlng,e.map.getZoom()+2)})}),t.addLayer(a)}else{var i=p(n.cluster_center);i.on("click",function(e){y(e.target.getLatLng(),n.cluster)}),t.addLayer(i)}}},w=function(t){var n={"geofilter.polygon":ODS.GeoFilter.getBoundsAsPolygonParameter(e.map.getBounds()),clusterprecision:e.map.getZoom(),clusterdistance:50,return_polygons:t};jQuery.extend(n,e.staticSearchOptions,e.context.parameters),e.currentClusterRequestCanceler&&e.currentClusterRequestCanceler.resolve(),e.currentClusterRequestCanceler=r.defer(),s.records.geo(e.context,n,e.currentClusterRequestCanceler.promise).success(function(t){var n=t.clusters;e.records=n?n.length:0;for(var r=new L.LayerGroup,a=x(r),i=0;i<n.length;i++)a(n[i],t.count.max);r.addTo(e.map),e.layerGroup&&e.map.removeLayer(e.layerGroup),e.layerGroup=r,e.initialLoading=!1,e.currentClusterRequestCanceler=null})},$=function(){var t={"geofilter.polygon":ODS.GeoFilter.getBoundsAsPolygonParameter(e.map.getBounds()),clusterprecision:e.map.getZoom()};jQuery.extend(t,e.staticSearchOptions,e.context.parameters),t.rows=1e3,e.currentClusterRequestCanceler&&e.currentClusterRequestCanceler.resolve(),e.currentClusterRequestCanceler=r.defer(),s.records.geopreview(e.context,t,e.currentClusterRequestCanceler.promise).success(function(t){for(var n=new L.LayerGroup,r=0;r<t.length;r++)C(n,t[r]);n.addTo(e.map),e.layerGroup&&e.map.removeLayer(e.layerGroup),e.layerGroup=n,e.initialLoading=!1,e.currentClusterRequestCanceler=null})},C=function(e,t){var n={radius:3,fillColor:"#0033ff",color:"#0000ff",weight:1,opacity:1,fillOpacity:.5},r=new L.GeoJSON(t.geometry,{pointToLayer:function(e,t){return L.circleMarker(t,n)}});e.addLayer(r),r.on("click",function(e){y(e.latlng,t.geometry,t.id)})},_=function(e){var t;for(t=0;t<d.ranges.length;t++)if(e<d.ranges[t])return d.colors[t];return d.colors[d.colors.length-1]},E=function(){var t=angular.extend({},d.context.parameters,{"join.geo.remotedataset":e.context.dataset.datasetid,"join.geo.localkey":d.localkey,"join.geo.remotekey":d.remotekey,"y.agg.expr":d.expr,"y.agg.func":d.func}),n=new L.LayerGroup,r=new L.LatLngBounds,a=new L.FeatureGroup;s.records.analyze(d.context,t).success(function(t){angular.forEach(t,function(e){var t=e.x,i=e.agg;angular.forEach(t,function(e){k(e,n,r,a,_(i))})}),e.layerGroup&&e.map.removeLayer(e.layerGroup),n.addLayer(a),n.addTo(e.map),e.layerGroup=n,e.initialLoading=!1})},A=function(){var t={};t["geofilter.polygon"]=ODS.GeoFilter.getBoundsAsPolygonParameter(e.map.getBounds()),jQuery.extend(t,e.staticSearchOptions,e.context.parameters),l.log("map -> download"),s.records.download(e.context,t).success(function(t,n,r,a){e.records=t,e.error="",e.nhits=t.length;for(var i=new L.LayerGroup,o=new L.LatLngBounds,s=new L.FeatureGroup,l=0;l<t.length;l++){var u=t[l];k(u,i,o,s)}e.layerGroup&&e.map.removeLayer(e.layerGroup),i.addLayer(s),i.addTo(e.map),e.layerGroup=i,e.initialLoading=!1}).error(function(t,n,r,a){e.error=t.error,e.initialLoading=!1})},k=function(t,n,r,a,i){var o,s=i;if("value"===e.colorBy){var l=t.fields[d.field];l&&(s=_(l))}if(f){if(!t.fields[f])return;"Point"===(o=t.fields[f]).type&&angular.isDefined(t.geometry)&&(o=t.geometry)}else{if(!t.geometry)return;o=t.geometry}if("Point"==o.type){var u=new L.LatLng(o.coordinates[1],o.coordinates[0]),c=p(u,s);c.on("click",function(e){y(e.target.getLatLng(),o,null,t)}),a.addLayer(c),r.extend(u)}else{var h;(h=s?new L.GeoJSON(o,{style:function(e){var t={radius:3,weight:1,opacity:.9,fillOpacity:.5,color:s};return t.fillColor=s,"LineString"===e.geometry.type||"MultiLineString"===e.geometry.type?(t.weight=5,t.color=s):t.color="#fff",t}}):new L.GeoJSON(o)).on("click",function(e){y(L.latLng(t.geometry.coordinates[1],t.geometry.coordinates[0]),o,t.recordid,t)}),n.addLayer(h),r.extend(h.getBounds())}};e.$watch("context.parameters",function(t,n){t!==n&&(e.initialLoading||(l.log("map -> searchOptions watch -> refresh records"),t["geofilter.polygon"]||!n["geofilter.polygon"]?n["geofilter.polygon"]||!t["geofilter.polygon"]?S(e.mapViewFilter?!1:!0):e.mapViewFilter=!0:e.mapViewFilter=!1))},!0),"aggregation"===e.colorBy&&e.$watch("colorByContext.parameters",function(){e.map&&S(!1)},!0),e.$watch("mapContext.location",function(){e.map&&S(!1)},!0);var S=function(t){var n=function(t){"aggregation"===e.colorBy?E():"value"===e.colorBy||t.count<200||e.map.getZoom()===e.map.getMaxZoom()?A():t.count<5e5?t.geometries.Point&&t.geometries.Point>t.count/2?w(t.count<=5e5):$():w(t.count<=5e5)},r={without_bbox:!t};t||(r["geofilter.polygon"]=ODS.GeoFilter.getBoundsAsPolygonParameter(e.map.getBounds())),jQuery.extend(r,e.staticSearchOptions,e.context.parameters),s.records.boundingbox(e.context,r).success(function(r){if(t)if(r.bbox.length>0){var a=e.map.getBounds();e.map.fitBounds([[r.bbox[1],r.bbox[0]],[r.bbox[3],r.bbox[2]]]);var i=e.map.getBounds();angular.equals(a,i)&&n(r)}else n(r);else n(r)})},D=function(t){var n=t.getSize();n.x>0&&n.y>0&&(e.mapContext.location=h.getLocationParameterFromMap(t),e.mapViewFilter&&(e.context.parameters["geofilter.polygon"]=ODS.GeoFilter.getBoundsAsPolygonParameter(t.getBounds())))},T=e.$watch("[context.dataset, colorByContext.dataset]",function(t,n){if(t[0]&&t[0].datasetid&&("aggregation"!==e.colorBy||t[1]&&t[1].datasetid)){"aggregation"===e.colorBy?d={context:e.colorByContext,localkey:e.colorByAggregationKey||e.colorByKey,remotekey:e.colorByKey,expr:e.colorByExpression,func:e.colorByFunction,ranges:e.colorByRanges.split(","),colors:e.colorByRangesColors.split(",")}:"value"===e.colorBy&&(d={field:e.colorByField,ranges:e.colorByRanges.split(","),colors:e.colorByRangesColors.split(",")}),t=t[0],e.context.parameters["geofilter.polygon"]?e.mapViewFilter=!0:e.mapViewFilter=!1,e.staticMap="true"===e.isStatic||"true"===e.context.parameters.static;var a=e.$watch("initMap",function(){e.initMap&&(a(),e.initMap(t,e.embedMode,u.basemaps,o,u.mapGeobox,e.mapContext.basemap,e.staticMap,u.mapPrependAttribution,u.language))});T(),e.staticSearchOptions={rows:e.recordLimit,dataset:e.context.dataset.datasetid,format:"json"};for(var i=0;i<t.fields.length;i++){var c=t.fields[i];if("geo_shape"===c.type){f=c.name;break}}var g={};t.extra_metas&&t.extra_metas.visualization&&(g=t.extra_metas.visualization),e.markerColor=g.map_marker_color||"#29398C",p=function(t,n){return new L.VectorMarker(t,{color:n||e.markerColor,icon:g.map_marker_picto||"icon-circle",marker:!g.map_marker_hidemarkershape})},l.log("map -> dataset watch -> refresh records");var m=e.$watch("map",function(t,n){if(t){e.$watch("mapViewFilter",function(t,n){t!==n&&(t?e.context.parameters["geofilter.polygon"]=ODS.GeoFilter.getBoundsAsPolygonParameter(e.map.getBounds()):e.context.parameters["geofilter.polygon"]&&delete e.context.parameters["geofilter.polygon"])});var a=function(t){var n=r.defer();if(e.context.parameters.mapviewport)"("===e.context.parameters.mapviewport.substring(0,1)&&(e.context.parameters.mapviewport=ODS.GeoFilter.getBoundsAsBboxParameter(ODS.GeoFilter.getPolygonParameterAsBounds(e.context.parameters.mapviewport))),n.resolve(ODS.GeoFilter.getBboxParameterAsBounds(e.context.parameters.mapviewport));else if(e.context.parameters["geofilter.polygon"])n.resolve(ODS.GeoFilter.getPolygonParameterAsBounds(e.context.parameters["geofilter.polygon"]));else{var a={};jQuery.extend(a,e.staticSearchOptions,e.context.parameters),s.records.boundingbox(e.context,a).success(function(e){e.count>0?n.resolve([[e.bbox[1],e.bbox[0]],[e.bbox[3],e.bbox[2]]]):n.resolve([[-60,-180],[80,180]])})}return n.promise};(function(){var n=r.defer();if(e.mapContext.location){l.log("Location found");var i=h.getCenterFromLocationParameter(e.mapContext.location),o=h.getZoomFromLocationParameter(e.mapContext.location);l.log(i,o),t.setView(i,o),S(!1),n.resolve()}else l.log("Use boundsRetrieval"),a(e.context.dataset).then(function(r){e.context.parameters.mapviewport&&(l.log("Deleted mapviewport"),delete e.context.parameters.mapviewport),l.log(r),t.fitBounds(r),n.resolve()});return n.promise})().then(function(){l.log("First onViewportMove"),D(e.map),e.map.on("moveend",function(t){D(t.target),e.$$phase||e.$root.$$phase||e.$apply()})}),u.basemaps.length>1&&e.map.on("baselayerchange",function(t){e.mapContext.basemap=t.layer.basemapId,e.$$phase||e.$root.$$phase||e.$apply()}),m()}})}},!0)}]}}])}(),function(){"use strict";var e=angular.module("ods-widgets");e.directive("odsMap",["URLSynchronizer","MapHelper","ModuleLazyLoader","ODSWidgetsConfig","MapLayerRenderer","translate","$q","$timeout",function(e,t,n,r,a,i,o,s){return{restrict:"EA",scope:{context:"=",syncToUrl:"@",syncToObject:"=",location:"@",basemap:"@",staticMap:"@",noRefit:"@",autoResize:"@",toolbarDrawing:"@",toolbarGeolocation:"@",toolbarFullscreen:"@"},transclude:!0,template:'<div class="odswidget odswidget-map">    <div class="odswidget odswidget-map__map"></div>    <div class="odswidget-overlay map odswidget-overlay--opaque" ng-show="initialLoading">        <ods-spinner></ods-spinner>    </div>    <div class="odswidget-map__loading" ng-show="loading">        <ods-spinner></ods-spinner>    </div>    <div ng-transclude></div></div>',link:function(l,u,c){function d(){var e=$(".odswidget-map__map");if("true"===l.autoResize&&e.length>0){var t=Math.max(200,$(window).height()-e.offset().top);e.height(t)}}var f=angular.element(u.children()[0]);c.id&&f.attr("id",c.id),c.style&&f.attr("style",c.style),c.class&&f.addClass(c.class);var p=l.staticMap&&"true"===l.staticMap.toLowerCase(),h=l.noRefit&&"true"===l.noRefit.toLowerCase(),g=!(l.toolbarDrawing&&"false"===l.toolbarDrawing.toLowerCase()),m=!(l.toolbarGeolocation&&"false"===l.toolbarGeolocation.toLowerCase()),v=!(l.toolbarFullscreen&&"false"===l.toolbarFullscreen.toLowerCase());if(c.context){var y=t.MapConfiguration.createLayerGroupConfiguration(),b=t.MapConfiguration.createLayerConfiguration();y.activeDatasets.push(b),l.mapConfig.layers.push(y);var x=l.$watch("context",function(e){b.context=e;var t=l.$watch("context.dataset",function(e){e&&(null!==b.context.dataset.getExtraMeta("visualization","map_marker_hidemarkershape")?b.marker=!b.context.dataset.getExtraMeta("visualization","map_marker_hidemarkershape"):b.marker=!0,b.color=b.context.dataset.getExtraMeta("visualization","map_marker_color")||"#C32D1C",b.picto=b.context.dataset.getExtraMeta("visualization","map_marker_picto")||(b.marker?"circle":"dot"),t())});x()})}"true"===l.autoResize&&($(window).on("resize",d),d()),l.initialLoading=!0,l.syncToObject?l.mapContext=l.syncToObject:l.mapContext={},"false"!==l.syncToUrl&&(e.addSynchronizedValue(l,"mapContext.location","location",!0),e.addSynchronizedValue(l,"mapContext.basemap","basemap")),l.location&&(l.mapContext.location=l.mapContext.location||l.location),l.basemap&&(l.mapContext.basemap=l.mapContext.basemap||l.basemap),n("leaflet").then(function(){var e={basemapsList:r.basemaps,worldCopyJump:!0,minZoom:2,basemap:l.mapContext.basemap,dragging:!p,keyboard:!p,prependAttribution:r.mapPrependAttribution,maxBounds:[[-90,-180],[90,180]],zoomControl:!1};p&&(e.doubleClickZoom=!1,e.scrollWheelZoom=!1),d();var n=new L.ODSMap(u.children()[0].children[0],e);if(n.addControl(new L.Control.Scale),p||n.addControl(new L.Control.Zoom({zoomInTitle:i("Zoom in"),zoomOutTitle:i("Zoom out")})),v)try{window.self===window.top&&n.addControl(new L.Control.Fullscreen({title:{false:i("View Fullscreen"),true:i("Exit Fullscreen")}}))}catch(e){}if(r.mapGeobox&&!p){var c=L.Control.geocoder({placeholder:i("Find a place..."),errorMessage:i("Nothing found."),geocoder:new L.Control.Geocoder.Nominatim({serviceUrl:"https://nominatim.openstreetmap.org/",geocodingQueryParams:{"accept-language":r.language||"en",polygon_geojson:!0}})});c.markGeocode=function(e){if(n.fitBounds(e.bbox),e.properties.geojson){var t=L.geoJson(e.properties.geojson,{style:function(){return{opacity:0,fillOpacity:.8,fillColor:"orange",className:"leaflet-geocoder-highlight"}}});n.addLayer(t),s(function(){u.addClass("geocoder-highlight-on")},0),s(function(){u.removeClass("geocoder-highlight-on"),n.removeLayer(t)},2500)}},n.addControl(c)}if(m&&!p&&n.addControl(new L.Control.Locate({maxZoom:18,strings:{title:i("Show me where I am"),popup:i("You are within {distance} {unit} from this point"),outsideMapBoundsMsg:i("You seem located outside the boundaries of the map")}})),l.drawnItems=new L.FeatureGroup,n.addLayer(l.drawnItems),g&&!p){L.drawLocal.draw.toolbar.buttons.circle=i("Draw a circle to filter on"),L.drawLocal.draw.toolbar.buttons.polygon=i("Draw a polygon to filter on"),L.drawLocal.draw.toolbar.buttons.rectangle=i("Draw a rectangle to filter on"),L.drawLocal.draw.toolbar.actions={title:i("Cancel area filter"),text:i("Cancel")},L.drawLocal.draw.toolbar.undo={title:i("Delete last point"),text:i("Delete last point")},L.drawLocal.edit.toolbar.buttons={edit:i("Edit area filter."),editDisabled:i("No area filter to edit."),remove:i("Delete area filter."),removeDisabled:i("No area filter to delete.")},L.drawLocal.edit.toolbar.actions={save:{title:i("Save changes."),text:i("Save")},cancel:{title:i("Cancel editing, discards all changes."),text:i("Cancel")}};var f=new L.Control.Draw({edit:{featureGroup:l.drawnItems},draw:{polyline:!1,marker:!1}});n.addControl(f)}l.map=n;(function(e){var n=o.defer();if(e){var a=t.getLocationStructure(e);l.map.setView(a.center,a.zoom),w().then(function(){b(!1)}),n.resolve()}else w().then(function(){t.retrieveBounds(t.MapConfiguration.getActiveContextList(l.mapConfig,!0)).then(function(e){if(e)l.map.fitBounds(e);else{var a=t.getLocationStructure(r.defaultMapLocation);l.map.setView(a.center,a.zoom)}b(!1),n.resolve()})});return n.promise})(l.mapContext.location).then(function(){l.initialLoading=!1,y(l.map),p||w().then(x),l.map.on("moveend",function(e){l.$apply(function(){y(e.target)})}),l.$watch("mapContext.location",function(e,t){e!==t&&b(!1,!0)}),l.$watch(function(){var e=0;return angular.forEach(l.mapConfig.layers,function(t){angular.forEach(t.activeDatasets,function(t){t.loading&&e++})}),e},function(e){l.loading=!!e}),l.$watch(function(){var e=[];return angular.forEach(t.MapConfiguration.getActiveContextList(l.mapConfig),function(t){e.push(t.parameters)}),e},function(e,t){e!==t&&(C(),b(!0))},!0)}),r.basemaps.length>1&&l.map.on("baselayerchange",function(e){l.$evalAsync('mapContext.basemap = "'+e.layer.basemapId+'"'),angular.forEach(l.mapConfig.layers,function(t){t.displayed&&angular.forEach(t.activeDatasets,function(t){"tiles"===t.clusterMode&&t.rendered&&(t.rendered.setMinZoom(e.layer.options.minZoom),t.rendered.setMaxZoom(e.layer.options.maxZoom))})})});var y=function(e){var n=e.getSize();n.x>0&&n.y>0&&(l.mapContext.location=t.getLocationParameter(e.getCenter(),e.getZoom()))},b=function(e,n){var r=function(e){var t=[];angular.forEach(l.mapConfig.layers,function(n){n.displayed?angular.forEach(n.activeDatasets,function(n){e&&!a.doesLayerRefreshOnLocationChange(n)||t.push(a.updateDataLayer(n,l.map))}):angular.forEach(n.activeDatasets,function(e){e.rendered&&(l.map.removeLayer(e.rendered),e.rendered=null)})}),o.all(t).then(function(){})};(e=!h&&e)?t.retrieveBounds(t.MapConfiguration.getActiveContextList(l.mapConfig,!0)).then(function(e){e&&e!==t.WORLD_BOUNDS?s(function(){var t=l.map.getBounds().toBBoxString();l.map.fitBounds(e),t===l.map.getBounds().toBBoxString()&&b(!1,!0)},0):r(n)}):r()},x=function(){l.map.on("draw:drawstart draw:editstart",function(){l.map.isDrawing=!0}),l.map.on("draw:drawstop draw:editstop",function(){l.map.isDrawing=!1});var e=function(e){e._path.setAttribute("style","cursor: pointer; pointer-events: auto;")},n=function(e){e._path.setAttribute("style","cursor: auto; pointer-events: none;")};l.map.on("draw:deletestart",function(){e(l.drawnItems.getLayers()[0])}),l.map.on("draw:deleteend",function(){n(l.drawnItems.getLayers()[0])}),l.map.on("draw:created",function(e){var t=e.layer;l.drawnItems.getLayers().length>0&&l.drawnItems.removeLayer(l.drawnItems.getLayers()[0]),l.drawnItems.addLayer(t),r(t,e.layerType),l.$apply()}),l.map.on("draw:edited",function(e){var t=e.layers.getLayers()[0],n=a(t);r(t,n),l.$apply()}),l.map.on("draw:deleted",function(){delete l.mapConfig.drawnArea,l.$apply()});var r=function(e,t){if("circle"===t){var n=e.getRadius(),r=e.getLatLng();l.mapConfig.drawnArea={shape:"circle",coordinates:r.lat+","+r.lng+","+n}}else{var a=e.toGeoJSON(),i=ODS.GeoFilter.getGeoJSONPolygonAsPolygonParameter(a.geometry);l.mapConfig.drawnArea={shape:"polygon",coordinates:i}}},a=function(e){return angular.isDefined(e.getRadius)?"circle":"polygon"},i={color:"#2ca25f",fillOpacity:.2,opacity:.8,clickable:!0};l.$watch("mapConfig.drawnArea",function(e){l.drawnItems.getLayers().length>0&&l.drawnItems.removeLayer(l.drawnItems.getLayers()[0]);var r;if(e){if("polygon"===e.shape){var a=ODS.GeoFilter.getPolygonParameterAsGeoJSON(e.coordinates),o=a.coordinates[0];o.splice(a.coordinates[0].length-1,1);var s,u,c;for(s=0;s<o.length;s++)c=(u=o[s])[0],u[0]=u[1],u[1]=c;r=4===o.length&&o[0][0]===o[3][0]&&o[1][0]===o[2][0]&&o[0][1]===o[1][1]&&o[2][1]===o[3][1]?new L.Rectangle(o,i):new L.Polygon(o,i)}else if("circle"===e.shape){var d=e.coordinates.split(","),f=d[0],p=d[1],h=d[2];r=new L.Circle([f,p],h,i)}r&&(l.drawnItems.addLayer(r),n(l.drawnItems.getLayers()[0]))}angular.forEach(t.MapConfiguration.getActiveContextList(l.mapConfig,!0),function(t){e?"circle"===e.shape?(t.parameters["geofilter.distance"]=e.coordinates,delete t.parameters["geofilter.polygon"]):"polygon"===e.shape&&(t.parameters["geofilter.polygon"]=e.coordinates,delete t.parameters["geofilter.distance"]):(delete t.parameters["geofilter.polygon"],delete t.parameters["geofilter.distance"])})},!0)}});var w=function(){var e=o.defer(),n=t.MapConfiguration.getActiveContextList(l.mapConfig).map(function(e){return e.wait()});return o.all(n).then(function(){C(),e.resolve()}),e.promise},C=function(){var e,n;angular.forEach(t.MapConfiguration.getActiveContextList(l.mapConfig,!0),function(t){angular.isUndefined(e)&&angular.isUndefined(e)?(e=t.parameters["geofilter.polygon"],n=t.parameters["geofilter.distance"]):(e!==t.parameters["geofilter.polygon"]&&(e=null),n!==t.parameters["geofilter.distance"]&&(n=null))}),l.mapConfig.drawnArea=e?{shape:"polygon",coordinates:e}:n?{shape:"circle",coordinates:n}:{}}},controller:["$scope",function(e){e.mapConfig={layers:[]},this.registerLayer=function(n){var r=t.MapConfiguration.createLayerGroupConfiguration();return r.activeDatasets.push(n),e.mapConfig.layers.push(r),r},this.registerLayerGroup=function(t){e.mapConfig.layers.push(t)}}]}}]),e.directive("odsMapLayerGroup",function(){return{restrict:"EA",scope:{},require:"^odsMap",link:function(e,t,n,r){r.registerLayerGroup(e.group)},controller:["$scope",function(e){e.group={activeDatasets:[]},this.registerLayer=function(t){return e.group.activeDatasets.push(t),e.group}}]}}),e.directive("odsMapLayer",["MapHelper",function(e){return{restrict:"EA",scope:{context:"=",showIf:"=",color:"@",borderColor:"@",opacity:"@",colorScale:"@",colorRanges:"@",colorByField:"@",picto:"@",showMarker:"@",display:"@",function:"@",expression:"@",tooltipSort:"@",hoverField:"@",refineOnClickContext:"=",joinContext:"=",localKey:"@",remoteKey:"@"},template:function(e){var t="";return e.contents().wrapAll("<div>"),e.contents().length>0&&e.contents().html().trim().length>0&&(e.contents().wrapAll("<div>"),t=e.children().html()),'<div tooltiptemplate="'+t.replace(/"/g,"&quot;")+'"></div>'},require:["?^odsMapLayerGroup","^odsMap"],link:function(t,n,r,a){var i,o=a[0],s=a[1],l=angular.element(n.children()[0]).attr("tooltiptemplate");if(t.color)i=t.color;else if(t.colorScale)i={type:"scale",scale:t.colorScale};else if(t.colorRanges){var u=t.colorRanges.split(";");i={type:"range",ranges:u.filter(function(e,t){return t%2==1}),colors:u.filter(function(e,t){return t%2==0}),field:t.colorByField}}var c,d={color:i,borderColor:t.borderColor,opacity:t.opacity,picto:t.picto,display:t.display,function:t.function,expression:t.expression,localKey:t.localKey,remoteKey:t.remoteKey,tooltipSort:t.tooltipSort,hoverField:t.hoverField},f=e.MapConfiguration.createLayerConfiguration(l,d);c=o?o.registerLayer(f):s.registerLayer(f),r.showIf&&t.$watch("showIf",function(e,t){c.displayed=e});var p=t.$watch("context",function(e){e&&(f.context=e,e.wait().then(function(){t.showMarker?f.marker="true"===t.showMarker.toLowerCase():null!==f.context.dataset.getExtraMeta("visualization","map_marker_hidemarkershape")?f.marker=!f.context.dataset.getExtraMeta("visualization","map_marker_hidemarkershape"):f.marker=!0,f.color=f.color||f.context.dataset.getExtraMeta("visualization","map_marker_color")||"#C32D1C",f.picto=f.picto||f.context.dataset.getExtraMeta("visualization","map_marker_picto")||(f.marker?"circle":"dot")}),p())}),h=t.$watch("joinContext",function(e){e&&(f.joinContext=e,h())}),g=t.$watch("refineOnClickContext",function(e){if(angular.isArray(e)){var t=!0;if(angular.forEach(e,function(e){t=t&&angular.isDefined(e)}),!t)return}else if(!e)return;f.refineOnClick=[];var n=angular.isArray(e)&&e||[e];angular.forEach(n,function(e){var t=!1,n="refineOnClick"+ODS.StringUtils.capitalize(e.name);angular.isDefined(r[n+"ReplaceRefine"])?"false"!==r[n+"ReplaceRefine"]&&(t=!0):angular.isDefined(r.refineOnClickReplaceRefine)&&"false"!==r.refineOnClickReplaceRefine&&(t=!0),f.refineOnClick.push({context:e,mapField:r[n+"MapField"]||r.refineOnClickMapField,contextField:r[n+"ContextField"]||r.refineOnClickContextField,replaceRefine:t}),g()})})},controller:["$scope",function(e){}]}}]),e.directive("odsMapTooltip",["$compile","$templateCache",function(e,t){return{restrict:"E",transclude:!0,template:'<div class="odswidget-map-tooltip">   <ods-spinner class="odswidget-map-tooltip__spinner" ng-hide="records"></ods-spinner>   <h2 ng-show="records.length > 1" class="odswidget-map-tooltip__scroll-control ng-leaflet-tooltip-cloak">       <i class="odswidget-map-tooltip__scroll-left fa fa-chevron-left" ng-click="moveIndex(-1)"></i>       <span ng-bind="(selectedIndex+1)+\'/\'+records.length" ng-click="moveIndex(1)"></span>       <i class="odswidget-map-tooltip__scroll-right fa fa-chevron-right" ng-click="moveIndex(1)"></i>   </h2>   <div class="ng-leaflet-tooltip-cloak odswidget-map-tooltip__limited-results-warning" ng-show="records && records.length == RECORD_LIMIT" translate>      (limited to the first {{RECORD_LIMIT}} records)   </div>   <div ng-repeat="record in records" ng-show="$index == selectedIndex" class="odswidget-map-tooltip__record">       <div ng-if="!template" ng-include src="\'default-tooltip\'"></div>       <div ng-if="template" ng-include src="\'custom-tooltip-\'+context.dataset.datasetid"></div>   </div></div>',scope:{shape:"=",context:"=",recordid:"=",map:"=",template:"@",gridData:"=",geoDigest:"@",tooltipSort:"@"},replace:!0,link:function(e,n,r){var a=function(t){t.popup._content===n[0]&&(e.selectedShapeLayer&&e.map.removeLayer(e.selectedShapeLayer),e.map.off("popupclose",a),e.$destroy())};e.map.on("popupclose",a),e.unCloak=function(){jQuery(".ng-leaflet-tooltip-cloak",n).removeClass("ng-leaflet-tooltip-cloak")},r.template&&""!==r.template?t.put("custom-tooltip-"+e.context.dataset.datasetid,r.template):t.put("default-tooltip",'<div class="infoPaneLayout"><h2 class="odswidget-map-tooltip__header" ng-show="!!getTitle(record)" ng-bind="getTitle(record)"></h2><dl class="odswidget-map-tooltip__record-values">    <dt ng-repeat-start="field in context.dataset.fields|fieldsForVisualization:\'map\'|fieldsFilter:context.dataset.extra_metas.visualization.map_tooltip_fields"         ng-show="record.fields[field.name]|isDefined"        class="odswidget-map-tooltip__field-name">        {{ field.label }}    </dt>    <dd ng-repeat-end         ng-switch="field.type"         ng-show="record.fields[field.name]|isDefined"        class="odswidget-map-tooltip__field-value">        <span ng-switch-when="geo_point_2d">            <ods-geotooltip width="300" height="300" coords="record.fields[field.name]">{{ record.fields|formatFieldValue:field }}</ods-geotooltip>        </span>        <span ng-switch-when="geo_shape">            <ods-geotooltip width="300" height="300" geojson="record.fields[field.name]">{{ record.fields|formatFieldValue:field }}</ods-geotooltip>        </span>        <span ng-switch-when="file">            <div ng-if="!context.dataset.isFieldAnnotated(field, \'has_thumbnails\')" ng-bind-html="record.fields|formatFieldValue:field"></div>            <div ng-if="context.dataset.isFieldAnnotated(field, \'has_thumbnails\')" ng-bind-html="record.fields[field.name]|displayImageValue:context.dataset.datasetid" style="text-align: center;"></div>        </span>        <span ng-switch-default title="{{record.fields|formatFieldValue:field}}" ng-bind-html="record.fields|formatFieldValue:field|imagify|videoify|prettyText|nofollow"></span>    </dd></dl></div>')},controller:["$scope","$filter","ODSAPI",function(e,t,n){e.RECORD_LIMIT=100,e.records=[],e.selectedIndex=0;var r=e.tooltipSort;!r&&e.context.dataset.getExtraMeta("visualization","map_tooltip_sort_field")&&(r=(e.context.dataset.getExtraMeta("visualization","map_tooltip_sort_direction")||"")+e.context.dataset.getExtraMeta("visualization","map_tooltip_sort_field")),e.moveIndex=function(t){var n=(e.selectedIndex+t)%e.records.length;n<0&&(n=e.records.length+n),e.selectedIndex=n};var a=function(){function t(t){if(t.length>0){e.selectedIndex=0,e.records=t,e.unCloak();var n,r=e.context.dataset.getFieldsForType("geo_shape");if(r.length&&(n=r[0].name),n&&e.gridData&&("Polygon"===e.gridData["ods:geo_type"]||"LineString"===e.gridData["ods:geo_type"]||"MultiPolygon"===e.gridData["ods:geo_type"]||"MultiLineString"===e.gridData["ods:geo_type"])){var a=t[0];if(a.fields[n]){var i=a.fields[n];"Point"!==i.type&&(e.selectedShapeLayer=L.geoJson(i,{fill:!1,color:"#CC0000",opacity:1,dashArray:[5],weight:2}),e.map.addLayer(e.selectedShapeLayer))}}}else e.map.closePopup()}var a={format:"json",rows:e.RECORD_LIMIT},i=null;e.shape&&(i=e.shape.type),e.recordid&&"Point"!==i?a.q="recordid:'"+e.recordid+"'":e.geoDigest?a.geo_digest=e.geoDigest:e.gridData?null!==e.gridData["ods:geo_grid"]?a.geo_grid=e.gridData["ods:geo_grid"]:a.geo_digest=e.gridData["ods:geo_digest"]:e.shape&&ODS.GeoFilter.addGeoFilterFromSpatialObject(a,e.shape);var o={};angular.extend(o,e.context.parameters,a),r?(o.sort=r,n.records.search(e.context,o).success(function(e){t(e.records)})):n.records.download(e.context,o).success(t)};e.$watch("searchOptions",function(){a()}),e.$apply(),e.getTitle=function(t){if(e.context.dataset.extra_metas&&e.context.dataset.extra_metas.visualization&&e.context.dataset.extra_metas.visualization.map_tooltip_title){var n=e.context.dataset.extra_metas.visualization.map_tooltip_title;if(angular.isDefined(t.fields[n])&&""!==t.fields[n])return t.fields[n]}return null}}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsMostPopularDatasets",["ODSAPI",function(e){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-most-popular-datasets"><ul>   <li class="no-data" ng-hide="datasets" translate>No data available yet</li>   <li ng-repeat="dataset in datasets" ng-if="datasets">       <ods-theme-picto theme="{{dataset.metas.theme|firstValue}}"></ods-theme-picto>       <div class="dataset-details">           <div class="title"><a ng-href="{{context.domainUrl}}/explore/dataset/{{dataset.datasetid}}/" target="_self">{{ dataset.metas.title }}</a></div>           <div class="count"><i class="icon-download-alt"></i> {{ dataset.extra_metas.explore.download_count }} '+"<span ng-pluralize count=\"dataset.extra_metas.explore.download_count\" translate=\"when\" when=\"{'0': 'download', '1': 'download', 'other': 'downloads'}\"></span></div>       </div>   </li></ul></div>",scope:{context:"="},controller:["$scope",function(t){var n=function(){e.datasets.search(t.context,{rows:5,sort:"explore.download_count",extrametas:!0}).success(function(e){t.datasets=e.datasets})};t.$watch("context",function(){n()})}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsMostUsedThemes",["ODSAPI",function(e){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-most-used-themes"><ul>   <li class="no-data" ng-hide="themes" translate>No data available yet</li>   <li ng-repeat="theme in themes" ng-if="themes">       <div class="dataset-details">           <div class="name"><a ng-href="{{ context.domainUrl }}/explore/?refine.theme={{ theme.path }}" target="_self">{{ theme.name }}</a></div>           <div class="count"><i class="icon-table"></i> <span translate>Used by</span> {{ theme.count }} '+"<span ng-pluralize count=\"theme.count\" translate=\"when\" when=\"{'0': 'dataset', '1': 'dataset', 'other': 'datasets'}\"></span></div>       </div>   </li></ul></div>",scope:{context:"="},controller:["$scope",function(t){var n=function(){e.datasets.facets(t.context,"theme").success(function(e){e.facet_groups&&(t.themes=e.facet_groups[0].facets.slice(0,5))})};t.$watch("context",function(){n()})}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsPaginationBlock",["$location",function(e){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-pagination" ng-show="pages.length > 1">    <ul class="odswidget-pagination__page-list">        <li class="odswidget-pagination__page" ng-repeat="page in pages">            <a class="odswidget-pagination__page-link"                ng-class="{\'odswidget-pagination__page-link--active\': page.start == (context.parameters.start||0)}"                ng-attr-rel="{{nofollow?\'nofollow\':\'\'}}"               ng-click="click($event, page.start)"                href="?start={{ page.start }}"                rel="nofollow">{{ page.label }}</a>        </li>    </ul></div>',scope:{context:"=",perPage:"@",nofollow:"@"},controller:["$scope","$anchorScroll",function(t,n){t.location=e,t.pages=[],t.perPage=t.perPage||10,t.click=function(e,n){e.preventDefault(),t.context.parameters.start=n};var r=function(){if(0!==t.context.nhits){var e,n=Math.max(1,Math.floor((t.context.nhits-1)/t.perPage)+1),r=[];if(n<=8)for(e=1;e<=n;e++)r.push({label:e,start:(e-1)*t.perPage});else{var a;if((a=t.context.parameters.start?Math.floor(t.context.parameters.start/t.perPage)+1:1)<=5){for(e=1;e<=8;e++)r.push({label:e,start:(e-1)*t.perPage});r.push({label:">>",start:(n-1)*t.perPage})}else if(a>=n-4)for(r.push({label:"<<",start:0}),e=n-7;e<=n;e++)r.push({label:e,start:(e-1)*t.perPage});else{for(r.push({label:"<<",start:0}),e=a-3;e<=a+3;e++)r.push({label:e,start:(e-1)*t.perPage});r.push({label:">>",start:(n-1)*t.perPage})}}t.pages=r}else t.pages=[]},a=t.$watch("context",function(e,i){e&&(t.$watch("context.nhits",function(e,n){void 0!==t.context.nhits&&t.perPage&&r()}),t.$watch("perPage",function(e,n){t.context.nhits&&t.perPage&&r()}),t.$watch("context.parameters.start",function(e,a){t.context.nhits&&t.perPage&&r(),n()}),a())})}]}}])}(),function(){"use strict";var e=angular.module("ods-widgets");e.directive("odsPicto",["SVGInliner","$http","$document",function(e,t,n){return{restrict:"E",replace:!0,scope:{url:"=",color:"=",classes:"="},template:'<div class="odswidget odswidget-picto {{ classes }}"></div>',link:function(t,n){var r;t.$watch("[url, color]",function(a){if(a[0]){if(Modernizr&&!Modernizr.svg)return;r&&n.empty(),r=e.getElement(t.url,t.color),t.color||r.addClass("colorless"),n.append(r)}},!0)}}}]),e.directive("odsThemePicto",["ODSWidgetsConfig","$compile",function(e,t){return{restrict:"E",replace:!0,scope:{theme:"@"},template:"",link:function(n,r){n.originalClasses=r.attr("class").replace("ng-isolate-scope","").trim();var a=!1;e.themes[n.theme]?n.themeConfig=e.themes[n.theme]:(n.themeConfig=e.themes.default,a=!0),n.getTheme=function(){return a?"default":n.theme},n.themeConfig&&r.replaceWith(angular.element(t('<ods-picto url="themeConfig.img" color="themeConfig.color" classes="originalClasses + \' odswidget-theme-picto theme-\' + (getTheme()|themeSlug) "></ods-picto>')(n)))}}}]),e.directive("odsMapPicto",["ODSWidgetsConfig","PictoHelper","$compile",function(e,t,n){return{restrict:"E",replace:!0,scope:{name:"@",color:"@"},template:"",link:function(e,r){e.originalClasses=r.attr("class").replace("ng-isolate-scope","").trim();e.$watch("[name, color]",function(){e.pictoUrl=t.mapPictoToURL(e.name),e.pictoUrl&&r.replaceWith(angular.element(n('<ods-picto url="pictoUrl" color="color" classes="originalClasses + \' odswidget-map-picto\'"></ods-picto>')(e)))},!0)}}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsResultEnumerator",["ODSAPI",function(e){return{restrict:"E",replace:!0,transclude:!0,scope:{context:"=",max:"@?",showHitsCounter:"@?",showPagination:"@?"},template:'<div class="odswidget odswidget-result-enumerator"><div ods-results="items" ods-results-context="context" ods-results-max="{{maxHits}}"><div ng-if="loading"><ods-spinner class="odswidget-spinner--large"></ods-spinner></div><div ng-if="!loading && !items.length" class="odswidget-result-enumerator__no-results-message" translate>No results</div><div ng-if="!loading && items.length && hitsCounter" class="odswidget-result-enumerator__results-count">{{context.nhits}} <span translate>results</span></div><div ng-repeat="item in items" inject class="odswidget-result-enumerator__item"></div></div><ods-pagination-block ng-if="pagination" context="context" per-page="{{maxHits}}"></ods-pagination-block></div>',controller:["$scope",function(e){e.maxHits=e.max||10,e.hitsCounter=angular.isString(e.showHitsCounter)&&"true"===e.showHitsCounter.toLowerCase(),e.pagination=angular.isString(e.showPagination)&&"true"===e.showPagination.toLowerCase()}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsResults",["ODSAPI",function(e){return{restrict:"A",scope:!0,priority:1001,controller:["$scope","$attrs",function(t,n){t.$watch(n.odsResultsContext,function(r){var a=angular.extend({},r.parameters,{rows:n.odsResultsMax}),i=n.odsResults||"results";t.loading=!0,"catalog"===r.type?(angular.extend(a,{extrametas:"true",interopmetas:"true"}),e.datasets.search(r,a).success(function(e){t[i]=e.datasets,r.nhits=e.nhits,t.loading=!1}).error(function(){t.loading=!1})):"dataset"===r.type&&r.dataset&&e.records.search(r,a).success(function(e){t[i]=e.records,r.nhits=e.nhits,t.loading=!1}).error(function(){t.loading=!1})},!0)}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsReuses",["ODSAPI",function(e){return{restrict:"E",replace:!0,transclude:!0,template:'<div class="odswidget odswidget-reuses">  <div infinite-scroll="loadMore()" infinite-scroll-distance="1">      <div class="odswidget-reuses__reuse" ng-repeat="reuse in reuses" ods-full-click inject>          <h2 class="odswidget-reuses__reuse-title">{{ reuse.title }}             <a href="/explore/dataset/{{ reuse.dataset.id }}/?tab=metas" class="odswidget-reuses__reuse-dataset-link" target="_self"><span translate>From dataset:</span> {{ reuse.dataset.title }}</a>          </h2>          <div class="odswidget-reuses__reuse-infos">              <div class="odswidget-reuses__reuse-thumbnail" ng-class="{\'odswidget-reuses__reuse-thumbnail--no-thumbnail\': !reuse.thumbnail}">                  <a ng-show="reuse.thumbnail" href="{{ reuse.url }}" ods-main-click title="{{ reuse.title }}" target="_blank"><img class="odswidget-reuses__reuse-thumbnail-image" ng-src="{{ reuse.thumbnail }}" /></a>                  <i ng-hide="reuse.thumbnail" class="fa fa-ban odswidget-reuses__reuse-thumbnail-image--no-thumbnail"></i>              </div>              <div class="odswidget-reuses__reuse-description" ng-bind-html="reuse.description|prettyText|safenewlines"></div>          </div>          <div class="odswidget-reuses__reuse-author">              <strong ng-if="reuse.user.first_name || reuse.user.last_name">{{ reuse.user.first_name }} {{ reuse.user.last_name }}</strong>              <strong ng-if="!reuse.user.first_name && !reuse.user.last_name">{{ reuse.user.username }}</strong>              <i class="fa fa-calendar odswidget-reuses__creation-icon"></i> {{ reuse.created_at|moment:\'LLL\' }}          </div>      </div> </div></div>',scope:{context:"="},controller:["$scope",function(t){var n=!1,r=!1,a=0,i=1;t.reuses=[],t.loadMore=function(){if(t.reuses.length&&!n&&!r){r=!0;var o=20*i;e.reuses(t.context,{rows:20,start:o}).success(function(e){t.reuses=t.reuses.concat(e.reuses),n=20*(i+1)>=a,i++,r=!1}).error(function(){r=!1})}};var o=function(){r=!0,e.reuses(t.context,{rows:20}).success(function(e){t.reuses=e.reuses,n=20>=e.nhits,a=e.nhits,r=!1}).error(function(e){r=!1})};t.$watch("context",function(){o()})}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsSearchbox",function(){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-searchbox"><form method="GET" action="{{ actionUrl }}" ng-if="actionUrl"><input class="odswidget-searchbox__box" name="q" type="text" placeholder="{{placeholder|translate}}"></form></div>',scope:{placeholder:"@",context:"="},controller:["$scope","$sce",function(e,t){e.actionUrl="/explore/";var n=e.$watch("context",function(r){r&&(e.actionUrl=t.trustAsResourceUrl(e.context.domainUrl+e.actionUrl),n())})}]}})}(),function(){"use strict";angular.module("ods-widgets").directive("odsSocialButtons",[function(){return{restrict:"E",scope:{addthisPubid:"@",buttons:"@?"},replace:!0,template:'<div class="odswidget-social-buttons"      ng-init="displayButtons=false"     ng-mouseenter="displayButtons=true" ng-mouseleave="displayButtons=false">    <div class="odswidget-social-buttons__header">        <span translate>Share</span>        <i class="fa fa-angle-down"></i>    </div>    <div class="odswidget-social-buttons__buttons"          ng-class="{\'odswidget-social-buttons__buttons--open\': displayButtons}">        <div class="addthis_toolbox addthis_counter_style">            <a ng-if="selectedButtons.indexOf(\'facebook\') > -1"                class="addthis_button_facebook_like" fb:like:layout="box_count"></a>            <a ng-if="selectedButtons.indexOf(\'twitter\') > -1"                class="addthis_button_tweet" tw:count="vertical"></a>            <a ng-if="selectedButtons.indexOf(\'google-plus\') > -1"                class="addthis_button_google_plusone" g:plusone:size="tall"></a>        </div>    </div>    <script type="text/javascript">        var addthis_config = addthis_config || {};        addthis_config.pubid = "{{ addthisPubid }}";    <\/script>    <script type="text/javascript" src=""><\/script></div>',link:function(e){var t=["google-plus","facebook","twitter"];if(e.selectedButtons=t,angular.isDefined(e.buttons)){var n=e.buttons.split(",").map(function(e){return e.trim()});e.selectedButtons=[],angular.forEach(n,function(n){t.indexOf(n)>-1&&e.selectedButtons.push(n)})}var r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="//s7.addthis.com/js/300/addthis_widget.js#domready=1",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(r)}}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsSpinner",["ODSWidgetsConfig",function(e){return{restrict:"E",replace:!0,template:function(){return Modernizr&&Modernizr.cssanimations&&Modernizr.svg?'<img src="'+e.basePath+'src/img/spinner.gif"      class="odswidget-spinner odswidget-spinner--gif"/>':'<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg" version="1.1"     class="odswidget-spinner odswidget-spinner--svg">    <rect x="0" y="0" width="30" height="30" class="odswidget-spinner__cell-11"></rect>    <rect x="35" y="0" width="30" height="30" class="odswidget-spinner__cell-12"></rect>    <rect x="70" y="0" width="30" height="30" class="odswidget-spinner__cell-13"></rect>    <rect x="0" y="35" width="30" height="30" class="odswidget-spinner__cell-21"></rect>    <rect x="35" y="35" width="30" height="30" class="odswidget-spinner__cell-22"></rect>    <rect x="70" y="35" width="30" height="30" class="odswidget-spinner__cell-23"></rect>    <rect x="0" y="70" width="30" height="30" class="odswidget-spinner__cell-31"></rect>    <rect x="35" y="70" width="30" height="30" class="odswidget-spinner__cell-32"></rect>    <rect x="70" y="70" width="30" height="30" class="odswidget-spinner__cell-33"></rect></svg>'}}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsTable",["ODSWidgetsConfig","$sce",function(e,t){return{restrict:"E",scope:{context:"=",displayedFields:"@",sort:"@",datasetFeedback:"@"},replace:!0,transclude:!0,template:'<div class="records records-table odswidget odswidget-table"> <div class="odswidget-table__header" ng-show="records.length">     <table class="odswidget-table__internal-table">         <thead class="odswidget-table__internal-header-table-header">         <tr>             <th class="odswidget-table__header-cell odswidget-table__header-cell--spinner"><div class="odswidget-table__cell-container"><ods-spinner ng-show="fetching" class="odswidget-spinner--large"></ods-spinner></div></th>             <th class="odswidget-table__header-cell" ng-repeat="field in context.dataset.fields|fieldsForVisualization:\'table\'|fieldsFilter:displayedFieldsArray"                 title="{{ field.description }}"                 ng-click="toggleSort(field)"                 >                 <div class="odswidget-table__header-cell-container">                     <span ng-bind="field.label"></span>                     <div ng-class="{\'odswidget-table__sort-icons\': true, \'odswidget-table__sort-icons--active\': field.name == context.parameters.sort || \'-\'+field.name == context.parameters.sort}" ng-show="isFieldSortable(field)">                         <i class="fa fa-chevron-up odswidget-table__sort-icons__up" ng-hide="isAscendingSorted(field)"></i>                         <i class="fa fa-chevron-down odswidget-table__sort-icons__down" ng-hide="isDescendingSorted(field)"></i>                     </div>                 </div>             </th>         </tr>         </thead>     </table> </div> <div class="odswidget-table__records">     <table class="odswidget-table__internal-table" infinite-scroll="loadMore()" infinite-scroll-distance="1" infinite-scroll-disabled="fetching">         <thead class="odswidget-table__internal-table-header">             <tr>                 <th class="odswidget-table__header-cell odswidget-table__header-cell--spinner"><div class="odswidget-table__cell-container"><ods-spinner ng-show="fetching" class="odswidget-spinner--large"></ods-spinner></div></th>                 <th class="odswidget-table__header-cell" ng-repeat="field in context.dataset.fields|fieldsForVisualization:\'table\'|fieldsFilter:displayedFieldsArray"                     title="{{ field.name }}">                     <div class="odswidget-table__cell-container">                         <span ng-bind="field.label"></span>                         <div class="odswidget-table__sort-icons" ng-show="isFieldSortable(field)">                             <i class="fa fa-chevron-up odswidget-table__sort-icons__up"></i>                             <i class="fa fa-chevron-down odswidget-table__sort-icons__down"></i>                         </div>                     </div>                 </th>             </tr>         </thead>         <tbody class="odswidget-table__records-tbody">         </tbody>     </table> </div> <div ng-if="displayDatasetFeedback" class="table-feedback-new"><a ods-dataset-feedback ods-dataset-feedback-dataset="context.dataset"><i class="icon-comment"></i> <span translate>Suggest a new record</span></a></div> <div class="odswidget-overlay" ng-hide="fetching || records"><span class="odswidget-overlay__message" translate>No results</span></div> <div class="odswidget-overlay" ng-hide="(!fetching || records) && !working"><ods-spinner></ods-spinner></div></div>',controller:["$scope","$element","$timeout","$document","$window","ODSAPI","DebugLogger","$filter","$http","$compile","$transclude","$q",function(e,t,n,r,a,i,o,s,l,u,c,d){e.displayedFieldsArray=null,e.displayDatasetFeedback=!1,e.page=0,e.resultsPerPage=40,e.fetching=!1,e.records=[],e.working=!0,e.layout=[],e.done=!1;var f,p,h=t.find(".odswidget-table__header"),g=t.find(".odswidget-table__records-tbody"),m=h.offset().left,v=0,y=0,b=!1,x=0,w=0,C=0,_=0,E=Math.random().toString(36).substring(7),A="table-"+E,k="stylesheet-"+E,S=[],D=function(t){e.fetching=!0;var n,r={};if(t?(e.done=!1,e.page=0,e.records=[],n=0,S.length&&(S.forEach(function(e){e.resolve()}),S.splice(0,S.length))):n=++e.page*e.resultsPerPage,jQuery.extend(r,e.staticSearchOptions,e.context.parameters,{start:n}),e.displayedFieldsArray&&e.context.dataset.fields.length>e.displayedFieldsArray.length&&jQuery.extend(r,{fields:e.displayedFieldsArray.join(",")}),r.sort){var a=r.sort.replace("-","");e.context.dataset.getField(a)||delete r.sort}var o=d.defer();S.push(o),i.records.search(e.context,r,o.promise).success(function(n,r,a,i){n.records.length||(e.working=!1),e.records=t?n.records:e.records.concat(n.records),e.nhits=n.nhits,e.error="",e.fetching=!1,e.done=(e.page+1)*e.resultsPerPage>=n.nhits,S.splice(S.indexOf(o),1)}).error(function(t,n,r,a){t&&(e.error=t.error),S.splice(S.indexOf(o),1),e.fetching=!1})};e.loadMore=function(){e.fetching||e.done||!e.staticSearchOptions||D(!1)},e.isFieldSortable=function(e){return ODS.DatasetUtils.isFieldSortable(e)},e.isAscendingSorted=function(t){return"text"===t.type?t.name===e.context.parameters.sort:"-"+t.name===e.context.parameters.sort},e.isDescendingSorted=function(t){return"text"===t.type?"-"+t.name===e.context.parameters.sort:t.name===e.context.parameters.sort},e.toggleSort=function(t){if(e.isFieldSortable(t)){if(e.context.parameters.sort==t.name)return void(e.context.parameters.sort="-"+t.name);if(e.context.parameters.sort=="-"+t.name)return void(e.context.parameters.sort=t.name);e.context.parameters.sort="text"===t.type?t.name:"-"+t.name}else delete e.context.parameters.sort};var T=!1;c(function(e){e.contents().wrapAll("<div>"),T=e.contents().length>0&&e.contents().html().trim().length>0});var F=function(n,r,a){var i,o,l=r[n];if(i=document.createElement("tr"),i.className="odswidget-table__internal-table-row record-"+n,"end"===a){var d=t.find(".js-placeholder-bottom")[0];d.parentNode.insertBefore(i,d)}else{var p=t.find(".js-placeholder-top")[0];p.parentNode.insertBefore(i,p.nextSibling)}(o=document.createElement("td")).className="odswidget-table__cell";var h=document.createElement("div");if(h.className="odswidget-table__cell-container",e.displayDatasetFeedback){var g=e.$new(!0);g.record=l,g.dataset=e.context.dataset,h.appendChild(u('<i class="fa fa-comment table-feedback-icon" ods-dataset-feedback ods-dataset-feedback-record="record" ods-dataset-feedback-dataset="dataset" ods-tooltip="Suggest changes for this record" translate="ods-tooltip"></i>')(g)[0])}h.appendChild(document.createTextNode(n+1)),o.appendChild(h),i.appendChild(o);for(var m=0;m<f.length;m++){var v=f[m],y=s("formatFieldValue")(l.fields,v);(o=document.createElement("td")).className="odswidget-table__cell",i.appendChild(o),(h=document.createElement("div")).className="odswidget-table__cell-container",o.appendChild(h);var b,x;T?((b=e.$new(!0)).record=l,b.currentField=v.name,b.currentValue=l.fields[v.name],b.currentFormattedValue=y,x=u("<div inject></div>",c)(b)[0]):((b=e.$new(!1)).recordFields=l.fields[v.name],v&&"geo_point_2d"===v.type?(b.fieldValue=y,window.ie8?((x=document.createElement("span")).title=y,x.innerHTML=y):x=u('<ods-geotooltip width="300" height="300" coords="recordFields">'+y+"</ods-geotooltip>")(b)[0]):v&&"geo_shape"===v.type?(b.fieldValue=s("truncate")(y),window.ie8?((x=document.createElement("span")).title=y,x.innerHTML=y):x=u('<ods-geotooltip width="300" height="300" geojson="recordFields">'+y+"</ods-geotooltip>")(b)[0]):v&&"file"===v.type?((x=document.createElement("span")).title=l.fields[v.name]?l.fields[v.name].filename:"",x.innerHTML=s("nofollow")(s("prettyText")(y))):((x=document.createElement("span")).title=y,x.innerHTML=s("nofollow")(s("prettyText")(y)))),h.appendChild(x)}return i},M=function(e){var n=t[0].getElementsByClassName("record-"+e)[0];n&&n.parentNode.removeChild(n)},L=function(e){var t;return angular.forEach(e.classList,function(e){e.startsWith("record-")&&(t=parseInt(e.substr(7),10))}),t},O=function(){var n=t.find(".odswidget-table__records")[0].offsetHeight,r=t.find(".odswidget-table__records")[0].scrollTop,a=g.find("tr").eq(1).height(),i=t.find(".js-placeholder-top")[0],o=t.find(".js-placeholder-bottom")[0];a?(C=Math.max(Math.floor((r-100*a)/a),0),_=Math.min(Math.ceil((r+n+100*a)/a),e.records.length)):(C=0,_=e.records.length);var s=(C=C&&C%2?C+1:C)-x>0||_-w>0;if(C!==x||_!==w){var l,u,c,d,f,p;if(i||((l=document.createElement("tr")).className="js-placeholder-top",l.style.height="0px",g[0].appendChild(l),i=t.find(".js-placeholder-top")[0]),o||((l=document.createElement("tr")).className="js-placeholder-bottom",l.style.height="0px",g[0].appendChild(l),o=t.find(".js-placeholder-bottom")[0]),!e.layout.length&&e.records.length){var h=Math.min(e.records.length,e.resultsPerPage);for(f=0;f<h;f++)F(f,e.records,"end")}else if(s){for(f=0;f<C;f++)M(f);for(i.style.height=C*a+"px",d=0,f=((c=(u=t[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")).length>2)?L(u[u.length-2]):C)+1;f<_;f++)F(f,e.records,"end"),d++;p=(p=c?$(o).height()-d*a:(e.records.length-_)*a)>0?p:0,o.style.height=p+"px"}else{for(d=0,f=_+1;f<e.records.length;f++)M(f),d++;var m=e.records.length-(_+1);for(m=m>=0?m:0,o.style.height=m*a+"px",d=0,f=((c=(u=t[0].getElementsByTagName("tbody")[0].getElementsByTagName("tr")).length>2)?L(u[1]):_)-1;f>=C;f--)F(f,e.records,"begin"),d++;p=(p=c?$(i).height()-d*a:C*a)>0?p:0,i.style.height=p+"px"}x=C,w=_}};e.$watch("records",function(n,r){n!==r&&(O(),e.computeLayout(),p||(p=t.find("[infinite-scroll]")),t.height()>p.height()&&e.loadMore())}),e.context.wait().then(function(){if(e.displayedFields?e.displayedFieldsArray=e.displayedFields.split(",").map(function(e){return e.trim()}):e.context.dataset.extra_metas&&e.context.dataset.extra_metas.visualization&&angular.isArray(e.context.dataset.extra_metas.visualization.table_fields)&&e.context.dataset.extra_metas.visualization.table_fields.length>0?e.displayedFieldsArray=e.context.dataset.extra_metas.visualization.table_fields:e.displayedFieldsArray=null,!e.context.parameters.sort&&e.context.dataset.extra_metas&&e.context.dataset.extra_metas.visualization&&e.context.dataset.extra_metas.visualization.table_default_sort_field){var t=e.context.dataset.extra_metas.visualization.table_default_sort_field;"-"===e.context.dataset.extra_metas.visualization.table_default_sort_direction&&(t="-"+t),e.context.parameters.sort=t}e.displayDatasetFeedback="true"===e.datasetFeedback&&e.context.dataset.getExtraMeta("explore","feedback_enabled"),e.staticSearchOptions={rows:e.resultsPerPage},o.log("table -> dataset watch -> refresh records");var n=s("fieldsForVisualization")(e.context.dataset.fields,"table");f=s("fieldsFilter")(n,e.displayedFieldsArray),D(!0)}),e.$watch("context.parameters",function(n,r){n!==r&&(o.log("table -> searchOptions watch -> refresh records"),e.layout=[],e.working=!0,y=t.find(".odswidget-table__records")[0].scrollLeft,b=!0,g.empty(),D(!0))},!0);var N=function(){t.find(".odswidget-table__records").scrollLeft(0),h.css({left:"auto"}),m=t.find(".odswidget-table__header").offset().left};$(window).on("resize",function(){n(function(){N(),e.layout=[],e.computeLayout()},0)});var j=0;t.find(".odswidget-table__records").on("scroll",function(){if(this.scrollLeft!==v)h.offset({left:m-this.scrollLeft}),v=this.scrollLeft;else{b=!1;var e=Math.max(Math.floor(t.find(".odswidget-table__records")[0].scrollTop/g.find("tr").eq(1).height()),0);if(Math.abs(e-j)<100&&e>C)return;j=e,O()}});var P=function(t,n){for(var r="",a=0;a<e.layout.length;a++){var i=a+1,o=n?"max-width: none; ":"";r+="#"+t+" .odswidget-table__header tr th:nth-child("+i+") > div, #"+t+" .odswidget-table__records tr td:nth-child("+i+") > div { width: "+e.layout[a]+"px; "+o+"} "}return r};e.computeLayout=function(){var r,a=t.find(".odswidget-table__internal-table-row");if(!e.layout.length&&e.records.length){t.attr("id")||t.attr("id",A),t.hasClass("odswidget-table--embedded")?(r=$(window).height()-t.offset().top,t.height(r)):r=t.height();var i=0;e.displayDatasetFeedback&&(i=t.find(".table-feedback-new").height()+5),t.find(".odswidget-table__records").height(r-25-i);var o=g.find("tr").eq(1).height(),s=(a.length-2)*o,l=document.getElementById(k);l&&l.parentNode&&l.parentNode.removeChild(l),t.find(".odswidget-table__internal-header-table-header").hide(),t.find(".odswidget-table__internal-table-header").show();var u=0;angular.forEach(t.find(".odswidget-table__internal-table-header .odswidget-table__cell-container"),function(t,n){e.layout[n]=$(t).width()+8,u+=e.layout[n]}),e.layout[0]=30;var c=t.find(".odswidget-table__internal-table").width(),d=u+22*e.layout.length<t.width();if(d){for(var f=Math.floor(c/e.layout.length),p=c-f*e.layout.length,m=1;m<e.layout.length;m++)e.layout[m]=f-22;e.layout[e.layout.length-1]+=p,s>500?t.find(".odswidget-table__internal-header-table").width(c):t.find(".odswidget-table__internal-header-table").width("")}var v=document.createElement("style"),x=P(A,d);v.id=k,v.type="text/css",v.styleSheet?v.styleSheet.cssText=x:v.appendChild(document.createTextNode(x)),t[0].appendChild(v),t.find(".odswidget-table__internal-table-header").hide(),t.find(".odswidget-table__internal-header-table-header").show(),b||n(function(){N()},0)}b&&(y||h.css({left:"auto"}),t.find(".odswidget-table__records")[0].scrollLeft=y),e.layout.length&&(e.working=!1)}}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsTagCloud",["ODSAPI","$location",function(e,t){function n(e){var t=Math.floor(e.length/2);return e.length%2?e[t].count:(e[t-1].count+e[t].count)/2}function r(e,t){var n=$.grep(e,function(e){return e.count>=t}),r=$.grep(e,function(e){return e.count<=t}),a=[{count:n.length,min:n[n.length-1].count,max:n[0].count},{count:r.length,min:r[r.length-1].count,max:r[0].count}];return a[0].delta=a[0].max-a[0].min,a[1].delta=a[1].max-a[1].min,a}function a(e,t,n,r){var a,i=(e.count>=t?n[0].delta:n[1].delta)/2;return a=e.count>=2*i?1:e.count>=i&&e.count<2*i?2:3,a=e.count>=t?a:a+3,e={count:e.count,name:e.name,opacity:((7-a+4)/10+.05).toFixed(2),size:((7-a)/3).toFixed(1),weight:a},e.size=6!==a?e.size:parseFloat(e.size)+.3,e}function i(e,t,n){var r=e.parameters["refine."+t];return angular.isDefined(r)&&(angular.isArray(r)&&r.indexOf(n)>-1||r===n)}function o(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(Math.random()*(t+1)),r=e[t];e[t]=e[n],e[n]=r}return e}return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-tag-cloud">    <ul class="odswidget-tag-cloud__tag-list">        <li class="odswidget-tag-cloud__no-data-label" ng-hide="tags" translate>No data available yet</li>        <li ng-repeat="tag in tags"             class="odswidget-tag-cloud__tag"             ng-class="{\'odswidget-tag-cloud__tag--selected\': tag.selected}"            ng-style="{\'font-size\': tag.size + \'em\', \'opacity\': tag.opacity}">            <a ng-click="refine(tag.name)" href="">                {{ tag.name }}            </a>        </li>    </ul></div>',scope:{context:"=",facetName:"@",max:"@?",redirectTo:"@?",contextToRefine:"=?"},controller:["$scope",function(t){t.refine=function(e){if(t.redirectTo){var n="refine."+t.facetName+"="+e,r=t.redirectTo.indexOf("?")>-1?"&":"?";window.location=t.redirectTo+r+n}else t.contextToRefine?t.contextToRefine.toggleRefine(t.facetName,e):t.context.toggleRefine(t.facetName,e)};var s=function(){var s,l={rows:0,facet:t.facetName};"catalog"===t.context.type?s=e.datasets.search(t.context,l):(l=$.extend({},t.context.parameters,l),s=e.records.search(t.context,l)),s.success(function(e){if(e.facet_groups){t.tags=e.facet_groups[0].facets,t.max&&(t.tags=t.tags.slice(0,t.max));for(var s=n(t.tags),l=0;l<t.tags.length;l++)t.tags[l]=a(t.tags[l],s,r(t.tags,s),t.context.domainUrl),t.tags[l].selected=i(t.contextToRefine?t.contextToRefine:t.context,t.facetName,t.tags[l].name);t.tags=o(t.tags)}})};t.$watch("context",function(e,n){("catalog"===t.context.type||"dataset"===t.context.type&&t.context.dataset)&&s()},!0)}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsTextSearch",function(){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-text-search"><form ng-submit="applySearch()" class="odswidget-text-search__form"><input class="odswidget-text-search__search-box" name="q" type="text" ng-model="searchExpression" placeholder="{{placeholder}}"></form></div>',scope:{placeholder:"@?",context:"="},controller:["$scope","translate",function(e,t){var n=e.$watch("context",function(t,r){t&&(e.searchExpression=e.context.parameters.q,n())});e.applySearch=function(){e.context.parameters.q=e.searchExpression}}]}})}(),function(){"use strict";angular.module("ods-widgets").directive("odsThemeBoxes",function(){return{restrict:"E",replace:!1,template:'<div class="odswidget odswidget-theme-boxes"><div class="odswidget odswidget-facet-enumerator"><div ng-repeat="item in items" class="item" ods-facet-results="items" ods-facet-results-context="context" ods-facet-results-facet-name="theme"><a ng-href="{{context.domainUrl}}/explore/?refine.theme={{item.path}}" target="_self" ods-tooltip="{{item.name}} ({{formatCount(item.count)}})" ods-tooltip-direction="bottom" style="display: block;"><ods-theme-picto theme="{{item.name}}"></ods-theme-picto></a></div></div></div>',scope:{context:"="},controller:["$scope","translate",function(e,t){e.formatCount=function(e){return e>1?e+" "+t("datasets"):e+" "+t("dataset")}}]}})}(),function(){"use strict";angular.module("ods-widgets").directive("odsTileMap",["ModuleLazyLoader",function(e){return{restrict:"E",replace:!0,scope:{context:"=",embedMode:"@",autoResize:"@",mapContext:"=?",location:"@",basemap:"@",isStatic:"@"},template:function(e){return e.contents().wrapAll("<div>"),e.contents().length>0&&e.contents().html().trim().length>0&&(e.contents().wrapAll("<div>"),e.data("tooltip-template",e.children().html())),'<div class="odswidget odswidget-map"><div class="map"></div><div class="overlay map opaque-overlay" ng-show="pendingRequests.length && initialLoading"><ods-spinner></ods-spinner></div><div class="odswidget-map__loading" ng-show="loadingTiles"><ods-spinner></ods-spinner></div></div>'},link:function(t,n,r){function a(){$(".odswidget-map > .map").length>0&&$(".odswidget-map > .map").height(Math.max(200,$(window).height()-$(".odswidget-map > .map").offset().top))}angular.isUndefined(t.mapContext)&&(t.mapContext={},t.location&&(t.mapContext.location=t.location),t.basemap&&(t.mapContext.basemap=t.basemap)),"true"===t.autoResize&&($(window).on("resize",a),a()),e("leaflet").then(function(){t.initMap=function(e,r,a,i,o,s,l,u){var c={basemapsList:a,worldCopyJump:!0,minZoom:2,basemap:s,dragging:!l,zoomControl:!l,prependAttribution:u};l&&(c.doubleClickZoom=!1,c.scrollWheelZoom=!1);var d=new L.ODSMap(n.children()[0],c);d.addControl(new L.Control.Scale),"true"!==r&&d.addControl(new L.Control.Fullscreen),l||d.addControl(new L.Control.Locate({maxZoom:18})),t.drawnItems=new L.FeatureGroup,d.addLayer(t.drawnItems);var f=new L.Control.Draw({edit:{featureGroup:t.drawnItems},draw:{polyline:!1,marker:!1}});d.addControl(f),t.map=d,d.on("popupclose",function(e){jQuery(e.popup.getContent()).trigger("popupclose")})}})},controller:["$scope","$q","$compile","$element","ODSAPI","ODSWidgetsConfig","translate","DebugLogger","odsErrorService",function(e,t,n,r,a,i,o,s,l){e.initialLoading=!0;var u={delimiter:",",accuracy:5,formatLatLng:function(e){var t=L.Util.formatNum(e.lat,this.accuracy),n=L.Util.formatNum(e.lng,this.accuracy);return new L.LatLng(t,n)},getLocationParameterAsArray:function(e){return e.split(this.delimiter)},getLocationParameterFromMap:function(e){var t=this.formatLatLng(e.getCenter());return e.getZoom()+this.delimiter+t.lat+this.delimiter+t.lng},getCenterFromLocationParameter:function(e){var t=this.getLocationParameterAsArray(e);return new L.LatLng(t[1],t[2])},getZoomFromLocationParameter:function(e){return this.getLocationParameterAsArray(e)[0]}};e.$watch("context.parameters",function(t,n){t!==n&&(e.initialLoading||c(!0))},!0);var c=function(t){var n=function(){var t={color:e.context.dataset.getExtraMeta("visualization","map_marker_color"),icon:e.context.dataset.getExtraMeta("visualization","map_marker_picto"),showmarker:!e.context.dataset.getExtraMeta("visualization","map_marker_hidemarkershape")};angular.extend(t,e.context.parameters);var n="/api/datasets/1.0/"+e.context.dataset.datasetid+"/tiles/simple/{z}/{x}/{y}.bundle",r="";angular.forEach(t,function(e,t){null!=e&&(r+=r?"&":"?",r+=t+"="+encodeURIComponent(e))}),n+=r,e.bundleLayer._url!==n&&e.bundleLayer.setUrl(n)};if(t){var r={};jQuery.extend(r,e.staticSearchOptions,e.context.parameters),a.records.boundingbox(e.context,r).success(function(t){t.bbox.length>0&&e.map.fitBounds([[t.bbox[1],t.bbox[0]],[t.bbox[3],t.bbox[2]]]),n()})}else n()},d=function(t){var n=t.getSize();n.x>0&&n.y>0&&(e.mapContext.location=u.getLocationParameterFromMap(t))},f=e.$watch("context.dataset",function(p,h){if(p&&p.datasetid){e.context.dataset.hasFieldType("geo_shape")?angular.forEach(e.context.dataset.fields,function(t){angular.isUndefined(e.shapeField)&&"geo_shape"===t.type&&(e.shapeField=t.name)}):e.shapeField=null,e.staticMap="true"===e.isStatic||"true"===e.context.parameters.static;var g=e.$watch("initMap",function(){e.initMap&&(g(),e.initMap(p,e.embedMode,i.basemaps,o,i.mapGeobox,e.mapContext.basemap,e.staticMap,i.mapPrependAttribution))});f(),e.staticSearchOptions={dataset:e.context.dataset.datasetid};var m=e.$watch("map",function(o,f){if(o){e.bundleLayer=new L.BundleTileLayer("",{tileSize:512,minZoom:o.getMinZoom(),maxZoom:o.getMaxZoom(),gridLayer:{options:{resolution:4},events:{click:function(t){if(!e.drawing&&t.data){console.log(t.data);var a=e.$new(!1),i={offset:[0,-10],maxWidth:250,minWidth:250},o=r.data("tooltip-template");!angular.isUndefined(o)&&angular.isString(o)&&""!==o.trim()||(o=e.context.dataset.extra_metas&&e.context.dataset.extra_metas.visualization&&e.context.dataset.extra_metas.visualization.map_tooltip_html?e.context.dataset.extra_metas.visualization.map_tooltip_html:""),a.template=o,a.map=e.map,a.gridData=t.data,new L.Popup(i).setLatLng(t.latlng).setContent(n('<ods-map-tooltip context="context" grid-data="gridData" template="{{template}}" map="map" shape-field="'+(e.shapeField||"")+'"></ods-map-tooltip')(a)[0]).openOn(e.map)}}}}}),e.bundleLayer.on("loading",function(){e.$evalAsync("loadingTiles = true")}),e.bundleLayer.on("load",function(){e.$evalAsync("loadingTiles = false")}),e.bundleLayer.on("tileerror",function(){l.sendErrorNotification({error:"Error while loading the map view."})}),e.map.addLayer(e.bundleLayer);var p=function(){var n=t.defer();if(e.context.parameters.mapviewport)"("===e.context.parameters.mapviewport.substring(0,1)&&(e.context.parameters.mapviewport=ODS.GeoFilter.getBoundsAsBboxParameter(ODS.GeoFilter.getPolygonParameterAsBounds(e.context.parameters.mapviewport))),n.resolve(ODS.GeoFilter.getBboxParameterAsBounds(e.context.parameters.mapviewport));else if(e.context.parameters["geofilter.polygon"])n.resolve(ODS.GeoFilter.getPolygonParameterAsBounds(e.context.parameters["geofilter.polygon"]));else{var r={};jQuery.extend(r,e.staticSearchOptions,e.context.parameters),a.records.boundingbox(e.context,r).success(function(e){e.count>0?n.resolve([[e.bbox[1],e.bbox[0]],[e.bbox[3],e.bbox[2]]]):n.resolve([[-60,-180],[80,180]])})}return n.promise};(function(){var n=t.defer();if(e.mapContext.location){s.log("Location found");var r=u.getCenterFromLocationParameter(e.mapContext.location),a=u.getZoomFromLocationParameter(e.mapContext.location);s.log(r,a),o.setView(r,a),c(!1),n.resolve()}else s.log("Use boundsRetrieval"),p().then(function(t){e.context.parameters.mapviewport&&(s.log("Deleted mapviewport"),delete e.context.parameters.mapviewport),s.log(t),o.fitBounds(t),c(!1),n.resolve()});return n.promise})().then(function(){e.initialLoading=!1,s.log("First onViewportMove"),d(e.map),e.map.on("moveend",function(t){d(t.target),e.$$phase||e.$root.$$phase||e.$apply()})}),i.basemaps.length>1&&e.map.on("baselayerchange",function(t){e.mapContext.basemap=t.layer.basemapId,e.bundleLayer.setMinZoom(t.layer.options.minZoom),e.bundleLayer.setMaxZoom(t.layer.options.maxZoom),e.$$phase||e.$root.$$phase||e.$apply()});var h=function(t,n){if("circle"===n){var r=t.getRadius(),a=t.getLatLng();e.context.parameters["geofilter.distance"]=a.lat+","+a.lng+","+r,delete e.context.parameters["geofilter.polygon"]}else{var i=t.toGeoJSON(),o=ODS.GeoFilter.getGeoJSONPolygonAsPolygonParameter(i.geometry);e.context.parameters["geofilter.polygon"]=o,delete e.context.parameters["geofilter.distance"]}},g=function(e){return angular.isDefined(e.getRadius)?"circle":"polygon"},v=function(e){e._path.setAttribute("style","cursor: pointer; pointer-events: auto;")},y=function(e){e._path.setAttribute("style","cursor: auto; pointer-events: none;")};e.map.on("draw:drawstart draw:editstart",function(){e.drawing=!0,e.$apply()}),e.map.on("draw:drawstop draw:editstop",function(){e.drawing=!1,e.$apply()}),e.map.on("draw:created",function(t){var n=t.layer;e.drawnItems.getLayers().length>0&&e.drawnItems.removeLayer(e.drawnItems.getLayers()[0]),e.drawnItems.addLayer(n),h(n,t.layerType),e.$apply()}),e.map.on("draw:deleted",function(t){delete e.context.parameters["geofilter.distance"],delete e.context.parameters["geofilter.polygon"],e.$apply()}),e.map.on("draw:edited",function(t){var n=t.layers.getLayers()[0],r=g(n);h(n,r),e.$apply()}),e.map.on("draw:deletestart",function(){v(e.drawnItems.getLayers()[0])}),e.map.on("draw:deleteend",function(){y(e.drawnItems.getLayers()[0])});var b={color:"#2ca25f",fillOpacity:.2,opacity:.8,clickable:!0};e.$watch('[context.parameters["geofilter.polygon"], context.parameters["geofilter.distance"]]',function(t,n){var r=t[0],a=t[1];e.drawnItems.getLayers().length>0&&e.drawnItems.removeLayer(e.drawnItems.getLayers()[0]);var i;if(r){var o=ODS.GeoFilter.getPolygonParameterAsGeoJSON(r),s=o.coordinates[0];s.splice(o.coordinates[0].length-1,1);var l,u,c;for(l=0;l<s.length;l++)c=(u=s[l])[0],u[0]=u[1],u[1]=c;i=4===s.length&&s[0][0]===s[3][0]&&s[1][0]===s[2][0]&&s[0][1]===s[1][1]&&s[2][1]===s[3][1]?new L.Rectangle(s,b):new L.Polygon(s,b)}else if(a){var d=a.split(","),f=d[0],p=d[1],h=d[2];i=new L.Circle([f,p],h,b)}i&&(e.drawnItems.addLayer(i),y(e.drawnItems.getLayers()[0]))},!0),m()}})}},!0)}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsTimerange",["ModuleLazyLoader",function(e){var t={styles:{container:"rd-container odswidgets-rd-container"},weekStart:1},n=function(e){return"yesterday"===e?moment().subtract("days",1):"now"===e?moment():angular.isString(e)?moment(e):null},r=function(e){return e?moment(e).milliseconds(0).toISOString().replace(".000Z","Z"):null};return{restrict:"E",replace:!0,scope:{context:"=",timeField:"@?",defaultFrom:"@?",defaultTo:"@?",displayTime:"@?",dateFormat:"@?",to:"=?",from:"=?"},template:'<div class="odswidget odswidget-timerange"><span class="odswidget-timerange-from"><span translate>From</span> <input type="text"></span><span class="odswidget-timerange-to"><span translate>to</span> <input type="text"></span></div>',link:function(a,i,o){var s=i.find("input");a.dateFormat=a.dateFormat||"YYYY-MM-DD HH:mm",angular.isDefined(a.defaultFrom)&&(s[0].value=n(a.defaultFrom).format(a.dateFormat),a.from=r(n(a.defaultFrom))),angular.isDefined(a.defaultTo)&&(s[1].value=n(a.defaultTo).format(a.dateFormat),a.to=r(n(a.defaultTo))),e("rome").then(function(){void 0===a.displayTime?a.displayTime=!0:a.displayTime="true"===a.displayTime,rome(s[0],angular.extend({},t,{time:a.displayTime,dateValidator:rome.val.beforeEq(s[1]),initialValue:a.defaultFrom,inputFormat:a.dateFormat})).on("data",function(e){a.$apply(function(){a.from=r(moment(e,a.dateFormat))})}),rome(s[1],angular.extend({},t,{time:a.displayTime,dateValidator:rome.val.afterEq(s[0]),initialValue:a.defaultTo,inputFormat:a.dateFormat})).on("data",function(e){a.$apply(function(){a.to=r(moment(e,a.dateFormat))})})})},controller:["$scope","$attrs","$q","$compile","$rootScope","$parse",function(e,t,n,r,a,i){var o=[],s={},l=function(e){if(e){var t=e.fields.filter(function(e){return"date"===e.type||"datetime"===e.type});return t.length>1&&console.log('Warning: the dataset "'+e.getUniqueId()+'" has more than one date or datetime field, the first date or datetime field will be used. You can specify the field to use using the "time-field" parameter.'),0===t.length&&console.log('Error: the dataset "'+e.getUniqueId()+"\" doesn't have any date or datetime field, which is required for the Timerange widget."),t[0].name}return null};angular.isArray(e.context)?o=e.context:(o.push(e.context),s[e.context.name]={},e.timeField&&(s[e.context.name].timeField=e.timeField)),angular.forEach(o,function(n){s[n.name]={timefield:s[e.context.name]&&s[e.context.name].timeField?s[e.context.name].timeField:null,formatter:i("$field + ':[' + $from + ' TO ' + $to + ']'"),parameter:"q"},angular.isDefined(t[n.name+"ParameterFormatter"])&&(s[n.name].formatter=i(t[n.name+"ParameterFormatter"])),angular.isDefined(t[n.name+"ParameterName"])&&(s[n.name].parameter=t[n.name+"ParameterName"]),angular.isDefined(t[n.name+"TimeField"])&&(s[n.name].timefield=t[n.name+"TimeField"])}),n.all(o.map(function(e){return e.wait().then(function(t){null===s[e.name].timefield&&(s[e.name].timefield=l(t))})})).then(function(){u(o,s)});var u=function(t,n){e.$watch("[from, to]",function(r){r[0]&&r[1]&&angular.forEach(t,function(t){var r=n[t.name].parameter,a={};a.$to=e.to,a.$from=e.from,a.$field=n[t.name].timefield,["q","rq"].indexOf(r)>-1&&(r+=".timerange"),t.parameters[r]=n[t.name].formatter(a)})},!0)}}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsTimescale",function(){return{restrict:"E",replace:!0,scope:{context:"=",timeField:"@",defaultValue:"@"},template:'<div class="odswidget odswidget-timescale">   <ul class="odswidget-timescale__scale-list">       <li class="odswidget-timescale__scale" ng-class="{\'odswidget-timescale__scale--active\': scale == \'everything\' || !scale}"> <a class="odswidget-timescale__scale-link" href="#" ng-click="scale = \'everything\'; $event.preventDefault();" translate>Everything</a></li>       <li class="odswidget-timescale__scale" ng-class="{\'odswidget-timescale__scale--active\': scale == \'year\'}">                 <a class="odswidget-timescale__scale-link" href="#" ng-click="scale = \'year\'; $event.preventDefault();" translate>Last 12 months</a></li>       <li class="odswidget-timescale__scale" ng-class="{\'odswidget-timescale__scale--active\': scale == \'month\'}">                <a class="odswidget-timescale__scale-link" href="#" ng-click="scale = \'month\'; $event.preventDefault();" translate>Last 4 weeks</a></li>       <li class="odswidget-timescale__scale" ng-class="{\'odswidget-timescale__scale--active\': scale == \'week\'}">                 <a class="odswidget-timescale__scale-link" href="#" ng-click="scale = \'week\'; $event.preventDefault();" translate>Last 7 days</a></li>       <li class="odswidget-timescale__scale" ng-class="{\'odswidget-timescale__scale--active\': scale == \'day\'}">                  <a class="odswidget-timescale__scale-link" href="#" ng-click="scale = \'day\'; $event.preventDefault();" translate>Last 24 hours</a></li>   </ul></div>',controller:["$scope","$attrs","$q",function(e,t,n){var r=[],a={},i=function(e){if(e){var t=e.fields.filter(function(e){return"date"===e.type||"datetime"===e.type});t.length>1&&console.log('Warning: the dataset "'+e.getUniqueId()+'" has more than one date or datetime field, the first date or datetime field will be used. You can specify the field to use using the "time-field" parameter.'),0===t.length&&console.log('Error: the dataset "'+e.getUniqueId()+"\" doesn't have any date or datetime field, which is required for the Timerange widget."),a[e.getUniqueId()]=t[0].name}};angular.isArray(e.context)?r=e.context:r.push(e.context),n.all(r.map(function(n){return n.wait().then(function(r){angular.isDefined(t[n.name+"TimeField"])?a[n.dataset.getUniqueId()]=t[n.name+"TimeField"]:e.timeField?a[n.dataset.getUniqueId()]=e.timeField:i(r)})})).then(function(){o(r,a)});var o=function(t,n){e.scale=e.defaultValue||"everything",e.$watch("scale",function(e){if("everything"!==e){var r=null,a=new Date;"day"===e?a.setDate(a.getDate()-1):"week"===e?a.setDate(a.getDate()-7):"month"===e?a.setMonth(a.getMonth()-1):"year"===e&&a.setFullYear(a.getFullYear()-1),r=a.toISOString(),angular.forEach(t,function(e){e.parameters["q.timescale"]=n[e.dataset.getUniqueId()]+'>="'+r+'"'})}else angular.forEach(t,function(e){delete e.parameters["q.timescale"]})},!0)}}]}})}(),function(){"use strict";angular.module("ods-widgets").directive("odsToggleModel",function(){var e=function(e,t,n){e[t]?angular.isArray(e[t])?e[t].indexOf(n)<0&&e[t].push(n):angular.equals(e[t],n)||(e[t]=[e[t],n]):e[t]=n},t=function(e,t,n){e[t]&&(angular.isArray(e[t])?e[t].indexOf(n)>=0&&(1===e[t].length?delete e[t]:e[t].splice(e[t].indexOf(n),1)):angular.equals(e[t],n)&&delete e[t])};return{restrict:"A",scope:{odsToggleModel:"=",odsToggleKey:"@",odsToggleValue:"@"},link:function(n,r,a){r.on("change",function(r){r.currentTarget.checked?n.$apply(function(){e(n.odsToggleModel,n.odsToggleKey,n.odsToggleValue)}):n.$apply(function(){t(n.odsToggleModel,n.odsToggleKey,n.odsToggleValue)})}),n.$watch("odsToggleModel[odsToggleKey]",function(e){e?angular.isArray(e)&&e.indexOf(n.odsToggleValue)>=0?r.prop("checked",!0):angular.equals(e,n.odsToggleValue)?r.prop("checked",!0):r.prop("checked",!1):r.prop("checked",!1)},!0)}}})}(),function(){"use strict";angular.module("ods-widgets").directive("odsTopPublishers",["ODSAPI",function(e){return{restrict:"E",replace:!0,template:'<div class="odswidget odswidget-top-publishers"><ul>   <li class="no-data" ng-hide="publishers" translate>No data available yet</li>   <li ng-repeat="publisher in publishers" ng-if="publishers">       <div class="dataset-details">           <div class="name"><a ng-href="{{ context.domainUrl }}/explore/?refine.publisher={{ publisher.path }}" target="_self">{{ publisher.name }}</a></div>           <div class="count"><i class="icon-table"></i> <span translate>Used by</span> {{ publisher.count }} '+"<span ng-pluralize count=\"publisher.count\" translate=\"when\" when=\"{'0': 'dataset', '1': 'dataset', 'other': 'datasets'}\"></span></div>       </div>   </li></ul></div>",scope:{context:"="},controller:["$scope",function(t){var n=function(){e.datasets.facets(t.context,"publisher").success(function(e){t.publishers=e.facet_groups[0].facets.slice(0,5)})};t.$watch("context",function(){n()})}]}}])}(),function(){"use strict";angular.module("ods-widgets").directive("odsTwitterTimeline",function(){return{restrict:"E",replace:!0,template:'<div class="odswidget"></div>',scope:{widgetId:"@"},link:function(e,t,n){var r='<a class="twitter-timeline" href="https://twitter.com/twitterapi" data-widget-id="'+n.widgetId+'">Tweets</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");<\/script>';t.append(r)}}})}(),function(){"use strict";var e=angular.module("ods-widgets");e.directive("inject",function(){return{link:function(e,t,n,r,a){var i=e.$new();a?a(i,function(e){var n=e.clone();n.contents().wrapAll("<div>"),n.contents().length>0&&n.contents().html().trim().length>0&&(t.empty(),t.append(e),t.on("$destroy",function(){i.$destroy()}))}):console.warn("inject directive used on an element with no transcluded directives",t)}}}),e.directive("odsFullClick",function(){return{restrict:"A",link:function(e,t,n){n.odsFullClick&&t.find("[ods-main-click]").attr("href",n.odsFullClick),t.click(function(e){if(!$(e.target).is("a,button,[ng-click]")&&0===$(e.target).parents("a,button,[ng-click]").length&&t.find("[ods-main-click]").length)if(document.createEvent){var n=document.createEvent("MouseEvents"),r=e.originalEvent;n.initMouseEvent(r.type,r.bubbles,r.cancelable,window,r.detail,r.screenX,r.screenY,r.clientX,r.clientY,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.button,r.relatedTarget),t.find("[ods-main-click]")[0].dispatchEvent(n)}else document.createEventObject&&(window.location=t.find("[ods-main-click]")[0].href)})}}})}();